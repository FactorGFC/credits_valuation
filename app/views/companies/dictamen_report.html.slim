doctype 5
html.wf-roboto-n3-active.wf-roboto-n4-active.wf-roboto-n5-active.wf-roboto-n6-active.wf-roboto-n7-active.wf-poppins-n3-active.wf-poppins-n4-active.wf-poppins-n5-active.wf-poppins-n6-active.wf-poppins-n7-active.wf-active
  head
    meta charset='utf-8' /
    meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1' /
    meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, shrink-to-fit=no" /
    link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet"
    = csrf_meta_tags
    = csp_meta_tag
    = wicked_pdf_stylesheet_link_tag 'application'
    = stylesheet_link_tag "http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css", media: "all", "data-turbolinks-track" => true

  body.d-flex.flex-column

    .m-content
      .m-portlet__body
        .col-md-12.d-flex.justify-content-between.align-items-center
          h1
            strong = 'DICTAMEN'
          = wicked_pdf_image_tag asset_url('logo.png'), size: "133x73"
        hr style="border: 1px solid #0164ac;"
        .col-md-12.d-inline-flex.mt-3
          .d-inline-flex
            = wicked_pdf_image_tag asset_url('icons/office-building.png'), size: "70x70"
          .d-flex.flex-column.mx-3
            h1
              strong = @company_name
            span = DateTime.now.strftime("%d/%m/%Y")
        .col-md-12.my-4
          hr.hr-title
          div style="position:relative;"
            h2.subtitle-st
              span = "1. Datos Generales"
        .col-md-12.page-breaker
          .col-md-12.d-inline-flex.justify-content-between
            .d-inline-flex.flex-column
              strong = "Ubicación"
              br
              span = @company_state_municipality + ' ' + @company_address
            .d-inline-flex.flex-column
              strong = "Actividad / RFC / Régimen"
              br
              span = @company.main_activity + ' / ' + @company.rfc
          .col-md-12.d-inline-flex
            strong = "Principales Productos"
            br
            - if @company.main_product_list.length > 0
              - @company.main_product_list.each do |e|
                span.tag
                  = "#{e}"
            - else
              span = "- "
          .col-md-12.d-inline-flex
            .d-flex.flex-column
              strong = "Colaboradores"
              br
              .d-flex.flex-column
                ul.d-inline-flex
                  li.d-inline
                    .d-flex.flex-column.align-items-center.mr-15
                      span.d-flex.justify-content-center.align-items-center.quantity-circle-pdf = render_quantity_h @company.try(:number_collaborator).try(:operative)
                      span.quantity-num
                        strong = 'OPERATIVOS'
                  li.d-inline
                    .d-flex.flex-column.align-items-center.mr-15
                      span.d-flex.justify-content-center.align-items-center.quantity-circle-pdf = render_quantity_h @company.try(:number_collaborator).try(:administrative)
                      span.quantity-num
                        strong = 'ADMINISTRATIVOS'
                  li.d-inline
                    .d-flex.flex-column.align-items-center.mr-15
                      span.d-flex.justify-content-center.align-items-center.quantity-circle-pdf = render_quantity_h @company.try(:number_collaborator).try(:sales)
                      span.quantity-num
                        strong = 'VENTAS'
                  li.d-inline
                    .d-flex.flex-column.align-items-center.mr-15
                      span.d-flex.justify-content-center.align-items-center.quantity-circle-pdf = render_quantity_h @company.try(:number_collaborator).try(:eventual)
                      span.quantity-num
                        strong = 'EVENTUAL'
                  li.d-inline
                    .d-flex.flex-column.align-items-center.mr-15
                      span.d-flex.justify-content-center.align-items-center.quantity-circle-pdf = render_quantity_h @company.try(:number_collaborator).try(:unionized)
                      span.quantity-num
                        strong = 'SINDICALIZADOS'
                ul.d-flex.justify-content-center.collab-list
                  span.h4
                    strong = "TOTAL:  #{ @company.try(:number_collaborator).present? ? @company.try(:number_collaborator).try(:total).to_s(:delimited) : 0 }"
          .mt-30
            .btns-card-pdf.full-h
              .d-flex.flex-column.justify-content-between
                span.h5.subtitle = 'Comentarios del Analista'
                .m-widget3
                  - if @request_comments.length > 0
                    - @request_comments.each do |comment|
                      .m-widget3__item
                        .m-widget3__header
                          .m-widget3__info
                            span.m-widget3__username
                              = User.where(id: comment.user_id).try(:first).full_name
                            span.m-widget3__time
                              = " - #{comment.created_at.strftime('%d/%m/%Y,  %I:%M%p')}"
                        p.comment-bubbled
                          = comment.comment
                          b.aft
                  - else
                    .m-widget3__item
                      .m-widget3__body
                        p.m-widget3__text
                          .text-center
                            | Aún no hay comentarios.

        .col-md-12.my-4.page-breaker style="page-break-after:always;"
          hr.hr-title
          div style="position:relative;"
            h2.subtitle-st
              span = "2. Consultas Externas"
          .col-md-12.page-breaker
            h3 = "2.1 Buró de Crédito"
            - if @credit_bureau.present? and @company.try(:client_type).eql?('PF')
              .page-breaker
                h4 = "2.1.1 Score"
                .d-flex.justify-content-center
                  .d-flex.justify-content-between.align-items-center.status-container-large
                    .d-block
                      = wicked_pdf_image_tag asset_url(calculate_face(@score))
                    span
                      strong = @score
                      span style="margin-left: 5px; font-size: 18px;" = 'Puntos'
                .d-flex.justify-content-center
                  .d-flex.justify-content-between.align-items-center.status-container-pdf
                    .d-block
                      = wicked_pdf_image_tag asset_url('icons/face-bad.png')
                    span
                      strong = 'BAJA, MENOR A 550 PUNTOS'
                  .d-flex.justify-content-between.align-items-center.status-container-pdf
                    .d-block
                      = wicked_pdf_image_tag asset_url('icons/face-med.png')
                    span
                      strong = 'REGULAR, 551-650 PUNTOS'
                  .d-flex.justify-content-between.align-items-center.status-container-pdf
                    .d-block
                      = wicked_pdf_image_tag asset_url('icons/face-nice.png')
                    span
                      strong = 'BUENA 651- 750 PUNTOS'
                  .d-flex.justify-content-between.align-items-center.status-container-pdf
                    .d-block
                      = wicked_pdf_image_tag asset_url('icons/face-good.png')
                    span
                      strong = 'EXCELENTE MÁS DE 751 PUNTOS'

              .page-breaker
                h4.mt-5 = "2.1.2 Datos Generales"
                .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                  - if @credit_bureau.present?
                    - if @report_result['response'].present? && @report_result['response']['return']['Personas']['Persona'][0]['Nombre'].present?
                      .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                        strong
                          | Nombre
                      .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                        = @report_result['response']['return']['Personas']['Persona'][0]['Nombre']['PrimerNombre'] + ' ' + @report_result['response']['return']['Personas']['Persona'][0]['Nombre']['ApellidoPaterno'] + ' ' + @report_result['response']['return']['Personas']['Persona'][0]['Nombre']['ApellidoMaterno']
                      .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                        strong
                          | R.F.C
                      .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                        = @report_result['response']['return']['Personas']['Persona'][0]['Nombre']['RFC']
                      .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                        strong
                          | Fecha de nacimiento
                      .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                        = get_pm_birthdate @report_result['response']['return']['Personas']['Persona'][0]['Nombre']['FechaNacimiento']
                    - else
                      .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                        .m-alert__icon
                          = wicked_pdf_image_tag asset_url('icons/exclamation.png'), size: "30x30"
                        .m-alert__text
                          strong
                            | Aún no se encuentran datos generales.

              .page-breaker
                h4.mt-5 = "2.1.3 Resumen de Créditos (M.N.)"
                - if @credit_bureau.bureau_report.present?
                  - if @report_result['response'].present? && @report_result['response']['return']['Personas']['Persona'][0]['Cuentas'].present?
                    .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                      .m-section
                        .m-section__content
                          table.table.table-bordered.table-fix
                            thead.thead-default
                              tr
                                th
                                  | MOP
                                th
                                  | Cuentas Abiertas
                                th
                                  | Limite Abiertas
                                th
                                  | Maximo Abiertas
                                th
                                  | Saldo Actual Abiertas
                                th
                                  | Saldo Vencido Abiertas
                                th
                                  | Pago a Realizar
                                th
                                  | Cuentas Cerradas
                                th
                                  | Limite Cerradas
                                th
                                  | Maximo Cerradas
                                th
                                  | Saldo Actual Cerradas
                                th
                                  | Monto Cerradas
                            tbody
                              - get_ur_credits(@report_result['response']['return']['Personas']['Persona'][0]['Cuentas']['Cuenta']).each do |credit|
                                tr
                                  td
                                    = credit[:mop]
                                  td
                                    = credit[:cuentas_abiertas]
                                  td
                                    = number_to_currency credit[:limite_abiertas]
                                  td
                                    = number_to_currency credit[:maximo_abiertas]
                                  td
                                    = number_to_currency credit[:saldo_actual]
                                  td
                                    = number_to_currency credit[:saldo_vencido]
                                  td
                                    = number_to_currency credit[:pago_realizar]
                                  td
                                    = credit[:cuentas_cerradas]
                                  td
                                    = number_to_currency credit[:limite_cerradas]
                                  td
                                    = number_to_currency credit[:maximo_cerradas]
                                  td
                                    = number_to_currency credit[:saldo_cerradas]
                                  td
                                    = number_to_currency credit[:monto_cerradas]
              .page-breaker
                h4.mt-5 = "2.1.4 Domicilios registrados"
                - if @credit_bureau.present?
                  - if @report_result['response'].present? && @report_result['response']['return']['Personas']['Persona'][0]['Domicilios'].present?
                    - @report_result['response']['return']['Personas']['Persona'][0]['Domicilios']['Domicilio'].each do |address|
                      .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                        .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                          strong
                            | Calle y número
                        .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                          = address['Direccion1']
                        .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                          strong
                            | Colonia
                        .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                          = address['ColoniaPoblacion']
                        .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                          strong
                            | Del / Mpio
                        .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                          = address['DelegacionMunicipio']
                      .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                        .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                          strong
                            | Estado
                        .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                          = address['Estado']
                        .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                          strong
                            | C.P
                        .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                          = address['CP']
                        .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                          strong
                            | Teléfono
                        .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                          = address['NumeroTelefono']
                      br
                  - else
                    .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                      .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                        .m-alert__icon
                          = wicked_pdf_image_tag asset_url('icons/exclamation.png'), size: "30x30"
                        .m-alert__text
                          strong
                            | Aún no se encuentran domicilios registrados.
                - else
                  .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                    .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                      .m-alert__icon
                        = wicked_pdf_image_tag asset_url('icons/exclamation.png'), size: "30x30"
                      .m-alert__text
                        strong
                          | Aún no se encuentran domicilios registrados.
              .page-breaker
                h4.mt-5 = "2.1.5 Domicilio(s) de empleo(s) registrado(s)"
                - if @credit_bureau.present?
                  - if @report_result['response'].present? && @report_result['response']['return']['Personas']['Persona'][0]['Empleos'].present?
                    - @report_result['response']['return']['Personas']['Persona'][0]['Empleos']['Empleo'].each do |job|
                      .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                        .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                          strong
                            | Compañía
                        .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                          = job['NombreEmpresa']
                        .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                          strong
                            | Puesto
                        .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                          = job['Cargo']
                        .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                          strong
                            | País
                        .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                          = job['CodPais']
                      .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                        .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                          strong
                            | Calle y número
                        .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                          = job['Direccion1']
                        .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                          strong
                            | Telefono
                        .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                          = job['NumeroTelefono']
                        .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                          strong
                            | Fecha de contratación
                        .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                          = get_pm_birthdate job['FechaContratacion']

                      br
                  - else
                    .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                      .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                        .m-alert__icon
                          = wicked_pdf_image_tag asset_url('icons/exclamation.png'), size: "30x30"
                        .m-alert__text
                          strong
                            | Aún no se encuentran Domicilio(s) de empleo(s) registrado(s).
                - else
                  .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                    .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                      .m-alert__icon
                        = wicked_pdf_image_tag asset_url('icons/exclamation.png'), size: "30x30"
                      .m-alert__text
                        strong
                          | Aún no se encuentran Domicilio(s) de empleo(s) registrado(s).
              .page-breaker
                h4.mt-5 = "2.1.6 Cuentas"
                - if @credit_bureau.present?
                  - if @report_result['response'].present? && @report_result['response']['return']['Personas']['Persona'][0]['Cuentas'].present?
                    - @report_result['response']['return']['Personas']['Persona'][0]['Cuentas']['Cuenta'].each do |account|
                      .page-breaker
                        .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                          .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                            strong
                              | Nombre del Otorgante
                          .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                            = account['NombreOtorgante']
                          .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                            strong
                              | Monto a pagar
                          .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                            = number_to_currency account['MontoPagar']
                          .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                            strong
                              | Tipo de cuenta
                          .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                            = I18n.t("account_type.#{account['TipoCuenta']}")
                        .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                          .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                            strong
                              | Saldo actual
                          .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                            = account['SaldoActual']
                          .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                            strong
                              | Saldo vencido
                          .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                            = account['SaldoVencido']
                          .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                            strong
                              | Tipo de contrato
                          .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                            = I18n.t("contract_type.#{account['TipoContrato']}")
                        .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                          .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                            strong
                              | Crédito máximo
                          .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                            = number_to_currency account['CreditoMaximo']
                          .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                            strong
                              | Forma de Pago
                          .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                            = method_payment account['FormaPagoActual']
                          .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                            strong
                              | Frecuencia de pagos
                          .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                            = I18n.t("payments_frecuency.#{account['FrecuenciaPagos']}")
                        .m-stack.m-stack--ver.m-stack--general.m-stack--demo.mt-2
                          .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle.d-flex.justify-content-between.align-items-center.history-header style="padding: 0 15px;"
                            span.h4.strong
                              | Historial de pagos
                            .history-icon style="width: 50px; height: 50px;"
                              = wicked_pdf_image_tag asset_url('icons/calendario.png'), size: "20"

                      .m-stack.m-stack--ver.m-stack--general.m-stack--demo.history-table
                        .m-stack__item.body-info-company.m-stack__item--middle
                          strong
                            | Mes
                        .m-stack__item.body-info-company.m-stack__item--middle.text-center
                          strong
                            | E
                        .m-stack__item.body-info-company.m-stack__item--middle.text-center
                          strong
                            | F
                        .m-stack__item.body-info-company.m-stack__item--middle.text-center
                          strong
                            | M
                        .m-stack__item.body-info-company.m-stack__item--middle.text-center
                          strong
                            | A
                        .m-stack__item.body-info-company.m-stack__item--middle.text-center
                          strong
                            | M
                        .m-stack__item.body-info-company.m-stack__item--middle.text-center
                          strong
                            | J
                        .m-stack__item.body-info-company.m-stack__item--middle.text-center
                          strong
                            | J
                        .m-stack__item.body-info-company.m-stack__item--middle.text-center
                          strong
                            | A
                        .m-stack__item.body-info-company.m-stack__item--middle.text-center
                          strong
                            | S
                        .m-stack__item.body-info-company.m-stack__item--middle.text-center
                          strong
                            | O
                        .m-stack__item.body-info-company.m-stack__item--middle.text-center
                          strong
                            | N
                        .m-stack__item.body-info-company.m-stack__item--middle.text-center
                          strong
                            | D
                      - get_history_payments(account).each do |key, value|
                        .m-stack.m-stack--ver.m-stack--general.m-stack--demo.history-table
                          .m-stack__item.body-info-company.m-stack__item--middle
                            = key
                          - value.each do |v|
                            - if v[:value] == 0
                              .m-stack__item.body-info-company.m-stack__item--middle style="height: 50px !important;"
                            - elsif v[:value] == '1'
                              .m-stack__item.body-info-one.m-stack__item--middle style="height: 50px !important;"
                                strong
                                  = v[:value]
                            - elsif v[:value] == '2'
                              .m-stack__item.body-info-two.m-stack__item--middle style="height: 50px !important;"
                                strong
                                  = v[:value]
                            - else
                              .m-stack__item.body-info-x.m-stack__item--middle style="height: 50px !important;"
                                strong
                                  = v[:value]
                      hr.dotted
                  - else
                    .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                      .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                        .m-alert__icon
                          = wicked_pdf_image_tag asset_url('icons/exclamation.png'), size: "30x30"
                        .m-alert__text
                          strong
                            | Aún no se encuentran cuentas.
                - else
                  .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                    .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                      .m-alert__icon
                        = wicked_pdf_image_tag asset_url('icons/exclamation.png'), size: "30x30"
                      .m-alert__text
                        strong
                          | Aún no se encuentran cuentas.

                .mt-30
                  .btns-card-pdf.full-h
                    .d-flex.flex-column.justify-content-between
                      h5.h5.subtitle = 'Comentarios'
                      .m-widget3
                        - if @cb_comments.length > 0
                          - @cb_comments.each do |comment|
                            .m-widget3__item
                              .m-widget3__header
                                .m-widget3__info
                                  span.m-widget3__username
                                    = User.where(id: comment.user_id).try(:first).full_name
                                  span.m-widget3__time
                                    = " - #{comment.created_at.strftime('%d/%m/%Y,  %I:%M%p')}"
                              p.comment-bubbled
                                = comment.comment
                                b.aft
                        - else
                          .m-widget3__item
                            .m-widget3__body
                              p.m-widget3__text
                                .text-center
                                  | Aún no hay comentarios.
              .page-breaker
                h4.mt-5 = "2.1.7 Consultas"
                - if @credit_bureau.bureau_report.present?
                  - @credit_bureau['bureau_report']['results'].each do |bureau_report|
                    - if bureau_report['status']
                      .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                        .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                          = I18n.t("report_type.#{bureau_report['metadata']['reportType']}")
                        .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                          = bureau_report['status']
                        .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                          = bureau_report['createdAt'].to_datetime.strftime('%d-%m-%Y')
                - else
                  .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                    .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                      .m-alert__icon
                        = wicked_pdf_image_tag asset_url('icons/exclamation.png'), size: "30x30"
                      .m-alert__text
                        strong
                          | Aún no se encuentran consultas.
              .page-breaker
                h4.mt-5 = "2.1.8 Información de HAWK"
                - if @credit_bureau.bureau_report.present?
                  - if @credit_bureau['bureau_report']['response']['return']['Personas']['Persona'][0]['HawkAlertBD'].present?
                    .page-breaker
                      .m-stack.m-stack--ver.m-stack--general.m-stack--demo.mt-2
                        .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                          h4.strong
                            | Mensaje de prevención
                      .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                        .m-section
                          .m-section__content
                            table.table.table-bordered.table-fix style="display: table;overflow-x: auto;"
                              thead.thead-default
                                tr
                                  th
                                    | Fecha de
                                  th
                                    | Clave
                                  th
                                    | Institución
                                  th
                                    | Mensaje

                              tbody
                                - @credit_bureau['bureau_report']['response']['return']['Personas']['Persona'][0]['HawkAlertBD']['HawkAlertBD'].each_with_index do |hawk|
                                  - if hawk['CodigoClave'] == '010'
                                    tr
                                      td
                                        = format_date hawk['FechaReporte']
                                      td
                                        = hawk['CodigoClave']
                                      td
                                        = hawk['TipoInstitucion']
                                      td
                                        = hawk['Mensaje']

                    .page-breaker
                      .m-stack.m-stack--ver.m-stack--general.m-stack--demo.mt-2
                        .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                          h4.strong
                            | Mensaje por inconsistencia de datos
                      .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                        .m-section
                          .m-section__content
                            table.table.table-bordered.table-fix style="display: table;overflow-x: auto;"
                              thead.thead-default
                                tr
                                  th
                                    | Fecha de
                                  th
                                    | Clave
                                  th
                                    | Institución
                                  th
                                    | Mensaje
                              tbody
                                - @credit_bureau['bureau_report']['response']['return']['Personas']['Persona'][0]['HawkAlertBD']['HawkAlertBD'].each_with_index do |hawk|
                                  - if hawk['CodigoClave'] == '850' || hawk['CodigoClave'] == '860'
                                    tr
                                      td
                                        = format_date hawk['FechaReporte']
                                      td
                                        = hawk['CodigoClave']
                                      td
                                        = hawk['TipoInstitucion']
                                      td
                                        = hawk['Mensaje']

                    .page-breaker
                      .m-stack.m-stack--ver.m-stack--general.m-stack--demo.mt-2
                        .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                          h4.strong
                            | Mensaje por información de juicios (Nombre del consultado asociado a un juicio como demandado)
                      .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                        .m-section
                          .m-section__content
                            table.table.table-bordered.table-fix style="display: table;overflow-x: auto;"
                              thead.thead-default
                                tr
                                  th
                                    | Fecha de
                                  th
                                    | Clave
                                  th
                                    | Institución
                                  th
                                    | Mensaje
                              tbody
                                - if @credit_bureau['bureau_report']['response']['return']['Personas']['Persona'][0]['HawkAlertBD'].present?
                                  - @credit_bureau['bureau_report']['response']['return']['Personas']['Persona'][0]['HawkAlertBD']['HawkAlertBD'].each_with_index do |hawk|
                                    - if hawk['CodigoClave'] == '990'
                                      tr
                                        td
                                          = format_date hawk['FechaReporte']
                                        td
                                          = hawk['CodigoClave']
                                        td
                                          = hawk['TipoInstitucion']
                                        td
                                          = hawk['Mensaje']
                                - if @credit_bureau['bureau_report']['response']['return']['Personas']['Persona'][0]['HawkAlertConsulta'].present?
                                  - @credit_bureau['bureau_report']['response']['return']['Personas']['Persona'][0]['HawkAlertConsulta']['HawkAlertC'].each_with_index do |hawk|
                                    - if hawk['CodigoClave'] == '990'
                                      tr
                                        td
                                          = format_date hawk['FechaReporte']
                                        td
                                          = hawk['CodigoClave']
                                        td
                                          = hawk['TipoInstitucion']
                                        td
                                          = hawk['Mensaje']
                  - else
                    .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                      .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                        .m-alert__icon
                          i.flaticon-exclamation-1
                          span
                        .m-alert__text
                          strong
                            | Aún no se encuentra Información de HAWK.
                - else
                  .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                    .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                      .m-alert__icon
                        i.flaticon-exclamation-1
                        span
                      .m-alert__text
                        strong
                          | Aún no se encuentra Información de HAWK.
              .page-breaker
                h4.mt-5 = "2.1.9 Detalle de las consultas"
                - if @credit_bureau.bureau_report.present?
                  - if @credit_bureau['bureau_report']['response']['return']['Personas']['Persona'][0]['ConsultasEfectuadas'].present?
                    .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                      .m-section
                        .m-section__content
                          table.table.table-bordered.table-fix style="display: table;overflow-x: auto;"
                            thead.thead-default
                              tr
                                th
                                  | Otorgante
                                th
                                  | Fecha de la consulta
                                th
                                  | Responsabilidad
                                th
                                  | Tipo de contrato
                                th
                                  | Importe

                            tbody
                              - @credit_bureau['bureau_report']['response']['return']['Personas']['Persona'][0]['ConsultasEfectuadas']['ConsultaEfectuada'].each_with_index do |consulta|
                                tr
                                  td
                                    = consulta['NombreOtorgante']
                                  td
                                    = format_date consulta['FechaConsulta']
                                  td
                                    = consulta['IndicadorTipoResponsabilidad'].present? ? I18n.t("tipo_responsabilidad.#{consulta['IndicadorTipoResponsabilidad']}") : ''
                                  td
                                    = I18n.t("tipo_contrato.#{consulta['TipoContrato']}")
                                  td
                                    = consulta['ImporteContrato']
                  - else
                    .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                      .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                        .m-alert__icon
                          = wicked_pdf_image_tag asset_url('icons/exclamation.png'), size: "30x30"
                        .m-alert__text
                          strong
                            | Aún no se encuentra detalle de las conusltas.
                - else
                  .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                    .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                      .m-alert__icon
                        = wicked_pdf_image_tag asset_url('icons/exclamation.png'), size: "30x30"
                      .m-alert__text
                        strong
                          | Aún no se encuentra detalle de las conusltas.
            - elsif (@credit_bureau.present? and @company.try(:client_type).eql?('PM')) || (@credit_bureau.present? and @company.try(:client_type).eql?('PFAE'))
              .page-breaker
                h4.mt-5 = "2.1.1 Calificación cartera"
                - if @credit_bureau.present?
                  - if @report_result['query'].present?
                    .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                      .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                        strong
                          | Calificación cartera
                      .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                        - if @report_result['response']['respuesta']['datosGenerales'].present?
                          strong
                            = @report_result['response']['respuesta']['datosGenerales']['calificacionCartera'].present? ? @report_result['response']['respuesta']['datosGenerales']['calificacionCartera'].tr('0', '') : 'N/D'
                        - else
                          strong
                            | N/D
                  - else
                    .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                      .m-alert__icon
                        = wicked_pdf_image_tag asset_url('icons/exclamation.png'), size: "30x30"
                      .m-alert__text
                        strong
                          | Aún no se encuentra calificación.
                - else
                  .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                    .m-alert__icon
                      = wicked_pdf_image_tag asset_url('icons/exclamation.png'), size: "30x30"
                    .m-alert__text
                      strong
                        | Aún no se encuentra calificación.

              .page-breaker
                h4.mt-5 = "2.1.2 Datos Generales"
                .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                  - if @credit_bureau.present?
                    - if @report_result['query'].present?
                      .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                        strong
                          | Nombre
                      .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                        strong
                          = @report_result['query']['consulta']['persona']['nombre']
                      .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                        strong
                          | R.F.C
                      .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                        strong
                          = @report_result['query']['consulta']['persona']['rfc']

                    - else
                      .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                        .m-alert__icon
                          = wicked_pdf_image_tag asset_url('icons/exclamation.png'), size: "30x30"
                        .m-alert__text
                          strong
                            | Aún no se encuentran datos generales.
                  - else
                    .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                      .m-alert__icon
                        = wicked_pdf_image_tag asset_url('icons/exclamation.png'), size: "30x30"
                      .m-alert__text
                        strong
                          | Aún no se encuentran datos generales.
              .page-breaker
                h4.mt-5 = "2.1.3 Domicilio registrado"
                - if @credit_bureau.present?
                  - if @report_result['query'].present?
                    .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                      .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                        strong
                          | Calle y número
                      .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                        = @report_result['response']['respuesta']['datosGenerales'].present? ? @report_result['response']['respuesta']['datosGenerales']['direccion1'] : 'N/D'
                      .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                        strong
                          | Colonia
                      .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                        = @report_result['response']['respuesta']['datosGenerales'].present? ? @report_result['response']['respuesta']['datosGenerales']['coloniaPoblacion'] : 'N/D'
                      .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                        strong
                          | Del / Mpio
                      .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                        = @report_result['response']['respuesta']['datosGenerales'].present? ? @report_result['response']['respuesta']['datosGenerales']['delegacionMunicipio'] : 'N/D'
                    .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                      .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                        strong
                          | Estado
                      .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                        = @report_result['response']['respuesta']['datosGenerales'].present? ? @report_result['response']['respuesta']['datosGenerales']['estado'] : 'N/D'
                      .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                        strong
                          | C.P
                      .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                        = @report_result['response']['respuesta']['datosGenerales'].present? ? @report_result['response']['respuesta']['datosGenerales']['codigoPostal'] : 'N/D'
                      .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                        strong
                          | Teléfono
                      .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                        = @report_result['response']['respuesta']['datosGenerales'].present? ? @report_result['response']['respuesta']['datosGenerales']['telefono'] : 'N/D'
                    br
                  - else
                    .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                      .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                        .m-alert__icon
                          = wicked_pdf_image_tag asset_url('icons/exclamation.png'), size: "30x30"
                        .m-alert__text
                          strong
                            | Aún no se encuentran domicilios registrados.
                - else
                  .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                    .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                      .m-alert__icon
                        = wicked_pdf_image_tag asset_url('icons/exclamation.png'), size: "30x30"
                      .m-alert__text
                        strong
                          | Aún no se encuentran domicilios registrados.
              .page-breaker
                h4.mt-5 = "2.1.4 Resumen créditos activos"
                - if @credit_bureau.bureau_report.present?
                  - if @report_result['response'].present?
                    .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                      .m-section
                        .m-section__content
                          table.table.table-bordered.table-fix style="display: table; overflow-x: auto; font-size: 10px;"
                            thead.thead-default
                              tr
                                th
                                  | Tipo de Otorgante
                                th
                                  | Tipo de Crédito
                                th
                                  | Cuentas Abiertas
                                th
                                  | Cuentas en MXP
                                th
                                  | Cuentas en USD
                                th
                                  | Otras Monedas
                                th
                                  | Original
                                th
                                  | Saldo Actual
                                th
                                  | Vigente
                                th
                                  | 1-29 días
                                th
                                  | 30-59 días
                                th
                                  | 60-89 días
                                th
                                  | 90-119 días
                                th
                                  | 120 - 179 días
                                th
                                  | 180+ días
                            tbody
                              - get_active_credits(@report_result['response']['respuesta']['creditoFinanciero']).each do |active_credit|
                                tr
                                  th
                                    = active_credit[:otorgante]
                                  th
                                    = active_credit[:tipo_credito]
                                  th
                                    = active_credit[:cuentas_abiertas]
                                  th
                                    = active_credit[:cuentas_mxp]
                                  th
                                    = active_credit[:cuentas_usd]
                                  th
                                    = active_credit[:otras_monedas]
                                  th
                                    = number_to_currency active_credit[:original]
                                  th
                                    = number_to_currency active_credit[:saldo_actual]
                                  th
                                    = number_to_currency active_credit[:vigente]
                                  th
                                    = active_credit[:one]
                                  th
                                    = active_credit[:thirty]
                                  th
                                    = active_credit[:sixty]
                                  th
                                    = active_credit[:ninety]
                                  th
                                    = active_credit[:one_twenty]
                                  th
                                    = active_credit[:one_eighty]
                              - get_total_active_credits(@report_result['response']['respuesta']['creditoFinanciero']).each do |active_credit|
                                tr
                                  th colspan="2"
                                    | Total
                                  th
                                    = active_credit[:cuentas_abiertas]
                                  th
                                    = active_credit[:cuentas_mxp]
                                  th
                                    = active_credit[:cuentas_usd]
                                  th
                                    = active_credit[:otras_monedas]
                                  th
                                    = number_to_currency active_credit[:original]
                                  th
                                    = number_to_currency active_credit[:saldo_actual]
                                  th
                                    = number_to_currency active_credit[:vigente]
                                  th
                                    = active_credit[:one]
                                  th
                                    = active_credit[:thirty]
                                  th
                                    = active_credit[:sixty]
                                  th
                                    = active_credit[:ninety]
                                  th
                                    = active_credit[:one_twenty]
                                  th
                                    = active_credit[:one_eighty]

                  - else
                    .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                      .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                        .m-alert__icon
                          = wicked_pdf_image_tag asset_url('icons/exclamation.png'), size: "30x30"
                        .m-alert__text
                          strong
                            | Aún no se encuentran creditos activos.
                - else
                  .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                    .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                      .m-alert__icon
                        = wicked_pdf_image_tag asset_url('icons/exclamation.png'), size: "30x30"
                      .m-alert__text
                        strong
                          | Aún no se encuentran creditos activos.
              .page-breaker
                h4.mt-5 = "2.1.5 Historia"
                - if @credit_bureau.present?
                  - if @report_result['response'].present?
                    - split_months = @report_result['response']['respuesta']['historia'].length / 8.0
                    - if split_months % 1 != 0
                      - split_months += 1
                    - starting = 0
                    - ending = 8
                    .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                      .m-section
                        .m-section__content
                          table.table.table-bordered.table-fix style="display: block;overflow-x: auto;"
                            - for a in 1..split_months do
                              thead.thead-default style="border-bottom: 2px solid; margin-bottom:15px;"
                                tr
                                  th
                                  - @report_result['response']['respuesta']['historia'][starting..ending].each do |historia|
                                    th
                                      = get_date historia['periodo']
                              tbody
                                tr
                                  th
                                    | Vigente
                                  - @report_result['response']['respuesta']['historia'][starting..ending].each do |historia|
                                    th
                                      = number_to_currency historia['saldoVigente']
                                tr
                                  th
                                    | Vencido de 1 a 29 días
                                  - @report_result['response']['respuesta']['historia'][starting..ending].each do |historia|
                                    th
                                      = number_to_currency historia['saldoVencidoA90Dias']
                                tr
                                  th
                                    | Vencido de 30 a 59 días
                                  - @report_result['response']['respuesta']['historia'][starting..ending].each do |historia|
                                    th
                                      = number_to_currency historia['saldoVencido1A29Dias']
                                tr
                                  th
                                    | Vencido de 60 a 89 días
                                  - @report_result['response']['respuesta']['historia'][starting..ending].each do |historia|
                                    th
                                      = number_to_currency historia['saldoVencido30A59Dias']
                                tr
                                  th
                                    | Vencido de a mas de 89 días
                                  - @report_result['response']['respuesta']['historia'][starting..ending].each do |historia|
                                    th
                                      = number_to_currency historia['saldoVencido60A89Dias']
                                tr
                                  th
                                    | Calificación de cartera
                                  - @report_result['response']['respuesta']['historia'][starting..ending].each do |historia|
                                    th
                                      = historia['calificacioncartera'].present? ? historia['calificacioncartera'] : 'N/D'

                              - starting += 7
                              - ending += 7

                  - else
                    .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                      .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                        .m-alert__icon
                          = wicked_pdf_image_tag asset_url('icons/exclamation.png'), size: "30x30"
                        .m-alert__text
                          strong
                            | Aún no se encuentran creditos activos.
                - else
                  .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                    .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                      .m-alert__icon
                        = wicked_pdf_image_tag asset_url('icons/exclamation.png'), size: "30x30"
                      .m-alert__text
                        strong
                          | Aún no se encuentran creditos activos.
              .page-breaker
                h4.mt-5 = "2.1.6 Consultas"
                - if false
                -
                else
                  .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                    .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                      .m-alert__icon
                        = wicked_pdf_image_tag asset_url('icons/exclamation.png'), size: "30x30"
                      .m-alert__text
                        strong
                          | Aún no se encuentran consultas.
              .page-breaker
                h4.mt-5 = "2.1.7 Información de HAWK"
                - if @credit_bureau.bureau_report.present?
                  - if @credit_bureau['bureau_report']['results'].present?
                    .m-stack.m-stack--ver.m-stack--general.m-stack--demo.mt-2
                      .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle.d-flex.justify-content-between.align-items-center.history-header
                        h4.strong
                          | HAWK (Mensajes de prevención)
                        .history-icon
                          i.fa.fa-calendar-check.fa-2x.lightgray-text
                    .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                      .m-section
                        .m-section__content
                          table.table style="display: block;overflow-x: auto;"
                            thead.thead-default
                              tr
                                th
                                  | Fecha de
                                th
                                  | Clave
                                th
                                  | Descripción
                                th
                                  | Responsabilidad
                                th
                                  | Reportado por
                                th
                                  | Mensaje
                                th
                                  | Coincidenciapor datos de

                            tbody
                              tr
                                th
                                  = format_date @credit_bureau['bureau_report']['response']['respuesta']['hawkHr']['fechaMensajeHawk']
                                th
                                  = @credit_bureau['bureau_report']['response']['respuesta']['hawkHr']['codigoHawk']
                                th
                                th
                                th
                                th
                                  = @credit_bureau['bureau_report']['response']['respuesta']['hawkHr']['descripcionPrevencionHawk']
                                th
                                  | COINCIDENCIA POR EXPEDIENTE
                  - else
                    .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                      .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                        .m-alert__icon
                          = wicked_pdf_image_tag asset_url('icons/exclamation.png'), size: "30x30"
                        .m-alert__text
                          strong
                            | Aún no se encuentra Información de HAWK.
                - else
                  .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                    .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                      .m-alert__icon
                        = wicked_pdf_image_tag asset_url('icons/exclamation.png'), size: "30x30"
                      .m-alert__text
                        strong
                          | Aún no se encuentra Información de HAWK.

              .page-breaker
                h4.mt-5 = "2.1.8 Accionistas"
                - if @credit_bureau.bureau_report.present?
                  - if @credit_bureau['bureau_report']['results'].present?
                    .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                      .m-section
                        .m-section__content
                          table.table style="display: block;overflow-x: auto;"
                            thead.thead-default
                              tr
                                th
                                  | RFC
                                th
                                  | Nombre Accionista
                                th
                                  | Porcentaje
                            tbody
                              tr
                                th
                                  = @credit_bureau['bureau_report']['response']['respuesta']['accionista']['rfc']
                                th
                                  = @credit_bureau['bureau_report']['response']['respuesta']['accionista']['nombreAccionista'] + ' ' + @credit_bureau['bureau_report']['response']['respuesta']['accionista']['segundoNombre'] + ' ' + @credit_bureau['bureau_report']['response']['respuesta']['accionista']['apellidoPaterno'] + ' ' + @credit_bureau['bureau_report']['response']['respuesta']['accionista']['apellidoMaterno']
                                th
                                  = @credit_bureau['bureau_report']['response']['respuesta']['accionista']['porcentaje'] + '%'

                  - else
                    .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                      .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                        .m-alert__icon
                          = wicked_pdf_image_tag asset_url('icons/exclamation.png'), size: "30x30"
                        .m-alert__text
                          strong
                            | Aún no se encuentran accionistas.
                - else
                  .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                    .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                      .m-alert__icon
                        = wicked_pdf_image_tag asset_url('icons/exclamation.png'), size: "30x30"
                      .m-alert__text
                        strong
                          | Aún no se encuentran accionistas.

              .page-breaker
                h4.mt-5 = "2.1.9 Créditos activos"
                - if @credit_bureau.bureau_report.present?

                  .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                    .m-section
                      .m-section__content
                        table.table style="display: block;overflow-x: auto;"
                          thead.thead-default
                            tr
                              th
                                | Contrato
                              th
                                | Tipo de Otorgante
                              th
                                | Tipo de Crédito
                              th
                                | Moneda
                              th
                                | Otorgado en
                              th
                                | Plazo
                              th
                                | Original
                              th
                                | Vigente
                              th
                                | 1-29 días
                              th
                                | 30-59 días
                              th
                                | 60-89 días
                              th
                                | 90-119 días
                              th
                                | 120-179 días
                              th
                                | 180+ días
                              th
                                | Días de atraso
                              th
                                | Historico de Pagos Claves de Observación
                              th
                                | Actualizado en

                          tbody
                            - @credit_bureau['bureau_report']['response']['respuesta']['creditoFinanciero'].each do |creditos|
                              - unless creditos['fechaCierre'].present?
                                tr
                                  th
                                    = creditos['numeroCuenta']
                                  th
                                    = creditos['tipoUsuario']
                                  th
                                    = I18n.t("credits_type.#{creditos['tipoCredito']}")
                                  th
                                    = I18n.t("moneda.#{creditos['moneda']}") + '$' + creditos['tipoCambio']
                                  th
                                    = creditos['apertura']
                                  th
                                    = creditos['plazo']
                                  th
                                    = creditos['saldoInicial']
                                  th
                                    = creditos['saldoVigente']
                                  th
                                    = creditos['saldoVencidoDe1a29Dias']
                                  th
                                    = creditos['saldoVencidoDe30a59Dias']
                                  th
                                    = creditos['saldoVencidoDe60a89Dias']
                                  th
                                    = creditos['saldoVencidoDe90a119Dias']
                                  th
                                    = creditos['saldoVencidoDe120a179Dias']
                                  th
                                    = creditos['saldoVencidoDe180DiasOMas']
                                  th
                                    = creditos['atrasoMayor']
                                  th
                                    = creditos['historicoPagos']
                                  th
                                    = format_date_updated_at creditos['ultimoPeriodoActualizado']


                - else
                .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                  .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                    .m-alert__icon
                      = wicked_pdf_image_tag asset_url('icons/exclamation.png'), size: "30x30"
                    .m-alert__text
                      strong
                        | Aún no se créditos activos
              .page-breaker
                h4.mt-5 = "2.1.10 Créditos liquidados"
                - if @credit_bureau.bureau_report.present?
                  - if @credit_bureau['bureau_report'].present?
                    .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                      .m-section
                        .m-section__content
                          table.table style="display: block;overflow-x: auto;"
                            thead.thead-default
                              tr
                                th
                                  | Contrtato
                                th
                                  | Tipo de Otorgante
                                th
                                  | Tipo de Crédito
                                th
                                  | Moneda
                                th
                                  | Otorgado en
                                th
                                  | Plazo
                                th
                                  | Original
                                th
                                  | Días de atraso
                                th
                                  | Historico de Pagos Claves de Observación
                                th
                                  | Liquidado en
                                th
                                  | Quita
                                th
                                  | Dación
                                th
                                  | Pago
                                th
                                  | Quebranto
                                th
                                  | Actualizado en

                            tbody
                              - @credit_bureau['bureau_report']['response']['respuesta']['creditoFinanciero'].each do |creditos|
                                - if creditos['fechaCierre'].present?
                                  tr
                                    th
                                      = creditos['numeroCuenta']
                                    th
                                      = creditos['tipoUsuario']
                                    th
                                      = I18n.t("credits_type.#{creditos['tipoCredito']}")
                                    th
                                      = I18n.t("moneda.#{creditos['moneda']}") + '$' + creditos['tipoCambio']
                                    th
                                      = creditos['apertura']
                                    th
                                      = creditos['plazo']
                                    th
                                      = creditos['saldoInicial']
                                    th
                                      = creditos['atrasoMayor']
                                    th
                                      = creditos['historicoPagos']
                                    th
                                      = creditos['fechaCierre']
                                    th
                                      = creditos['quita']
                                    th
                                      = creditos['dacion']
                                    th
                                      = creditos['pagoCierre']
                                    th
                                      = creditos['quebranto']
                                    th
                                      = format_date_updated_at creditos['ultimoPeriodoActualizado']

                  - else
                    .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                      .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                        .m-alert__icon
                          = wicked_pdf_image_tag asset_url('icons/exclamation.png'), size: "30x30"
                        .m-alert__text
                          strong
                            | Aún no se encuentran créditos liquidados.
                - else
                  .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                    .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                      .m-alert__icon
                        = wicked_pdf_image_tag asset_url('icons/exclamation.png'), size: "30x30"
                      .m-alert__text
                        strong
                          | Aún no se encuentran créditos liquidados.

              .page-breaker
                h4.mt-5 = "2.1.11 Resumen de créditos liquidados"
                - if @credit_bureau.bureau_report.present?
                  - if @report_result['response'].present?
                    .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                      .m-section
                        .m-section__content
                          table.table.table-bordered.table-fix style="display: block;overflow-x: auto;"
                            thead.thead-default
                              tr
                                th
                                  | Tipo de Otorgante
                                th
                                  | Tipo de Crédito
                                th
                                  | Cuentas Cerradas
                                th
                                  | Cuentas en MXP
                                th
                                  | Cuentas en USD
                                th
                                  | Otras Monedas
                                th
                                  | Original
                                th
                                  | Quita
                                th
                                  | Dación
                                th
                                  | Pago
                                th
                                  | Quebranto
                            tbody
                              - get_closed_credits(@report_result['response']['respuesta']['creditoFinanciero']).each do |active_credit|
                                tr
                                  th
                                    = active_credit[:otorgante]
                                  th
                                    = active_credit[:tipo_credito]
                                  th
                                    = active_credit[:cuentas_abiertas]
                                  th
                                    = active_credit[:cuentas_mxp]
                                  th
                                    = active_credit[:cuentas_usd]
                                  th
                                    = active_credit[:otras_monedas]
                                  th
                                    = number_to_currency active_credit[:original]
                                  th
                                    = number_to_currency active_credit[:quita]
                                  th
                                    = number_to_currency active_credit[:dacion]
                                  th
                                    = number_to_currency active_credit[:pago]
                                  th
                                    = number_to_currency active_credit[:quebranto]


                              - get_total_closed_credits(@report_result['response']['respuesta']['creditoFinanciero']).each do |active_credit|
                                tr
                                  th colspan="2"
                                    | Total
                                  th
                                    = active_credit[:cuentas_abiertas]
                                  th
                                    = active_credit[:cuentas_mxp]
                                  th
                                    = active_credit[:cuentas_usd]
                                  th
                                    = active_credit[:otras_monedas]
                                  th
                                    = number_to_currency active_credit[:original]
                                  th
                                    = number_to_currency active_credit[:quita]
                                  th
                                    = number_to_currency active_credit[:dacion]
                                  th
                                    = number_to_currency active_credit[:pago]
                                  th
                                    = number_to_currency active_credit[:quebranto]

                  - else
                    .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                      .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                        .m-alert__icon
                          = wicked_pdf_image_tag asset_url('icons/exclamation.png'), size: "30x30"
                        .m-alert__text
                          strong
                            | Aún no se encuentran creditos liquidados.
                - else
                  .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                    .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                      .m-alert__icon
                        = wicked_pdf_image_tag asset_url('icons/exclamation.png'), size: "30x30"
                      .m-alert__text
                        strong
                          | Aún no se encuentran creditos liquidados.
            - else
              .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                .m-alert__icon
                  = wicked_pdf_image_tag asset_url('icons/exclamation.png'), size: "30x30"
                .m-alert__text
                  strong
                    | Aún no se le ha asignado el buró de crédito.

            .mt-30
              .btns-card-pdf.full-h
                .d-flex.flex-column.justify-content-between
                  span.h5.subtitle = 'Comentarios'
                  .m-widget3
                    - if @cb_comments.length > 0
                      - @cb_comments.each do |comment|
                        .m-widget3__item
                          .m-widget3__header
                            .m-widget3__info
                              span.m-widget3__username
                                = User.where(id: comment.user_id).try(:first).full_name
                              span.m-widget3__time
                                = " - #{comment.created_at.strftime('%d/%m/%Y,  %I:%M%p')}"
                          p.comment-bubbled
                            = comment.comment
                            b.aft
                    - else
                      .m-widget3__item
                        .m-widget3__body
                          p.m-widget3__text
                            .text-center
                              | Aún no hay comentarios.

        .col-md-12.my-4.page-breaker
          hr.hr-title
          div style="position:relative;"
            h2.subtitle-st
              span = "3. Información Financiera"
          .col-md-12.my-4
            h3 = "3.1 Estado de Resultados"
            - if @company.company_calendar_details.where(assign_to: 'income_statement').present?
              table.table.table-bordered.input-focusable-table.table-fix
                tr.tr-title
                  th
                  - @calendar_periods_is.each do |y|
                    th.th-title id="col-#{y.id}_head"
                      = y.calendar.period_name
                tr.tr-rdata
                  td.td-title style=" font-weight: 800; font-size: 18px" rowspan="2"
                    span.fill-td.text-left = 'Ingresos'
                  - @calendar_periods_is.each_with_index do |y, y_index|
                    td.sum_input.sat_value class="full-input col-#{y.id}"
                      - if y.calendar.period_type == 'anual'
                        /div class=['percentage-badge', calculate_percentage('income_statement', @company.id, y.calendar, 1, @ins_scale)[1]]
                          span#comparative_table_is class=["percent-bdg0-#{y_index}"] = "#{calculate_percentage('income_statement', @company.id, y.calendar, 1, @ins_scale)[0]} %"
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value0 = company_income_stat_value(@company.id, y.calendar, 1, @ins_scale).to_s(:delimited)
                        span.value-scale = @ins_scale
                tr.tr-rdata
                  - @calendar_periods_is.each do |y|
                    td.sum_input class="full-input col-#{y.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value1 = income_calendar_detail_value(@company.id, y.calendar, 1, @ins_scale).to_s(:delimited)
                      span.value-scale = @ins_scale
                tr.tr-rdata
                  td.td-title style=" font-weight: 800; font-size: 18px" rowspan="2"
                    span.fill-td.text-left = 'Costo de ventas'
                  - @calendar_periods_is.each_with_index do |y, y_index|
                    td.sum_input class="full-input col-#{y.id}"
                      - if y.calendar.period_type == 'anual'
                        /div class=['percentage-badge', calculate_percentage('income_statement', @company.id, y.calendar, 2, @ins_scale)[1]]
                          span#comparative_table_is class=["percent-bdg1-#{y_index}"] = "#{calculate_percentage('income_statement', @company.id, y.calendar, 2, @ins_scale)[0]} %"
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value2 = company_income_stat_value(@company.id, y.calendar, 2, @ins_scale).to_s(:delimited)
                        span.value-scale = @ins_scale
                tr.tr-rdata
                  - @calendar_periods_is.each do |y|
                    td.sum_input class="full-input col-#{y.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value3 = income_calendar_detail_value(@company.id, y.calendar, 2, @ins_scale).to_s(:delimited)
                      span.value-scale = @bs_scale
                tr.tr-rdata
                  td.td-title style=" font-weight: 800; font-size: 18px" rowspan="2"
                    span.fill-td.text-left = 'Utilidad Bruta'
                  - @calendar_periods_is.each_with_index do |y, y_index|
                    td.sum_input class="full-input col-#{y.id}"
                      - if y.calendar.period_type == 'anual'
                        /div class=['percentage-badge', calculate_percentage('income_statement', @company.id, y.calendar, 3, @ins_scale)[1]]
                          span#comparative_table_is class=["percent-bdg2-#{y_index}"] = "#{calculate_percentage('income_statement', @company.id, y.calendar, 2, @ins_scale)[0]} %"
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value4 = company_income_stat_value(@company.id, y.calendar, 3, @ins_scale).to_s(:delimited)
                        span.value-scale = @ins_scale
                tr.tr-rdata
                  - @calendar_periods_is.each do |y|
                    td.sum_input class="full-input col-#{y.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value5 = income_calendar_detail_value(@company.id, y.calendar, 3, @ins_scale).to_s(:delimited)
                      span.value-scale = @ins_scale

                tr.tr-rdata
                  td.td-title style=" font-weight: 800; font-size: 18px" rowspan="2"
                    span.fill-td.text-left = 'Gastos de operación'
                  - @calendar_periods_is.each_with_index do |y, y_index|
                    td.sum_input class="full-input col-#{y.id}"
                      - if y.calendar.period_type == 'anual'
                        /div class=['percentage-badge', calculate_percentage('income_statement', @company.id, y.calendar, 4, @ins_scale)[1]]
                          span#comparative_table_is class=["percent-bdg3-#{y_index}"] = "#{calculate_percentage('income_statement', @company.id, y.calendar, 4, @ins_scale)[0]} %"
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value6 = company_income_stat_value(@company.id, y.calendar, 4, @ins_scale).to_s(:delimited)
                        span.value-scale = @ins_scale
                tr.tr-rdata
                  - @calendar_periods_is.each do |y|
                    td.sum_input class="full-input col-#{y.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value7 = income_calendar_detail_value(@company.id, y.calendar, 4, @ins_scale).to_s(:delimited)
                      span.value-scale = @ins_scale

                tr.tr-rdata
                  td.td-title style=" font-weight: 800; font-size: 18px" rowspan="2"
                    span.fill-td.text-left = 'Utilidad de operación'
                  - @calendar_periods_is.each_with_index do |y, y_index|
                    td.sum_input class="full-input col-#{y.id}"
                      - if y.calendar.period_type == 'anual'
                        /div class=['percentage-badge', calculate_percentage('income_statement', @company.id, y.calendar, 5, @ins_scale)[1]]
                          span#comparative_table_is class=["percent-bdg4-#{y_index}"] = "#{calculate_percentage('income_statement', @company.id, y.calendar, 5, @ins_scale)[0]} %"
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value8 = company_income_stat_value(@company.id, y.calendar, 5, @ins_scale).to_s(:delimited)
                        span.value-scale = @ins_scale

                tr.tr-rdata
                  - @calendar_periods_is.each do |y|
                    td.sum_input class="full-input col-#{y.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value9 = income_calendar_detail_value(@company.id, y.calendar, 5, @ins_scale).to_s(:delimited)
                      span.value-scale = @ins_scale

                tr.tr-rdata
                  td.td-title style=" font-weight: 800; font-size: 18px" rowspan="2"
                    span.fill-td.text-left = 'Resultado integral de financiamiento'
                  - @calendar_periods_is.each_with_index do |y, y_index|
                    td.sum_input class="full-input col-#{y.id}"
                      - if y.calendar.period_type == 'anual'
                        /div class=['percentage-badge', calculate_percentage('income_statement', @company.id, y.calendar, 6, @ins_scale)[1]]
                          span#comparative_table_is class=["percent-bdg5-#{y_index}"] = "#{calculate_percentage('income_statement', @company.id, y.calendar, 6, @ins_scale)[0]} %"
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value10 = company_income_stat_value(@company.id, y.calendar, 6, @ins_scale).to_s(:delimited)
                        span.value-scale = @ins_scale

                tr.tr-rdata
                  - @calendar_periods_is.each do |y|
                    td.sum_input class="full-input col-#{y.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value11 = income_calendar_detail_value(@company.id, y.calendar, 6, @ins_scale).to_s(:delimited)
                      span.value-scale = @ins_scale

                tr.tr-rdata
                  td.td-title style=" font-weight: 800; font-size: 18px" rowspan="2"
                    span.fill-td.text-left = 'Gasto financiero'
                  - @calendar_periods_is.each_with_index do |y, y_index|
                    td.sum_input class="full-input col-#{y.id}"
                      - if y.calendar.period_type == 'anual'
                        /div class=['percentage-badge', calculate_percentage('income_statement', @company.id, y.calendar, 7, @ins_scale)[1]]
                          span#comparative_table_is class=["percent-bdg6-#{y_index}"] = "#{calculate_percentage('income_statement', @company.id, y.calendar, 7, @ins_scale)[0]} %"
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value12 = company_income_stat_value(@company.id, y.calendar, 7, @ins_scale).to_s(:delimited)
                        span.value-scale = @ins_scale

                tr.tr-rdata
                  - @calendar_periods_is.each do |y|
                    td.sum_input class="full-input col-#{y.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value13 = income_calendar_detail_value(@company.id, y.calendar, 7, @ins_scale).to_s(:delimited)
                      span.value-scale = @ins_scale

                tr.tr-rdata
                  td.td-title style=" font-weight: 800; font-size: 18px" rowspan="2"
                    span.fill-td.text-left = 'Utilidad o pérdida cambiaria'
                  - @calendar_periods_is.each_with_index do |y, y_index|
                    td.sum_input class="full-input col-#{y.id}"
                      - if y.calendar.period_type == 'anual'
                        /div class=['percentage-badge', calculate_percentage('income_statement', @company.id, y.calendar, 8, @ins_scale)[1]]
                          span#comparative_table_is class=["percent-bdg7-#{y_index}"] = "#{calculate_percentage('income_statement', @company.id, y.calendar, 8, @ins_scale)[0]} %"
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value14 = company_income_stat_value(@company.id, y.calendar, 8, @ins_scale).to_s(:delimited)
                        span.value-scale = @ins_scale

                tr.tr-rdata
                  - @calendar_periods_is.each do |y|
                    td.sum_input class="full-input col-#{y.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value15 = income_calendar_detail_value(@company.id, y.calendar, 8, @ins_scale).to_s(:delimited)
                      span.value-scale = @ins_scale

                tr.tr-rdata
                  td.td-title style=" font-weight: 800; font-size: 18px" rowspan="2"
                    span.fill-td.text-left = 'Otros gastos/ingresos'
                  - @calendar_periods_is.each_with_index do |y, y_index|
                    td.sum_input class="full-input col-#{y.id}"
                      - if y.calendar.period_type == 'anual'
                        /div class=['percentage-badge', calculate_percentage('income_statement', @company.id, y.calendar, 9, @ins_scale)[1]]
                          span#comparative_table_is class=["percent-bdg8-#{y_index}"] = "#{calculate_percentage('income_statement', @company.id, y.calendar, 9, @ins_scale)[0]} %"
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value16 = company_income_stat_value(@company.id, y.calendar, 9, @ins_scale).to_s(:delimited)
                        span.value-scale = @ins_scale

                tr.tr-rdata
                  - @calendar_periods_is.each do |y|
                    td.sum_input class="full-input col-#{y.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value17 = income_calendar_detail_value(@company.id, y.calendar, 9, @ins_scale).to_s(:delimited)
                      span.value-scale = @ins_scale

                tr.tr-rdata
                  td.td-title style=" font-weight: 800; font-size: 18px" rowspan="2"
                    span.fill-td.text-left = 'Utilidad antes de impuestos'
                  - @calendar_periods_is.each_with_index do |y, y_index|
                    td.sum_input class="full-input col-#{y.id}"
                      - if y.calendar.period_type == 'anual'
                        /div class=['percentage-badge', calculate_percentage('income_statement', @company.id, y.calendar, 10, @ins_scale)[1]]
                          span#comparative_table_is class=["percent-bdg9-#{y_index}"] = "#{calculate_percentage('income_statement', @company.id, y.calendar, 10, @ins_scale)[0]} %"
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value18 = company_income_stat_value(@company.id, y.calendar, 10, @ins_scale).to_s(:delimited)
                        span.value-scale = @ins_scale

                tr.tr-rdata
                  - @calendar_periods_is.each do |y|
                    td.sum_input class="full-input col-#{y.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value19 = income_calendar_detail_value(@company.id, y.calendar, 10, @ins_scale).to_s(:delimited)
                      span.value-scale = @ins_scale

                tr.tr-rdata
                  td.td-title style=" font-weight: 800; font-size: 18px" rowspan="2"
                    span.fill-td.text-left = 'ISR'
                  - @calendar_periods_is.each_with_index do |y, y_index|
                    td.sum_input class="full-input col-#{y.id}"
                      - if y.calendar.period_type == 'anual'
                        /div class=['percentage-badge', calculate_percentage('income_statement', @company.id, y.calendar, 11, @ins_scale)[1]]
                          span#comparative_table_is class=["percent-bdg10-#{y_index}"] = "#{calculate_percentage('income_statement', @company.id, y.calendar, 11, @ins_scale)[0]} %"
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value20 = company_income_stat_value(@company.id, y.calendar, 11, @ins_scale).to_s(:delimited)
                        span.value-scale = @ins_scale

                tr.tr-rdata
                  - @calendar_periods_is.each do |y|
                    td.sum_input class="full-input col-#{y.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value21 = income_calendar_detail_value(@company.id, y.calendar, 11, @ins_scale).to_s(:delimited)
                      span.value-scale = @ins_scale

                tr.tr-rdata
                  td.td-title style=" font-weight: 800; font-size: 18px" rowspan="2"
                    span.fill-td.text-left = 'PTU'
                  - @calendar_periods_is.each_with_index do |y, y_index|
                    td.sum_input class="full-input col-#{y.id}"
                      - if y.calendar.period_type == 'anual'
                        /div class=['percentage-badge', calculate_percentage('income_statement', @company.id, y.calendar, 12, @ins_scale)[1]]
                          span#comparative_table_is class=["percent-bdg11-#{y_index}"] = "#{calculate_percentage('income_statement', @company.id, y.calendar, 12, @ins_scale)[0]} %"
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value22 = company_income_stat_value(@company.id, y.calendar, 12, @ins_scale).to_s(:delimited)
                        span.value-scale = @ins_scale

                tr.tr-rdata
                  - @calendar_periods_is.each do |y|
                    td.sum_input class="full-input col-#{y.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value23 = income_calendar_detail_value(@company.id, y.calendar, 12, @ins_scale).to_s(:delimited)
                      span.value-scale = @ins_scale

                tr.tr-rdata
                  td.td-title style=" font-weight: 800; font-size: 18px" rowspan="2"
                    span.fill-td.text-left = 'Participación subsidiarios'
                  - @calendar_periods_is.each_with_index do |y, y_index|
                    td.sum_input class="full-input col-#{y.id}"
                      - if y.calendar.period_type == 'anual'
                        /div class=['percentage-badge', calculate_percentage('income_statement', @company.id, y.calendar, 13, @ins_scale)[1]]
                          span#comparative_table_is class=["percent-bdg12-#{y_index}"] = "#{calculate_percentage('income_statement', @company.id, y.calendar, 13, @ins_scale)[0]} %"
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value24 = company_income_stat_value(@company.id, y.calendar, 13, @ins_scale).to_s(:delimited)
                        span.value-scale = @ins_scale

                tr.tr-rdata
                  - @calendar_periods_is.each do |y|
                    td.sum_input class="full-input col-#{y.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value25 = income_calendar_detail_value(@company.id, y.calendar, 13, @ins_scale).to_s(:delimited)
                      span.value-scale = @ins_scale

                tr.tr-rdata
                  td.td-title style=" font-weight: 800; font-size: 18px" rowspan="2"
                    // 14: UTILIDAD NETA
                    span.fill-td.text-left = 'Utilidad neta'
                  - @calendar_periods_is.each_with_index do |y, y_index|
                    td.sum_input class="full-input col-#{y.id}"
                      - if y.calendar.period_type == 'anual'
                        /div class=['percentage-badge', calculate_percentage('income_statement', @company.id, y.calendar, 14, @ins_scale)[1]]
                          span#comparative_table_is class=["percent-bdg13-#{y_index}"] = "#{calculate_percentage('income_statement', @company.id, y.calendar, 14, @ins_scale)[0]} %"
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value26 = company_income_stat_value(@company.id, y.calendar, 14, @ins_scale).to_s(:delimited)
                        span.value-scale = @ins_scale

                tr.tr-rdata
                  - @calendar_periods_is.each do |y|
                    td.sum_input class="full-input col-#{y.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value27 = income_calendar_detail_value(@company.id, y.calendar, 14, @ins_scale).to_s(:delimited)
                      span.value-scale = @ins_scale

            - else
              .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                .m-alert__icon
                  = wicked_pdf_image_tag asset_url('icons/exclamation.png'), size: "30x30"
                .m-alert__text
                  strong
                    | Aún no se le han asignado fechas para captura.


            .mt-30
              .btns-card-pdf.full-h
                .d-flex.flex-column.justify-content-between
                  span.h5.subtitle = 'Comentarios'
                  .m-widget3
                    - if @is_comments.length > 0
                      - @is_comments.each do |comment|
                        .m-widget3__item
                          .m-widget3__header
                            .m-widget3__info
                              span.m-widget3__username
                                = User.where(id: comment.user_id).try(:first).full_name
                              span.m-widget3__time
                                = " - #{comment.created_at.strftime('%d/%m/%Y,  %I:%M%p')}"
                          p.comment-bubbled
                            = comment.comment
                            b.aft
                    - else
                      .m-widget3__item
                        .m-widget3__body
                          p.m-widget3__text
                            .text-center
                              | Aún no hay comentarios.
          .col-md-12.my-4
            h3 = "3.2 Balance General"
            - if @company.company_calendar_details.where(assign_to: 'balance_sheet').present?
              table.table.table-bordered.input-focusable-table#comparative_table_bs
                tr.tr-title
                  th
                  - @calendar_periods_bs.each do |y|
                    th.th-title id="col-#{y.id}_head"
                      = y.calendar.period_name
                tr
                  td.td-title.concept-header style=" font-weight: 800; font-size: 16px;" rowspan="2"
                    span.fill-td.text-left = 'Activo circulante'
                  - @calendar_periods_bs.each_with_index do |y, y_index|
                    td.concept-header class="full-input col-#{y.id}"
                      - if y.calendar.period_type == 'anual'
                        span = 'SUM. SAT'
                        br
                        span = company_balance_sheet_value(@company.id, y.calendar, ['1', '2', '3', '4'], @bs_scale).to_s(:delimited)
                        span.value-scale = @bs_scale
                tr
                  - @calendar_periods_bs.each do |y|
                    td.td-title.concept-header class="full-input col-#{y.id}"
                      span = 'SUM. CAPTURA'
                      br
                      span = bs_capture_sum(@company.id, ['1', '2', '3', '4'], y.calendar.id, @bs_scale).to_s(:delimited)
                      span.value-scale = @bs_scale
                tr.tr-rdata
                  td.td-title style="font-weight: 600" rowspan="2"
                    span.fill-td.text-left = 'Caja / Inversiones'
                  - @calendar_periods_bs.each_with_index do |y, y_index|
                    td.sum_input.sat_value class="full-input col-#{y.id}"
                      - if y.calendar.period_type == 'anual'
                        div class=['percentage-badge', calculate_percentage('balance_sheet', @company.id, y.calendar, 1, @bs_scale)[1]]
                          span#comparative_table_bs class=["percent-bdg0-#{y_index}"] = "#{calculate_percentage('balance_sheet', @company.id, y.calendar, 1, @bs_scale)[0]} %"
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value0 = company_balance_sheet_value(@company.id, y.calendar, 1, @bs_scale).to_s(:delimited)
                        span.value-scale = @bs_scale
                        span.float-percent.percent-value0 = "#{calculate_percent_of_total(company_balance_sheet_value(@company.id, y.calendar, 1, @bs_scale), company_balance_sheet_value(@company.id, y.calendar, ['1', '2', '3', '4'], @bs_scale))} %"

                tr.tr-rdata
                  - @calendar_periods_bs.each do |y|
                    td.sum_input class="full-input col-#{y.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value1 = balance_calendar_detail_value(@company.id, y.calendar, 1, @bs_scale).to_s(:delimited)
                      span.value-scale = @bs_scale
                      span.float-percent.percent-value1 = "#{calculate_percent_of_total(balance_calendar_detail_value(@company.id, y.calendar, 1, @bs_scale), bs_capture_sum(@company.id, ['1', '2', '3', '4'], y.calendar.id, @bs_scale))} %"

                tr.tr-rdata
                  td.td-title style="font-weight: 600" rowspan="2"
                    span.fill-td.text-left = 'Clientes'
                  - @calendar_periods_bs.each_with_index do |y, y_index|
                    td.sum_input class="full-input col-#{y.id}"
                      - if y.calendar.period_type == 'anual'
                        div class=['percentage-badge', calculate_percentage('balance_sheet', @company.id, y.calendar, 2, @bs_scale)[1]]
                          span#comparative_table_bs class=["percent-bdg1-#{y_index}"] = "#{calculate_percentage('balance_sheet', @company.id, y.calendar, 2, @bs_scale)[0]} %"
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value2 = company_balance_sheet_value(@company.id, y.calendar, 2, @bs_scale).to_s(:delimited)
                        span.value-scale = @bs_scale
                        span.float-percent.percent-value2 = "#{calculate_percent_of_total(company_balance_sheet_value(@company.id, y.calendar, 2, @bs_scale), company_balance_sheet_value(@company.id, y.calendar, ['1', '2', '3', '4'], @bs_scale))} %"

                tr.tr-rdata
                  - @calendar_periods_bs.each do |y|
                    td.sum_input class="full-input col-#{y.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value3 = balance_calendar_detail_value(@company.id, y.calendar, 2, @bs_scale).to_s(:delimited)
                      span.value-scale = @bs_scale
                      span.float-percent.percent-value3 = "#{calculate_percent_of_total(balance_calendar_detail_value(@company.id, y.calendar, 2, @bs_scale), bs_capture_sum(@company.id, ['1', '2', '3', '4'], y.calendar.id, @bs_scale))} %"

                tr.tr-rdata
                  td.td-title style="font-weight: 600" rowspan="2"
                    span.fill-td.text-left = 'Inventarios'
                  - @calendar_periods_bs.each_with_index do |y, y_index|
                    td.sum_input class="full-input col-#{y.id}"
                      - if y.calendar.period_type == 'anual'
                        div class=['percentage-badge', calculate_percentage('balance_sheet', @company.id, y.calendar, 3, @bs_scale)[1]]
                          span#comparative_table_bs class=["percent-bdg2-#{y_index}"] = "#{calculate_percentage('balance_sheet', @company.id, y.calendar, 3, @bs_scale)[0]} %"
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value4 = company_balance_sheet_value(@company.id, y.calendar, 3, @bs_scale).to_s(:delimited)
                        span.value-scale = @bs_scale
                        span.float-percent.percent-value4 = "#{calculate_percent_of_total(company_balance_sheet_value(@company.id, y.calendar, 3, @bs_scale), company_balance_sheet_value(@company.id, y.calendar, ['1', '2', '3', '4'], @bs_scale))} %"

                tr.tr-rdata
                  - @calendar_periods_bs.each do |y|
                    td.sum_input class="full-input col-#{y.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value5 = balance_calendar_detail_value(@company.id, y.calendar, 3, @bs_scale).to_s(:delimited)
                      span.value-scale = @bs_scale
                      span.float-percent.percent-value6 = "#{calculate_percent_of_total(balance_calendar_detail_value(@company.id, y.calendar, 3, @bs_scale), bs_capture_sum(@company.id, ['1', '2', '3', '4'], y.calendar.id, @bs_scale))} %"

                tr.tr-rdata
                  td.td-title style="font-weight: 600;" rowspan="2"
                    span.fill-td.text-left = 'Otros activos circulantes'
                  - @calendar_periods_bs.each_with_index do |y, y_index|
                    td.sum_input class="full-input col-#{y.id}"
                      - if y.calendar.period_type == 'anual'
                        div class=['percentage-badge', calculate_percentage('balance_sheet', @company.id, y.calendar, 4, @bs_scale)[1]]
                          span#comparative_table_bs class=["percent-bdg3-#{y_index}"] = "#{calculate_percentage('balance_sheet', @company.id, y.calendar, 4, @bs_scale)[0]} %"
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value6 = company_balance_sheet_value(@company.id, y.calendar, 4, @bs_scale).to_s(:delimited)
                        span.value-scale = @bs_scale
                        span.float-percent.percent-value6 = "#{calculate_percent_of_total(company_balance_sheet_value(@company.id, y.calendar, 4, @bs_scale), company_balance_sheet_value(@company.id, y.calendar, ['1', '2', '3', '4'], @bs_scale))} %"

                tr.tr-rdata
                  - @calendar_periods_bs.each do |y|
                    td.sum_input class="full-input col-#{y.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value7 = balance_calendar_detail_value(@company.id, y.calendar, 4, @bs_scale).to_s(:delimited)
                      span.value-scale = @bs_scale
                      span.float-percent.percent-value7 = "#{calculate_percent_of_total(balance_calendar_detail_value(@company.id, y.calendar, 4, @bs_scale), bs_capture_sum(@company.id, ['1', '2', '3', '4'], y.calendar.id, @bs_scale))} %"

                tr
                  td.td-title.concept-header style=" font-weight: 800; font-size: 18px" rowspan="2"
                    span.fill-td.text-left = 'Activo fijo'
                  - @calendar_periods_bs.each do |y|
                    td.concept-header class="full-input col-#{y.id}"
                      - if y.calendar.period_type == 'anual'
                        span = 'SUM. SAT'
                        br
                        span = bs_activo_fijo_sat(@company.id, ['5', '6', '8', '9'], y.calendar, @bs_scale).to_s(:delimited)
                        span.value-scale = @bs_scale
                tr
                  - @calendar_periods_bs.each do |y|
                    td.concept-header class="full-input col-#{y.id}"
                      span = 'SUM. CAPTURA'
                      br
                      span = bs_activo_fijo(@company.id, ['5', '6', '8', '9'], y.calendar.id, @bs_scale).to_s(:delimited)
                      span.value-scale = @bs_scale
                tr.tr-rdata
                  td.td-title style="font-weight: 600" rowspan="2"
                    span.fill-td.text-left = 'Terrenos y Construcciones'
                  - @calendar_periods_bs.each_with_index do |y, y_index|
                    td.sum_input class="full-input col-#{y.id}"
                      - if y.calendar.period_type == 'anual'
                        div class=['percentage-badge', calculate_percentage('balance_sheet', @company.id, y.calendar, 5, @bs_scale)[1]]
                          span#comparative_table_bs class=["percent-bdg4-#{y_index}"] = "#{calculate_percentage('balance_sheet', @company.id, y.calendar, 5, @bs_scale)[0]} %"
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value8 = company_balance_sheet_value(@company.id, y.calendar, 5, @bs_scale).to_s(:delimited)
                        span.value-scale = @bs_scale
                        span.float-percent.percent-value8 = "#{calculate_percent_of_total(company_balance_sheet_value(@company.id, y.calendar, 5, @bs_scale), company_balance_sheet_value(@company.id, y.calendar, ['5', '6', '7', '8', '9'], @bs_scale))} %"

                tr.tr-rdata
                  - @calendar_periods_bs.each do |y|
                    td.sum_input class="full-input col-#{y.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value9 = balance_calendar_detail_value(@company.id, y.calendar, 5, @bs_scale).to_s(:delimited)
                      span.value-scale = @bs_scale
                      span.float-percent.percent-value9 = "#{calculate_percent_of_total(balance_calendar_detail_value(@company.id, y.calendar, 5, @bs_scale), bs_capture_sum(@company.id, ['5', '6', '7', '8', '9'], y.calendar.id, @bs_scale))} %"

                tr.tr-rdata
                  td.td-title style="font-weight: 600" rowspan="2"
                    span.fill-td.text-left = 'Maquinaria y equipo'
                  - @calendar_periods_bs.each_with_index do |y, y_index|
                    td.sum_input class="full-input col-#{y.id}"
                      - if y.calendar.period_type == 'anual'
                        div class=['percentage-badge', calculate_percentage('balance_sheet', @company.id, y.calendar, 6, @bs_scale)[1]]
                          span#comparative_table_bs class=["percent-bdg5-#{y_index}"] = "#{calculate_percentage('balance_sheet', @company.id, y.calendar, 6, @bs_scale)[0]} %"
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value10 = company_balance_sheet_value(@company.id, y.calendar, 6, @bs_scale).to_s(:delimited)
                        span.value-scale = @bs_scale
                        span.float-percent.percent-value10 = "#{calculate_percent_of_total(company_balance_sheet_value(@company.id, y.calendar, 6, @bs_scale), company_balance_sheet_value(@company.id, y.calendar, ['5', '6', '7', '8', '9'], @bs_scale))} %"

                tr.tr-rdata
                  - @calendar_periods_bs.each do |y|
                    td.sum_input class="full-input col-#{y.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value11 = balance_calendar_detail_value(@company.id, y.calendar, 6, @bs_scale).to_s(:delimited)
                      span.value-scale = @bs_scale
                      span.float-percent.percent-value11 = "#{calculate_percent_of_total(balance_calendar_detail_value(@company.id, y.calendar, 6, @bs_scale), bs_capture_sum(@company.id, ['5', '6', '7', '8', '9'], y.calendar.id, @bs_scale))} %"

                tr.tr-rdata
                  td.td-title style="font-weight: 600" rowspan="2"
                    span.fill-td.text-left = 'Depreciación acumulada'
                  - @calendar_periods_bs.each_with_index do |y, y_index|
                    td.sum_input class="full-input col-#{y.id}"
                      - if y.calendar.period_type == 'anual'
                        div class=['percentage-badge', calculate_percentage('balance_sheet', @company.id, y.calendar, 7, @bs_scale)[1]]
                          span#comparative_table_bs class=["percent-bdg6-#{y_index}"] = "#{calculate_percentage('balance_sheet', @company.id, y.calendar, 7, @bs_scale)[0]} %"
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value12 = company_balance_sheet_value(@company.id, y.calendar, 7, @bs_scale).to_s(:delimited)
                        span.value-scale = @bs_scale
                        span.float-percent.percent-value12 = "#{calculate_percent_of_total(company_balance_sheet_value(@company.id, y.calendar, 7, @bs_scale), company_balance_sheet_value(@company.id, y.calendar, ['5', '6', '7', '8', '9'], @bs_scale))} %"

                tr.tr-rdata
                  - @calendar_periods_bs.each do |y|
                    td.sum_input class="full-input col-#{y.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value13 = balance_calendar_detail_value(@company.id, y.calendar, 7, @bs_scale).to_s(:delimited)
                      span.value-scale = @bs_scale
                      span.float-percent.percent-value13 = "#{calculate_percent_of_total(balance_calendar_detail_value(@company.id, y.calendar, 7, @bs_scale), bs_capture_sum(@company.id, ['5', '6', '7', '8', '9'], y.calendar.id, @bs_scale))} %"

                tr.tr-rdata
                  td.td-title style="font-weight: 600" rowspan="2"
                    span.fill-td.text-left = 'Otros activos fijos'
                  - @calendar_periods_bs.each_with_index do |y, y_index|
                    td.sum_input class="full-input col-#{y.id}"
                      - if y.calendar.period_type == 'anual'
                        div class=['percentage-badge', calculate_percentage('balance_sheet', @company.id, y.calendar, 8, @bs_scale)[1]]
                          span#comparative_table_bs class=["percent-bdg7-#{y_index}"] = "#{calculate_percentage('balance_sheet', @company.id, y.calendar, 8, @bs_scale)[0]} %"
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value14 = company_balance_sheet_value(@company.id, y.calendar, 8, @bs_scale).to_s(:delimited)
                        span.value-scale = @bs_scale
                        span.float-percent.percent-value14 = "#{calculate_percent_of_total(company_balance_sheet_value(@company.id, y.calendar, 8, @bs_scale), company_balance_sheet_value(@company.id, y.calendar, ['5', '6', '7', '8', '9'], @bs_scale))} %"

                tr.tr-rdata
                  - @calendar_periods_bs.each do |y|
                    td.sum_input class="full-input col-#{y.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value15 = balance_calendar_detail_value(@company.id, y.calendar, 8, @bs_scale).to_s(:delimited)
                      span.value-scale = @bs_scale
                      span.float-percent.percent-value15 = "#{calculate_percent_of_total(balance_calendar_detail_value(@company.id, y.calendar, 8, @bs_scale), bs_capture_sum(@company.id, ['5', '6', '7', '8', '9'], y.calendar.id, @bs_scale))} %"

                tr.tr-rdata
                  td.td-title style="font-weight: 600" rowspan="2"
                    span.fill-td.text-left = 'Cargos y gastos diferidos'
                  - @calendar_periods_bs.each_with_index do |y, y_index|
                    td.sum_input class="full-input col-#{y.id}"
                      - if y.calendar.period_type == 'anual'
                        div class=['percentage-badge', calculate_percentage('balance_sheet', @company.id, y.calendar, 9, @bs_scale)[1]]
                          span#comparative_table_bs class=["percent-bdg8-#{y_index}"] = "#{calculate_percentage('balance_sheet', @company.id, y.calendar, 9, @bs_scale)[0]} %"
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value16 = company_balance_sheet_value(@company.id, y.calendar, 9, @bs_scale).to_s(:delimited)
                        span.value-scale = @bs_scale
                        span.float-percent.percent-value16 = "#{calculate_percent_of_total(company_balance_sheet_value(@company.id, y.calendar, 9, @bs_scale), company_balance_sheet_value(@company.id, y.calendar, ['5', '6', '7', '8', '9'], @bs_scale))} %"

                tr.tr-rdata
                  - @calendar_periods_bs.each do |y|
                    td.sum_input class="full-input col-#{y.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value17 = balance_calendar_detail_value(@company.id, y.calendar, 9, @bs_scale).to_s(:delimited)
                      span.value-scale = @bs_scale
                      span.float-percent.percent-value17 = "#{calculate_percent_of_total(balance_calendar_detail_value(@company.id, y.calendar, 9, @bs_scale), bs_capture_sum(@company.id, ['5', '6', '7', '8', '9'], y.calendar.id, @bs_scale))} %"

                tr
                  td.td-title.concept-header style=" font-weight: 800; font-size: 18px" rowspan="2"
                    span.fill-td.text-left = 'Pasivo total'
                  - @calendar_periods_bs.each do |y|
                    td.concept-header class="full-input col-#{y.id}"
                      - if y.calendar.period_type == 'anual'
                        span = 'SUM. SAT'
                        br
                        span = company_balance_sheet_value(@company.id, y.calendar, ['10', '11', '12', '13'], @bs_scale).to_s(:delimited)
                        span.value-scale = @bs_scale
                tr
                  - @calendar_periods_bs.each do |y|
                    td.concept-header class="full-input col-#{y.id}"
                      span = 'SUM. CAPTURA'
                      br
                      span = bs_capture_sum(@company.id, ['10', '11', '12', '13'], y.calendar.id, @bs_scale).to_s(:delimited)
                      span.value-scale = @bs_scale
                tr.tr-rdata
                  td.td-title style="font-weight: 600" rowspan="2"
                    span.fill-td.text-left = 'Proveedores'
                  - @calendar_periods_bs.each_with_index do |y, y_index|
                    td.sum_input class="full-input col-#{y.id}"
                      - if y.calendar.period_type == 'anual'
                        div class=['percentage-badge', calculate_percentage('balance_sheet', @company.id, y.calendar, 10, @bs_scale)[1]]
                          span#comparative_table_bs class=["percent-bdg9-#{y_index}"] = "#{calculate_percentage('balance_sheet', @company.id, y.calendar, 10, @bs_scale)[0]} %"
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value18 = company_balance_sheet_value(@company.id, y.calendar, 10, @bs_scale).to_s(:delimited)
                        span.value-scale = @bs_scale
                        span.float-percent.percent-value18 = "#{calculate_percent_of_total(company_balance_sheet_value(@company.id, y.calendar, 10, @bs_scale), company_balance_sheet_value(@company.id, y.calendar, ['10', '11', '12', '13'], @bs_scale))} %"

                tr.tr-rdata
                  - @calendar_periods_bs.each do |y|
                    td.sum_input class="full-input col-#{y.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value19 = balance_calendar_detail_value(@company.id, y.calendar, 10, @bs_scale).to_s(:delimited)
                      span.value-scale = @bs_scale
                      span.float-percent.percent-value19 = "#{calculate_percent_of_total(balance_calendar_detail_value(@company.id, y.calendar, 10, @bs_scale), bs_capture_sum(@company.id, ['10', '11', '12', '13'], y.calendar.id, @bs_scale))} %"

                tr.tr-rdata
                  td.td-title style="font-weight: 600" rowspan="2"
                    span.fill-td.text-left = 'Contribuciones por pagar'
                  - @calendar_periods_bs.each_with_index do |y, y_index|
                    td.sum_input class="full-input col-#{y.id}"
                      - if y.calendar.period_type == 'anual'
                        div class=['percentage-badge', calculate_percentage('balance_sheet', @company.id, y.calendar, 11, @bs_scale)[1]]
                          span#comparative_table_bs class=["percent-bdg10-#{y_index}"] = "#{calculate_percentage('balance_sheet', @company.id, y.calendar, 11, @bs_scale)[0]} %"
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value20 = company_balance_sheet_value(@company.id, y.calendar, 11, @bs_scale).to_s(:delimited)
                        span.value-scale = @bs_scale
                        span.float-percent.percent-value20 = "#{calculate_percent_of_total(company_balance_sheet_value(@company.id, y.calendar, 11, @bs_scale), company_balance_sheet_value(@company.id, y.calendar, ['10', '11', '12', '13'], @bs_scale))} %"

                tr.tr-rdata
                  - @calendar_periods_bs.each do |y|
                    td.sum_input class="full-input col-#{y.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value21 = balance_calendar_detail_value(@company.id, y.calendar, 11, @bs_scale).to_s(:delimited)
                      span.value-scale = @bs_scale
                      span.float-percent.percent-value21 = "#{calculate_percent_of_total(balance_calendar_detail_value(@company.id, y.calendar, 11, @bs_scale), bs_capture_sum(@company.id, ['10', '11', '12', '13'], y.calendar.id, @bs_scale))} %"

                tr.tr-rdata
                  td.td-title style="font-weight: 600" rowspan="2"
                    span.fill-td.text-left = 'Anticipo de clientes'
                  - @calendar_periods_bs.each_with_index do |y, y_index|
                    td.sum_input class="full-input col-#{y.id}"
                      - if y.calendar.period_type == 'anual'
                        div class=['percentage-badge', calculate_percentage('balance_sheet', @company.id, y.calendar, 12, @bs_scale)[1]]
                          span#comparative_table_bs class=["percent-bdg11-#{y_index}"] = "#{calculate_percentage('balance_sheet', @company.id, y.calendar, 12, @bs_scale)[0]} %"
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value22 = company_balance_sheet_value(@company.id, y.calendar, 12, @bs_scale).to_s(:delimited)
                        span.value-scale = @bs_scale
                        span.float-percent.percent-value22 = "#{calculate_percent_of_total(company_balance_sheet_value(@company.id, y.calendar, 12, @bs_scale), company_balance_sheet_value(@company.id, y.calendar, ['10', '11', '12', '13'], @bs_scale))} %"

                tr.tr-rdata
                  - @calendar_periods_bs.each do |y|
                    td.sum_input class="full-input col-#{y.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value23 = balance_calendar_detail_value(@company.id, y.calendar, 12, @bs_scale).to_s(:delimited)
                      span.value-scale = @bs_scale
                      span.float-percent.percent-value23 = "#{calculate_percent_of_total(balance_calendar_detail_value(@company.id, y.calendar, 12, @bs_scale), bs_capture_sum(@company.id, ['10', '11', '12', '13'], y.calendar.id, @bs_scale))} %"

                tr.tr-rdata
                  td.td-title style="font-weight: 600" rowspan="2"
                    span.fill-td.text-left = 'Otros pasivos'
                  - @calendar_periods_bs.each_with_index do |y, y_index|
                    td.sum_input class="full-input col-#{y.id}"
                      - if y.calendar.period_type == 'anual'
                        div class=['percentage-badge', calculate_percentage('balance_sheet', @company.id, y.calendar, 13, @bs_scale)[1]]
                          span#comparative_table_bs class=["percent-bdg12-#{y_index}"] = "#{calculate_percentage('balance_sheet', @company.id, y.calendar, 13, @bs_scale)[0]} %"
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value24 = company_balance_sheet_value(@company.id, y.calendar, 13, @bs_scale).to_s(:delimited)
                        span.value-scale = @bs_scale
                        span.float-percent.percent-value24 = "#{calculate_percent_of_total(company_balance_sheet_value(@company.id, y.calendar, 13, @bs_scale), company_balance_sheet_value(@company.id, y.calendar, ['10', '11', '12', '13'], @bs_scale))} %"

                tr.tr-rdata
                  - @calendar_periods_bs.each do |y|
                    td.sum_input class="full-input col-#{y.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value25 = balance_calendar_detail_value(@company.id, y.calendar, 13, @bs_scale).to_s(:delimited)
                      span.value-scale = @bs_scale
                      span.float-percent.percent-value25 = "#{calculate_percent_of_total(balance_calendar_detail_value(@company.id, y.calendar, 13, @bs_scale), bs_capture_sum(@company.id, ['10', '11', '12', '13'], y.calendar.id, @bs_scale))} %"

                tr
                  td.td-title.concept-header style=" font-weight: 800; font-size: 18px" rowspan="2"
                    span.fill-td.text-left = 'Capital Total'
                  - @calendar_periods_bs.each do |y|
                    td.concept-header class="full-input col-#{y.id}"
                      - if y.calendar.period_type == 'anual'
                        span = 'SUM. SAT'
                        br
                        span = company_balance_sheet_value(@company.id, y.calendar, ['14', '15', '16', '17'], @bs_scale).to_s(:delimited)
                        span.value-scale = @bs_scale
                tr
                  - @calendar_periods_bs.each do |y|
                    td.td-title.concept-header class="full-input col-#{y.id}"
                      span = 'SUM. CAPTURA'
                      br
                      span = bs_capture_sum(@company.id, ['14', '15', '16', '17'], y.calendar.id, @bs_scale).to_s(:delimited)
                      span.value-scale = @bs_scale
                tr.tr-rdata
                  td.td-title style="font-weight: 600" rowspan="2"
                    span.fill-td.text-left = 'Capital social'
                  - @calendar_periods_bs.each_with_index do |y, y_index|
                    td.sum_input class="full-input col-#{y.id}"
                      - if y.calendar.period_type == 'anual'
                        div class=['percentage-badge', calculate_percentage('balance_sheet', @company.id, y.calendar, 14, @bs_scale)[1]]
                          span#comparative_table_bs class=["percent-bdg13-#{y_index}"] = "#{calculate_percentage('balance_sheet', @company.id, y.calendar, 14, @bs_scale)[0]} %"
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value26 = company_balance_sheet_value(@company.id, y.calendar, 14, @bs_scale).to_s(:delimited)
                        span.value-scale = @bs_scale
                        span.float-percent.percent-value26 = "#{calculate_percent_of_total(company_balance_sheet_value(@company.id, y.calendar, 8, @bs_scale), company_balance_sheet_value(@company.id, y.calendar, ['14', '15', '16', '17'], @bs_scale))} %"

                tr.tr-rdata
                  - @calendar_periods_bs.each do |y|
                    td.sum_input class="full-input col-#{y.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value27 = balance_calendar_detail_value(@company.id, y.calendar, 14, @bs_scale).to_s(:delimited)
                      span.value-scale = @bs_scale
                      span.float-percent.percent-value27 = "#{calculate_percent_of_total(balance_calendar_detail_value(@company.id, y.calendar, 14, @bs_scale), bs_capture_sum(@company.id, ['14', '15', '16', '17'], y.calendar.id, @bs_scale))} %"

                tr.tr-rdata
                  td.td-title style="font-weight: 600" rowspan="2"
                    span.fill-td.text-left = 'Utilidad/Pérdida acumulada'
                  - @calendar_periods_bs.each_with_index do |y, y_index|
                    td.sum_input class="full-input col-#{y.id}"
                      - if y.calendar.period_type == 'anual'
                        div class=['percentage-badge', calculate_percentage('balance_sheet', @company.id, y.calendar, 15, @bs_scale)[1]]
                          span#comparative_table_bs class=["percent-bdg14-#{y_index}"] = "#{calculate_percentage('balance_sheet', @company.id, y.calendar, 15, @bs_scale)[0]} %"
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value28 = company_balance_sheet_value(@company.id, y.calendar, 15, @bs_scale).to_s(:delimited)
                        span.value-scale = @bs_scale
                        span.float-percent.percent-value28 = "#{calculate_percent_of_total(company_balance_sheet_value(@company.id, y.calendar, 15, @bs_scale), company_balance_sheet_value(@company.id, y.calendar, ['14', '15', '16', '17'], @bs_scale))} %"

                tr.tr-rdata
                  - @calendar_periods_bs.each do |y|
                    td.sum_input class="full-input col-#{y.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value29 = balance_calendar_detail_value(@company.id, y.calendar, 15, @bs_scale).to_s(:delimited)
                      span.value-scale = @bs_scale
                      span.float-percent.percent-value29 = "#{calculate_percent_of_total(balance_calendar_detail_value(@company.id, y.calendar, 15, @bs_scale), bs_capture_sum(@company.id, ['14', '15', '16', '17'], y.calendar.id, @bs_scale))} %"

                tr.tr-rdata
                  td.td-title style="font-weight: 600" rowspan="2"
                    span.fill-td.text-left = 'Utilidad/Pérdida ejercicio'
                  - @calendar_periods_bs.each_with_index do |y, y_index|
                    td.sum_input class="full-input col-#{y.id}"
                      - if y.calendar.period_type == 'anual'
                        div class=['percentage-badge', calculate_percentage('balance_sheet', @company.id, y.calendar, 16, @bs_scale)[1]]
                          span#comparative_table_bs class=["percent-bdg15-#{y_index}"] = "#{calculate_percentage('balance_sheet', @company.id, y.calendar, 16, @bs_scale)[0]} %"
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value30 = company_balance_sheet_value(@company.id, y.calendar, 16, @bs_scale).to_s(:delimited)
                        span.value-scale = @bs_scale
                        span.float-percent.percent-value30 = "#{calculate_percent_of_total(company_balance_sheet_value(@company.id, y.calendar, 16, @bs_scale), company_balance_sheet_value(@company.id, y.calendar, ['14', '15', '16', '17'], @bs_scale))} %"

                tr.tr-rdata
                  - @calendar_periods_bs.each do |y|
                    td.sum_input class="full-input col-#{y.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value31 = balance_calendar_detail_value(@company.id, y.calendar, 16, @bs_scale).to_s(:delimited)
                      span.value-scale = @bs_scale
                      span.float-percent.percent-value31 = "#{calculate_percent_of_total(balance_calendar_detail_value(@company.id, y.calendar, 16, @bs_scale), bs_capture_sum(@company.id, ['14', '15', '16', '17'], y.calendar.id, @bs_scale))} %"

                tr.tr-rdata
                  td.td-title style="font-weight: 600" rowspan="2"
                    span.fill-td.text-left = 'Otras cuentas de capital'
                  - @calendar_periods_bs.each_with_index do |y, y_index|
                    td.sum_input class="full-input col-#{y.id}"
                      - if y.calendar.period_type == 'anual'
                        div class=['percentage-badge', calculate_percentage('balance_sheet', @company.id, y.calendar, 17, @bs_scale)[1]]
                          span#comparative_table_bs class=["percent-bdg16-#{y_index}"] = "#{calculate_percentage('balance_sheet', @company.id, y.calendar, 17, @bs_scale)[0]} %"
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value32 = company_balance_sheet_value(@company.id, y.calendar, 17, @bs_scale).to_s(:delimited)
                        span.value-scale = @bs_scale
                        span.float-percent.percent-value32 = "#{calculate_percent_of_total(company_balance_sheet_value(@company.id, y.calendar, 17, @bs_scale), company_balance_sheet_value(@company.id, y.calendar, ['14', '15', '16', '17'], @bs_scale))} %"

                tr.tr-rdata
                  - @calendar_periods_bs.each do |y|
                    td.sum_input class="full-input col-#{y.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value33 = balance_calendar_detail_value(@company.id, y.calendar, 17, @bs_scale).to_s(:delimited)
                      span.value-scale = @bs_scale
                      span.float-percent.percent-value33 = "#{calculate_percent_of_total(balance_calendar_detail_value(@company.id, y.calendar, 17, @bs_scale), bs_capture_sum(@company.id, ['14', '15', '16', '17'], y.calendar.id, @bs_scale))} %"

            - else
              .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                .m-alert__icon
                  = wicked_pdf_image_tag asset_url('icons/exclamation.png'), size: "30x30"
                .m-alert__text
                  strong
                    | Aún no se le han asignado fechas para captura.



            .mt-30
              .btns-card-pdf.full-h
                .d-flex.flex-column.justify-content-between
                  span.h5.subtitle = 'Comentarios'
                  .m-widget3
                    - if @bs_comments.length > 0
                      - @bs_comments.each do |comment|
                        .m-widget3__item
                          .m-widget3__header
                            .m-widget3__info
                              span.m-widget3__username
                                = User.where(id: comment.user_id).try(:first).full_name
                              span.m-widget3__time
                                = " - #{comment.created_at.strftime('%d/%m/%Y,  %I:%M%p')}"
                          p.comment-bubbled
                            = comment.comment
                            b.aft
                    - else
                      .m-widget3__item
                        .m-widget3__body
                          p.m-widget3__text
                            .text-center
                              | Aún no hay comentarios.
          .col-md-12.my-4
            h3 = "3.3 Flujo de Efectivo"
            - if BalanceCalendarDetail.where(company_id:  @company.id).present? and IncomeCalendarDetail.where(company_id:  @company.id).present?
              - if CompanyFlow.where(company_id: @company.id, flow_concept_id: FlowConcept.find_by(key: 'flujo_neto').try(:id)).present?
                table.table.table-bordered.input-focusable-table
                  tr.tr-title
                    th
                      span style="padding-bottom: 5px;"
                        = "Escala en:"
                      br
                      span.th-scale
                        = 'MILES'
                    - @calendar_fr.each do |y|
                      th.th-title
                        = y.calendar.period_name

                  tr.tr-rdata
                    td.td-title style=" font-weight: 800; font-size: 18px" rowspan="2"
                      span.text-left = 'FLUJO BRUTO'
                    - @calendar_fr.each_with_index do |calendar, calendar_index|
                      td.sum_input.sat_value class="full-input col-#{calendar.id}"
                        - if calendar.calendar.period_type == 'anual'
                          span.text-table-concept = 'SAT'
                          br
                          span.td-value0
                            = CompanyFlow.where(calendar_id: calendar.calendar.id, capture_type: 1, company_id: @company.id, flow_concept_id: FlowConcept.find_by(key: 'flujo_bruto').try(:id)).first.try(:value)

                  tr.tr-rdata
                    - @calendar_fr.each_with_index do |calendar, calendar_index|
                      td.sum_input class="full-input col-#{calendar.id}"
                        span.text-table-concept = 'CAPTURA'
                        br
                        span.td-value1
                          = CompanyFlow.where(calendar_id: calendar.calendar.id, capture_type: 2, company_id: @company.id, company_id: @company.id, flow_concept_id: FlowConcept.find_by(key: 'flujo_bruto').try(:id)).first.try(:value)
                  tr.tr-rdata
                    td.td-title style=" font-weight: 800; font-size: 18px" rowspan="2"
                      span.text-left = 'VARIACIÓN CLIENTES'
                    - @calendar_fr.each_with_index do |calendar, calendar_index|
                      td.sum_input.sat_value class="full-input col-#{calendar.id}"
                        - if calendar.calendar.period_type == 'anual'
                          span.text-table-concept = 'SAT'
                          br
                          span.td-value0
                            = CompanyFlow.where(calendar_id: calendar.calendar.id, capture_type: 1, company_id: @company.id, flow_concept_id: FlowConcept.find_by(key: 'variacion_clientes').try(:id)).first.try(:value)
                  tr.tr-rdata
                    - @calendar_fr.each_with_index do |calendar, calendar_index|
                      td.sum_input class="full-input col-#{calendar.id}"
                        span.text-table-concept = 'CAPTURA'
                        br
                        span.td-value1
                          = CompanyFlow.where(calendar_id: calendar.calendar.id, capture_type: 2, company_id: @company.id, flow_concept_id: FlowConcept.find_by(key: 'variacion_clientes').try(:id)).first.try(:value)


                  tr.tr-rdata
                    td.td-title style=" font-weight: 800; font-size: 18px; position: relative;" rowspan="2"
                      span.text-left = 'VARIACIÓN INVENTARIOS'
                    - @calendar_fr.each_with_index do |calendar, calendar_index|
                      td.sum_input.sat_value class="full-input col-#{calendar.id}"
                        - if calendar.calendar.period_type == 'anual'
                          span.text-table-concept = 'SAT'
                          br
                          span.td-value0
                            = CompanyFlow.where(calendar_id: calendar.calendar.id, capture_type: 1, company_id: @company.id, flow_concept_id: FlowConcept.find_by(key: 'variacion_inventarios').try(:id)).first.try(:value)
                  tr.tr-rdata
                    - @calendar_fr.each_with_index do |calendar, calendar_index|
                      td.sum_input class="full-input col-#{calendar.id}"
                        span.text-table-concept = 'CAPTURA'
                        br
                        span.td-value1
                          = CompanyFlow.where(calendar_id: calendar.calendar.id, capture_type: 2, company_id: @company.id, flow_concept_id: FlowConcept.find_by(key: 'variacion_inventarios').try(:id)).first.try(:value)

                  tr.tr-rdata
                    td.td-title style=" font-weight: 800; font-size: 18px" rowspan="2"
                      span.text-left = 'VARIACIÓN PROVEEDORES'
                    - @calendar_fr.each_with_index do |calendar, calendar_index|
                      td.sum_input.sat_value class="full-input col-#{calendar.id}"
                        - if calendar.calendar.period_type == 'anual'
                          span.text-table-concept = 'SAT'
                          br
                          span.td-value0
                            = CompanyFlow.where(calendar_id: calendar.calendar.id, capture_type: 1, company_id: @company.id, flow_concept_id: FlowConcept.find_by(key: 'variacion_proveedores').try(:id)).first.try(:value)
                  tr.tr-rdata
                    - @calendar_fr.each_with_index do |calendar, calendar_index|
                      td.sum_input class="full-input col-#{calendar.id}"
                        span.text-table-concept = 'CAPTURA'
                        br
                        span.td-value0
                          = CompanyFlow.where(calendar_id: calendar.calendar.id, capture_type: 2, company_id: @company.id, flow_concept_id: FlowConcept.find_by(key: 'variacion_proveedores').try(:id)).first.try(:value)
                  tr.tr-rdata
                    td.td-title style=" font-weight: 800; font-size: 18px" rowspan="2"
                      span.text-left = 'VARIACIÓN ANTICIPO CLIENTES'
                    - @calendar_fr.each_with_index do |calendar, calendar_index|
                      td.sum_input.sat_value class="full-input col-#{calendar.id}"
                        - if calendar.calendar.period_type == 'anual'
                          span.text-table-concept = 'SAT'
                          br
                          span.td-value0
                            = CompanyFlow.where(calendar_id: calendar.calendar.id, capture_type: 1, company_id: @company.id, flow_concept_id: FlowConcept.find_by(key: 'variacion_anticipo_clientes').try(:id)).first.try(:value)
                  tr.tr-rdata
                    - @calendar_fr.each_with_index do |calendar, calendar_index|
                      td.sum_input class="full-input col-#{calendar.id}"
                        span.text-table-concept = 'CAPTURA'
                        br
                        span.td-value0
                          = CompanyFlow.where(calendar_id: calendar.calendar.id, capture_type: 2, company_id: @company.id, flow_concept_id: FlowConcept.find_by(key: 'variacion_anticipo_clientes').try(:id)).first.try(:value)
                  tr.tr-rdata
                    td.td-title style=" font-weight: 800; font-size: 18px" rowspan="2"
                      span.text-left = 'FLUJO DE OPERACIÓN'
                    - @calendar_fr.each_with_index do |calendar, calendar_index|
                      td.sum_input.sat_value class="full-input col-#{calendar.id}"
                        - if calendar.calendar.period_type == 'anual'
                          span.text-table-concept = 'SAT'
                          br
                          span.td-value0
                            = CompanyFlow.where(calendar_id: calendar.calendar.id, capture_type: 1, company_id: @company.id, flow_concept_id: FlowConcept.find_by(key: 'flujo_operacion').try(:id)).first.try(:value)
                  tr.tr-rdata
                    - @calendar_fr.each_with_index do |calendar, calendar_index|
                      td.sum_input class="full-input col-#{calendar.id}"
                        span.text-table-concept = 'CAPTURA'
                        br
                        span.td-value0
                          = CompanyFlow.where(calendar_id: calendar.calendar.id, capture_type: 2, company_id: @company.id, flow_concept_id: FlowConcept.find_by(key: 'flujo_operacion').try(:id)).first.try(:value)
                  tr.tr-rdata
                    td.td-title style=" font-weight: 800; font-size: 18px" rowspan="2"
                      span.text-left = 'IMPUESTOS PAGADOS Y PTU'
                    - @calendar_fr.each_with_index do |calendar, calendar_index|
                      td.sum_input.sat_value class="full-input col-#{calendar.id}"
                        - if calendar.calendar.period_type == 'anual'
                          span.text-table-concept = 'SAT'
                          br
                          span.td-value0
                            = CompanyFlow.where(calendar_id: calendar.calendar.id, capture_type: 1, company_id: @company.id, flow_concept_id: FlowConcept.find_by(key: 'impuestos_pagados_ptu').try(:id)).first.try(:value)
                  tr.tr-rdata
                    - @calendar_fr.each_with_index do |calendar, calendar_index|
                      td.sum_input class="full-input col-#{calendar.id}"
                        span.text-table-concept = 'CAPTURA'
                        br
                        span.td-value0
                          = CompanyFlow.where(calendar_id: calendar.calendar.id, capture_type: 2, company_id: @company.id, flow_concept_id: FlowConcept.find_by(key: 'impuestos_pagados_ptu').try(:id)).first.try(:value)

                  tr.tr-rdata
                    td.td-title style=" font-weight: 800; font-size: 18px" rowspan="2"
                      span.text-left = 'GASTOS FINANCIEROS'
                    - @calendar_fr.each_with_index do |calendar, calendar_index|
                      td.sum_input.sat_value class="full-input col-#{calendar.id}"
                        - if calendar.calendar.period_type == 'anual'
                          span.text-table-concept = 'SAT'
                          br
                          span.td-value0
                            = CompanyFlow.where(calendar_id: calendar.calendar.id, capture_type: 1, company_id: @company.id, flow_concept_id: FlowConcept.find_by(key: 'gastos_financieros').try(:id)).first.try(:value)
                  tr.tr-rdata
                    - @calendar_fr.each_with_index do |calendar, calendar_index|
                      td.sum_input class="full-input col-#{calendar.id}"
                        span.text-table-concept = 'CAPTURA'
                        br
                        span.td-value0
                          = CompanyFlow.where(calendar_id: calendar.calendar.id, capture_type: 2, company_id: @company.id, flow_concept_id: FlowConcept.find_by(key: 'gastos_financieros').try(:id)).first.try(:value)
                  tr.tr-rdata
                    td.td-title style=" font-weight: 800; font-size: 18px" rowspan="2"
                      span.text-left = 'FLUJO NETO'
                    - @calendar_fr.each_with_index do |calendar, calendar_index|
                      td.sum_input.sat_value class="full-input col-#{calendar.id}"
                        - if calendar.calendar.period_type == 'anual'
                          span.text-table-concept = 'SAT'
                          br
                          span.td-value0
                            = CompanyFlow.where(calendar_id: calendar.calendar.id, capture_type: 1, company_id: @company.id, flow_concept_id: FlowConcept.find_by(key: 'flujo_neto').try(:id)).first.try(:value)
                  tr.tr-rdata
                    - @calendar_fr.each_with_index do |calendar, calendar_index|
                      td.sum_input class="full-input col-#{calendar.id}"
                        span.text-table-concept = 'CAPTURA'
                        br
                        span.td-value0
                          = CompanyFlow.where(calendar_id: calendar.calendar.id, capture_type: 2, company_id: @company.id, flow_concept_id: FlowConcept.find_by(key: 'flujo_neto').try(:id)).first.try(:value)
                  tr.tr-rdata
                    td.td-title style=" font-weight: 800; font-size: 18px" rowspan="2"
                      span.text-left = 'VARIACIÓN EN ACTIVO FIJO'
                    - @calendar_fr.each_with_index do |calendar, calendar_index|
                      td.sum_input.sat_value class="full-input col-#{calendar.id}"
                        - if calendar.calendar.period_type == 'anual'
                          span.text-table-concept = 'SAT'
                          br
                          span.td-value0
                            = CompanyFlow.where(calendar_id: calendar.calendar.id, capture_type: 1, company_id: @company.id, flow_concept_id: FlowConcept.find_by(key: 'variacion_activo_fijo').try(:id)).first.try(:value)
                  tr.tr-rdata
                    - @calendar_fr.each_with_index do |calendar, calendar_index|
                      td.sum_input class="full-input col-#{calendar.id}"
                        span.text-table-concept = 'CAPTURA'
                        br
                        span.td-value0
                          = CompanyFlow.where(calendar_id: calendar.calendar.id, capture_type: 2, company_id: @company.id, flow_concept_id: FlowConcept.find_by(key: 'variacion_activo_fijo').try(:id)).first.try(:value)
                  tr.tr-rdata
                    td.td-title style=" font-weight: 800; font-size: 18px" rowspan="2"
                      span.text-left = 'VARIACIÓN OTROS ACTIVOS'
                    - @calendar_fr.each_with_index do |calendar, calendar_index|
                      td.sum_input.sat_value class="full-input col-#{calendar.id}"
                        - if calendar.calendar.period_type == 'anual'
                          span.text-table-concept = 'SAT'
                          br
                          span.td-value0
                          = CompanyFlow.where(calendar_id: calendar.calendar.id, capture_type: 1, company_id: @company.id, flow_concept_id: FlowConcept.find_by(key: 'variacion_otros_activos').try(:id)).first.try(:value)
                  tr.tr-rdata
                    - @calendar_fr.each_with_index do |calendar, calendar_index|
                      td.sum_input class="full-input col-#{calendar.id}"
                        span.text-table-concept = 'CAPTURA'
                        br
                        span.td-value0
                          = CompanyFlow.where(calendar_id: calendar.calendar.id, capture_type: 2, company_id: @company.id, flow_concept_id: FlowConcept.find_by(key: 'variacion_otros_activos').try(:id)).first.try(:value)

                  tr.tr-rdata
                    td.td-title style=" font-weight: 800; font-size: 18px" rowspan="2"
                      span.text-left = 'VARIACIÓN OTROS PASIVOS'
                    - @calendar_fr.each_with_index do |calendar, calendar_index|
                      td.sum_input.sat_value class="full-input col-#{calendar.id}"
                        - if calendar.calendar.period_type == 'anual'
                          span.text-table-concept = 'SAT'
                          br
                          span.td-value0
                          = CompanyFlow.where(calendar_id: calendar.calendar.id, capture_type: 1, company_id: @company.id, flow_concept_id: FlowConcept.find_by(key: 'variacion_otros_pasivos').try(:id)).first.try(:value)
                  tr.tr-rdata
                    - @calendar_fr.each_with_index do |calendar, calendar_index|
                      td.sum_input class="full-input col-#{calendar.id}"
                        span.text-table-concept = 'CAPTURA'
                        br
                        span.td-value0
                          = CompanyFlow.where(calendar_id: calendar.calendar.id, capture_type: 2, company_id: @company.id, flow_concept_id: FlowConcept.find_by(key: 'variacion_otros_pasivos').try(:id)).first.try(:value)

                  tr.tr-rdata
                    td.td-title style=" font-weight: 800; font-size: 18px" rowspan="2"
                      span.text-left = 'AUMENTO DISMINUCIÓN EN CAJA'
                    - @calendar_fr.each_with_index do |calendar, calendar_index|
                      td.sum_input.sat_value class="full-input col-#{calendar.id}"
                        - if calendar.calendar.period_type == 'anual'
                          span.text-table-concept = 'SAT'
                          br
                          span.td-value0
                            = CompanyFlow.where(calendar_id: calendar.calendar.id, capture_type: 1, company_id: @company.id, flow_concept_id: FlowConcept.find_by(key: 'aumento_disminucion_caja').try(:id)).first.try(:value)
                  tr.tr-rdata
                    - @calendar_fr.each_with_index do |calendar, calendar_index|
                      td.sum_input class="full-input col-#{calendar.id}"
                        span.text-table-concept = 'CAPTURA'
                        br
                        span.td-value0
                          = CompanyFlow.where(calendar_id: calendar.calendar.id, capture_type: 2, company_id: @company.id, flow_concept_id: FlowConcept.find_by(key: 'aumento_disminucion_caja').try(:id)).first.try(:value)
              - else
                .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                  .m-alert__icon
                    = wicked_pdf_image_tag asset_url('icons/exclamation.png'), size: "30x30"
                  .m-alert__text
                    strong
                      | Aún no se ha generado Flujo de Efectivo.
            - else
              .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                .m-alert__icon
                  = wicked_pdf_image_tag asset_url('icons/exclamation.png'), size: "30x30"
                .m-alert__text
                  strong
                    | Es necesario contar con la captura de BALANCE FINANCIERO y ESTADO DE RESULTADOS para generar FLUJO DE EFECTIVO.

            h3.m-portlet__head-text
              | Entradas y Salidas
            .m-section__content
              - if @cash_flow.present?
                table.table
                  thead.thead-default.thead-custom
                    tr style="text-align: center;"
                      th
                        | Fecha
                      th
                        | Entrada
                      th
                        | Salida
                      th
                        | Moneda
                  tbody
                    - @cash_flow.reverse_each do |cash_flow|
                      tr style="text-align: center;"
                        td
                          = cash_flow[0].first
                        td
                          = number_to_currency(cash_flow[1].try(:first)['amount'].present? ? cash_flow[1].try(:first)['amount'] : 0)
                        td
                          - if cash_flow[1].count > 1
                            = number_to_currency(cash_flow[1].try(:last)['amount'].present? ? cash_flow[1].try(:last)['amount'] : 0)
                          - else
                            = number_to_currency 0
                        td
                          = cash_flow[1].try(:first)['currency']
              - else
                .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                  .m-alert__icon
                    = wicked_pdf_image_tag asset_url('icons/exclamation.png'), size: "30x30"
                  .m-alert__text
                    strong
                      | Aún no se le han asignado flujo de efectivo a la compañía.
            .mt-30
              .btns-card-pdf.full-h
                .d-flex.flex-column.justify-content-between
                  h5.h5.subtitle = 'Comentarios'
                  .m-widget3
                    - if @cf_comments.length > 0
                      - @cf_comments.each do |comment|
                        .m-widget3__item
                          .m-widget3__header
                            .m-widget3__info
                              span.m-widget3__username
                                = User.where(id: comment.user_id).try(:first).full_name
                              span.m-widget3__time
                                = " - #{comment.created_at.strftime('%d/%m/%Y,  %I:%M%p')}"
                          p.comment-bubbled
                            = comment.comment
                            b.aft
                    - else
                      .m-widget3__item
                        .m-widget3__body
                          p.m-widget3__text
                            .text-center
                              | Aún no hay comentarios.


          .col-md-12.my-4
            h3 = "3.4 Razones Financieras"
            - if @company.company_calendar_details.where(assign_to: 'income_statement').present? and FReasonsCompany.where(company_id: @company.id).length > 0
              table.table.table-bordered.input-focusable-table
                tr.tr-title
                  th
                    span style="padding-bottom: 5px;"
                      = "Escala en:"
                    br
                    span.th-scale
                      = 'MILES'
                  - @calendar_fr.each do |y|
                    th.th-title
                      = y.calendar.period_name
                      br
                      = y.calendar.inflation.present? ? "Inflación: #{(y.calendar.inflation)} %" : "Inflación: 0 %"
                tr.tr-title
                  th.sub-th.th-title colspan="#{@calendar_fr.length+ 1}"
                    = 'VENTAS'
                tr.tr-rdata
                  td.td-title style=" font-weight: 800; font-size: 18px" rowspan="2"
                    span.text-left = 'CRECIMIENTO NOM. VENTAS'
                  - @calendar_fr.each_with_index do |calendar, calendar_index|
                    td.sum_input.sat_value class="full-input col-#{calendar.id}"
                      - if calendar.calendar.period_type == 'anual'
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value0
                          = "#{FReasonsCompany.where(calendar_id: calendar.calendar.id, capture_type: 1, company_id: @company.id, f_reasons_concept_id: FReasonsConcept.find_by(key: 'crecimiento_nom_ventas').try(:id)).first.try(:value)} %"

                tr.tr-rdata
                  - @calendar_fr.each_with_index do |calendar, calendar_index|
                    td.sum_input class="full-input col-#{calendar.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value1
                        = "#{FReasonsCompany.where(calendar_id: calendar.calendar.id, capture_type: 2, company_id: @company.id, f_reasons_concept_id: FReasonsConcept.find_by(key: 'crecimiento_nom_ventas').try(:id)).first.try(:value)} %"
                tr.tr-rdata
                  td.td-title style=" font-weight: 800; font-size: 18px" rowspan="2"
                    span.text-left = 'CRECIMIENTO REAL VENTAS'
                  - @calendar_fr.each_with_index do |calendar, calendar_index|
                    td.sum_input.sat_value class="full-input col-#{calendar.id}"
                      - if calendar.calendar.period_type == 'anual'
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value0
                          = "#{FReasonsCompany.where(calendar_id: calendar.calendar.id, capture_type: 1, company_id: @company.id, f_reasons_concept_id: FReasonsConcept.find_by(key: 'crecimiento_real_ventas').try(:id)).first.try(:value)} %"
                tr.tr-rdata
                  - @calendar_fr.each_with_index do |calendar, calendar_index|
                    td.sum_input class="full-input col-#{calendar.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value1
                        = "#{FReasonsCompany.where(calendar_id: calendar.calendar.id, capture_type: 2, company_id: @company.id, f_reasons_concept_id: FReasonsConcept.find_by(key: 'crecimiento_real_ventas').try(:id)).first.try(:value)} %"


                tr.tr-rdata
                  td.td-title style=" font-weight: 800; font-size: 18px; position: relative;" rowspan="2"
                    /-if FReasonsCompany.find_by(f_reasons_concept_id: FReasonsConcept.find_by(key: 'crecimiento_sostenible').try(:id)).present?
                      a.tb-action-btn data-target="#m_crecimiento_sost" data-toggle="modal" href="#m_crecimiento_sost"
                        i.fa.fa-pencil-alt
                    /-else
                      a.tb-action-btn.missing-data-btn data-target="#m_crecimiento_sost" data-toggle="modal" href="#m_crecimiento_sost"
                        i.fa.fa-exclamation
                    span.text-left = 'CRECIMIENTO SOSTENIBLE'
                  - @calendar_fr.each_with_index do |calendar, calendar_index|
                    td.sum_input.sat_value class="full-input col-#{calendar.id}"
                      - if calendar.calendar.period_type == 'anual'
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value0
                          = "#{FReasonsCompany.where(calendar_id: calendar.calendar.id, capture_type: 1, company_id: @company.id, f_reasons_concept_id: FReasonsConcept.find_by(key: 'crecimiento_sostenible').try(:id)).first.try(:value)} %"
                tr.tr-rdata
                  - @calendar_fr.each_with_index do |calendar, calendar_index|
                    td.sum_input class="full-input col-#{calendar.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value1
                        = "#{FReasonsCompany.where(calendar_id: calendar.calendar.id, capture_type: 2, company_id: @company.id, f_reasons_concept_id: FReasonsConcept.find_by(key: 'crecimiento_sostenible').try(:id)).first.try(:value)} %"


                tr.tr-title
                  th.sub-th.th-title colspan="#{@calendar_fr.length+ 1}"
                    = 'RENTABILIDAD'
                tr.tr-rdata
                  td.td-title style=" font-weight: 800; font-size: 18px" rowspan="2"
                    span.text-left = 'ROTACIÓN DE ACTIVOS'
                  - @calendar_fr.each_with_index do |calendar, calendar_index|
                    td.sum_input.sat_value class="full-input col-#{calendar.id}"
                      - if calendar.calendar.period_type == 'anual'
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value0
                          = "#{FReasonsCompany.where(calendar_id: calendar.calendar.id, capture_type: 1, company_id: @company.id, f_reasons_concept_id: FReasonsConcept.find_by(key: 'rotacion_de_activos').try(:id)).first.try(:value)} %"
                tr.tr-rdata
                  - @calendar_fr.each_with_index do |calendar, calendar_index|
                    td.sum_input class="full-input col-#{calendar.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value0
                        = "#{FReasonsCompany.where(calendar_id: calendar.calendar.id, capture_type: 2, company_id: @company.id, f_reasons_concept_id: FReasonsConcept.find_by(key: 'rotacion_de_activos').try(:id)).first.try(:value)} %"
                tr.tr-rdata
                  td.td-title style=" font-weight: 800; font-size: 18px" rowspan="2"
                    span.text-left = 'MARGEN OPERATIVO'
                  - @calendar_fr.each_with_index do |calendar, calendar_index|
                    td.sum_input.sat_value class="full-input col-#{calendar.id}"
                      - if calendar.calendar.period_type == 'anual'
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value0
                          = "#{FReasonsCompany.where(calendar_id: calendar.calendar.id, capture_type: 1, company_id: @company.id, f_reasons_concept_id: FReasonsConcept.find_by(key: 'margen_operativo').try(:id)).first.try(:value)} %"
                tr.tr-rdata
                  - @calendar_fr.each_with_index do |calendar, calendar_index|
                    td.sum_input class="full-input col-#{calendar.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value0
                        = "#{FReasonsCompany.where(calendar_id: calendar.calendar.id, capture_type: 2, company_id: @company.id, f_reasons_concept_id: FReasonsConcept.find_by(key: 'margen_operativo').try(:id)).first.try(:value)} %"
                tr.tr-rdata
                  td.td-title style=" font-weight: 800; font-size: 18px" rowspan="2"
                    span.text-left = 'RENTABILIDAD BASE CAPITAL (ROE)'
                  - @calendar_fr.each_with_index do |calendar, calendar_index|
                    td.sum_input.sat_value class="full-input col-#{calendar.id}"
                      - if calendar.calendar.period_type == 'anual'
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value0
                          = "#{FReasonsCompany.where(calendar_id: calendar.calendar.id, capture_type: 1, company_id: @company.id, f_reasons_concept_id: FReasonsConcept.find_by(key: 'rentabilidad_base_capital').try(:id)).first.try(:value)} %"
                tr.tr-rdata
                  - @calendar_fr.each_with_index do |calendar, calendar_index|
                    td.sum_input class="full-input col-#{calendar.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value0
                        = "#{FReasonsCompany.where(calendar_id: calendar.calendar.id, capture_type: 2, company_id: @company.id, f_reasons_concept_id: FReasonsConcept.find_by(key: 'rentabilidad_base_capital').try(:id)).first.try(:value)} %"
                tr.tr-rdata
                  td.td-title style=" font-weight: 800; font-size: 18px" rowspan="2"
                    span.text-left = 'MARGEN NETO'
                  - @calendar_fr.each_with_index do |calendar, calendar_index|
                    td.sum_input.sat_value class="full-input col-#{calendar.id}"
                      - if calendar.calendar.period_type == 'anual'
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value0
                          = "#{FReasonsCompany.where(calendar_id: calendar.calendar.id, capture_type: 1, company_id: @company.id, f_reasons_concept_id: FReasonsConcept.find_by(key: 'margen_neto').try(:id)).first.try(:value)} %"
                tr.tr-rdata
                  - @calendar_fr.each_with_index do |calendar, calendar_index|
                    td.sum_input class="full-input col-#{calendar.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value0
                        = "#{FReasonsCompany.where(calendar_id: calendar.calendar.id, capture_type: 2, company_id: @company.id, f_reasons_concept_id: FReasonsConcept.find_by(key: 'margen_neto').try(:id)).first.try(:value)} %"
                tr.tr-title
                  th.sub-th.th-title colspan="#{@calendar_fr.length+ 1}"
                    = 'ESTRUCTURA'
                tr.tr-rdata
                  td.td-title style=" font-weight: 800; font-size: 18px" rowspan="2"
                    span.text-left = 'RAZÓN CIRCULANTE'
                  - @calendar_fr.each_with_index do |calendar, calendar_index|
                    td.sum_input.sat_value class="full-input col-#{calendar.id}"
                      - if calendar.calendar.period_type == 'anual'
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value0
                          = FReasonsCompany.where(calendar_id: calendar.calendar.id, capture_type: 1, company_id: @company.id, f_reasons_concept_id: FReasonsConcept.find_by(key: 'razon_circulante').try(:id)).first.try(:value)
                tr.tr-rdata
                  - @calendar_fr.each_with_index do |calendar, calendar_index|
                    td.sum_input class="full-input col-#{calendar.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value0
                        = FReasonsCompany.where(calendar_id: calendar.calendar.id, capture_type: 2, company_id: @company.id, f_reasons_concept_id: FReasonsConcept.find_by(key: 'razon_circulante').try(:id)).first.try(:value)
                tr.tr-rdata
                  td.td-title style=" font-weight: 800; font-size: 18px" rowspan="2"
                    span.text-left = 'PRUEBA DEL ACIDO'
                  - @calendar_fr.each_with_index do |calendar, calendar_index|
                    td.sum_input.sat_value class="full-input col-#{calendar.id}"
                      - if calendar.calendar.period_type == 'anual'
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value0
                          = FReasonsCompany.where(calendar_id: calendar.calendar.id, capture_type: 1, company_id: @company.id, f_reasons_concept_id: FReasonsConcept.find_by(key: 'prueba_del_acido').try(:id)).first.try(:value)
                tr.tr-rdata
                  - @calendar_fr.each_with_index do |calendar, calendar_index|
                    td.sum_input class="full-input col-#{calendar.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value0
                        = FReasonsCompany.where(calendar_id: calendar.calendar.id, capture_type: 2, company_id: @company.id, f_reasons_concept_id: FReasonsConcept.find_by(key: 'prueba_del_acido').try(:id)).first.try(:value)
                tr.tr-rdata
                  td.td-title style=" font-weight: 800; font-size: 18px" rowspan="2"
                    span.text-left = 'PASIVO TOTAL / CAPITAL CONTABLE'
                  - @calendar_fr.each_with_index do |calendar, calendar_index|
                    td.sum_input.sat_value class="full-input col-#{calendar.id}"
                      - if calendar.calendar.period_type == 'anual'
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value0
                          = FReasonsCompany.where(calendar_id: calendar.calendar.id, capture_type: 1, company_id: @company.id, f_reasons_concept_id: FReasonsConcept.find_by(key: 'pas_total_cap_contable').try(:id)).first.try(:value)
                tr.tr-rdata
                  - @calendar_fr.each_with_index do |calendar, calendar_index|
                    td.sum_input class="full-input col-#{calendar.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value0
                        = FReasonsCompany.where(calendar_id: calendar.calendar.id, capture_type: 2, company_id: @company.id, f_reasons_concept_id: FReasonsConcept.find_by(key: 'pas_total_cap_contable').try(:id)).first.try(:value)
                tr.tr-rdata
                  td.td-title style=" font-weight: 800; font-size: 18px" rowspan="2"
                    span.text-left = 'TOTAL PASIVO FINANCIERO'
                  - @calendar_fr.each_with_index do |calendar, calendar_index|
                    td.sum_input.sat_value class="full-input col-#{calendar.id}"
                      - if calendar.calendar.period_type == 'anual'
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value0
                        = FReasonsCompany.where(calendar_id: calendar.calendar.id, capture_type: 1, company_id: @company.id, f_reasons_concept_id: FReasonsConcept.find_by(key: 'total_pasivo_financiero').try(:id)).first.try(:value)
                tr.tr-rdata
                  - @calendar_fr.each_with_index do |calendar, calendar_index|
                    td.sum_input class="full-input col-#{calendar.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value0
                        = FReasonsCompany.where(calendar_id: calendar.calendar.id, capture_type: 2, company_id: @company.id, f_reasons_concept_id: FReasonsConcept.find_by(key: 'total_pasivo_financiero').try(:id)).first.try(:value)
                tr.tr-title
                  th.sub-th.th-title colspan="#{@calendar_fr.length+ 1}"
                    = 'CICLO FINANCIERO'
                tr.tr-rdata
                  td.td-title style=" font-weight: 800; font-size: 18px" rowspan="2"
                    span.text-left = 'DÍAS CLIENTES'
                  - @calendar_fr.each_with_index do |calendar, calendar_index|
                    td.sum_input.sat_value class="full-input col-#{calendar.id}"
                      - if calendar.calendar.period_type == 'anual'
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value0
                          = FReasonsCompany.where(calendar_id: calendar.calendar.id, capture_type: 1, company_id: @company.id, f_reasons_concept_id: FReasonsConcept.find_by(key: 'dias_clientes').try(:id)).first.try(:value)
                tr.tr-rdata
                  - @calendar_fr.each_with_index do |calendar, calendar_index|
                    td.sum_input class="full-input col-#{calendar.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value0
                        = FReasonsCompany.where(calendar_id: calendar.calendar.id, capture_type: 2, company_id: @company.id, f_reasons_concept_id: FReasonsConcept.find_by(key: 'dias_clientes').try(:id)).first.try(:value)
                tr.tr-rdata
                  td.td-title style=" font-weight: 800; font-size: 18px" rowspan="2"
                    span.text-left = 'DÍAS INVENTARIO'
                  - @calendar_fr.each_with_index do |calendar, calendar_index|
                    td.sum_input.sat_value class="full-input col-#{calendar.id}"
                      - if calendar.calendar.period_type == 'anual'
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value0
                          = FReasonsCompany.where(calendar_id: calendar.calendar.id, capture_type: 1, company_id: @company.id, f_reasons_concept_id: FReasonsConcept.find_by(key: 'dias_inventario').try(:id)).first.try(:value)
                tr.tr-rdata
                  - @calendar_fr.each_with_index do |calendar, calendar_index|
                    td.sum_input class="full-input col-#{calendar.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value0
                        = FReasonsCompany.where(calendar_id: calendar.calendar.id, capture_type: 2, company_id: @company.id, f_reasons_concept_id: FReasonsConcept.find_by(key: 'dias_inventario').try(:id)).first.try(:value)
                tr.tr-rdata
                  td.td-title style=" font-weight: 800; font-size: 18px" rowspan="2"
                    span.text-left = 'DÍAS PROVEEDORES'
                  - @calendar_fr.each_with_index do |calendar, calendar_index|
                    td.sum_input.sat_value class="full-input col-#{calendar.id}"
                      - if calendar.calendar.period_type == 'anual'
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value0
                          = FReasonsCompany.where(calendar_id: calendar.calendar.id, capture_type: 1, company_id: @company.id, f_reasons_concept_id: FReasonsConcept.find_by(key: 'dias_proveedores').try(:id)).first.try(:value)
                tr.tr-rdata
                  - @calendar_fr.each_with_index do |calendar, calendar_index|
                    td.sum_input class="full-input col-#{calendar.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value0
                        = FReasonsCompany.where(calendar_id: calendar.calendar.id, capture_type: 2, company_id: @company.id, f_reasons_concept_id: FReasonsConcept.find_by(key: 'dias_proveedores').try(:id)).first.try(:value)
                tr.tr-rdata
                  td.td-title style=" font-weight: 800; font-size: 18px" rowspan="2"
                    span.text-left = 'CICLO FINANCIERO'
                  - @calendar_fr.each_with_index do |calendar, calendar_index|
                    td.sum_input.sat_value class="full-input col-#{calendar.id}"
                      - if calendar.calendar.period_type == 'anual'
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value0
                          = FReasonsCompany.where(calendar_id: calendar.calendar.id, capture_type: 1, company_id: @company.id, f_reasons_concept_id: FReasonsConcept.find_by(key: 'ciclo_financiero').try(:id)).first.try(:value)
                tr.tr-rdata
                  - @calendar_fr.each_with_index do |calendar, calendar_index|
                    td.sum_input class="full-input col-#{calendar.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value0
                        = FReasonsCompany.where(calendar_id: calendar.calendar.id, capture_type: 2, company_id: @company.id, f_reasons_concept_id: FReasonsConcept.find_by(key: 'ciclo_financiero').try(:id)).first.try(:value)
                tr.tr-rdata
                  td.td-title style=" font-weight: 800; font-size: 18px" rowspan="2"
                    span.text-left = 'INVERSIÓN EN TRABAJO'
                  - @calendar_fr.each_with_index do |calendar, calendar_index|
                    td.sum_input.sat_value class="full-input col-#{calendar.id}"
                      - if calendar.calendar.period_type == 'anual'
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value0
                          = FReasonsCompany.where(calendar_id: calendar.calendar.id, capture_type: 1, company_id: @company.id, f_reasons_concept_id: FReasonsConcept.find_by(key: 'inversion_en_trabajo').try(:id)).first.try(:value)
                tr.tr-rdata
                  - @calendar_fr.each_with_index do |calendar, calendar_index|
                    td.sum_input class="full-input col-#{calendar.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value0
                        = FReasonsCompany.where(calendar_id: calendar.calendar.id, capture_type: 2, company_id: @company.id, f_reasons_concept_id: FReasonsConcept.find_by(key: 'inversion_en_trabajo').try(:id)).first.try(:value)
                tr.tr-title
                  th.sub-th.th-title colspan="#{@calendar_fr.length+ 1}"
                    = 'COBERTURAS'
                tr.tr-rdata
                  td.td-title style=" font-weight: 800; font-size: 18px" rowspan="2"
                    span.text-left = 'COBERTURA DE INTERESES (DEP)'
                  - @calendar_fr.each_with_index do |calendar, calendar_index|
                    td.sum_input.sat_value class="full-input col-#{calendar.id}"
                      - if calendar.calendar.period_type == 'anual'
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value0
                          = FReasonsCompany.where(calendar_id: calendar.calendar.id, capture_type: 1, company_id: @company.id, f_reasons_concept_id: FReasonsConcept.find_by(key: 'cobertura_de_intereses').try(:id)).first.try(:value)
                tr.tr-rdata
                  - @calendar_fr.each_with_index do |calendar, calendar_index|
                    td.sum_input class="full-input col-#{calendar.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value0
                        = FReasonsCompany.where(calendar_id: calendar.calendar.id, capture_type: 2, company_id: @company.id, f_reasons_concept_id: FReasonsConcept.find_by(key: 'cobertura_de_intereses').try(:id)).first.try(:value)
                tr.tr-rdata
                  td.td-title style=" font-weight: 800; font-size: 18px; position: relative;" rowspan="2"
                    span.text-left = 'COBERTURA DE DEUDA'
                  - @calendar_fr.each_with_index do |calendar, calendar_index|
                    td.sum_input.sat_value class="full-input col-#{calendar.id}"
                      - if calendar.calendar.period_type == 'anual'
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value0
                          = FReasonsCompany.where(calendar_id: calendar.calendar.id, capture_type: 1, company_id: @company.id, f_reasons_concept_id: FReasonsConcept.find_by(key: 'cobertura_de_deuda').try(:id)).first.try(:value)
                tr.tr-rdata
                  - @calendar_fr.each_with_index do |calendar, calendar_index|
                    td.sum_input class="full-input col-#{calendar.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value0
                        = FReasonsCompany.where(calendar_id: calendar.calendar.id, capture_type: 2, company_id: @company.id, f_reasons_concept_id: FReasonsConcept.find_by(key: 'cobertura_de_deuda').try(:id)).first.try(:value)
                tr.tr-rdata
                  td.td-title style=" font-weight: 800; font-size: 18px; position: relative;" rowspan="2"
                    span.text-left = 'FLUJO NETO / TOTAL PASIVO FINANCIERO'
                  - @calendar_fr.each_with_index do |calendar, calendar_index|
                    td.sum_input.sat_value class="full-input col-#{calendar.id}"
                      - if calendar.calendar.period_type == 'anual'
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value0
                          = "#{FReasonsCompany.where(calendar_id: calendar.calendar.id, capture_type: 1, company_id: @company.id, f_reasons_concept_id: FReasonsConcept.find_by(key: 'flujo_total_pas_fin').try(:id)).first.try(:value)} %"
                tr.tr-rdata
                  - @calendar_fr.each_with_index do |calendar, calendar_index|
                    td.sum_input class="full-input col-#{calendar.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value0
                        = "#{FReasonsCompany.where(calendar_id: calendar.calendar.id, capture_type: 2, company_id: @company.id, f_reasons_concept_id: FReasonsConcept.find_by(key: 'flujo_total_pas_fin').try(:id)).first.try(:value)} %"
                tr.tr-rdata
                  td.td-title style=" font-weight: 800; font-size: 18px; position: relative;" rowspan="2"
                    span.text-left = 'FLUJO NETO / PASIVO TOTAL'
                  - @calendar_fr.each_with_index do |calendar, calendar_index|
                    td.sum_input.sat_value class="full-input col-#{calendar.id}"
                      - if calendar.calendar.period_type == 'anual'
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value0
                          = "#{FReasonsCompany.where(calendar_id: calendar.calendar.id, capture_type: 1, company_id: @company.id, f_reasons_concept_id: FReasonsConcept.find_by(key: 'flujo_total_pas_total').try(:id)).first.try(:value)} %"
                tr.tr-rdata
                  - @calendar_fr.each_with_index do |calendar, calendar_index|
                    td.sum_input class="full-input col-#{calendar.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value0
                        = "#{FReasonsCompany.where(calendar_id: calendar.calendar.id, capture_type: 2, company_id: @company.id, f_reasons_concept_id: FReasonsConcept.find_by(key: 'flujo_total_pas_total').try(:id)).first.try(:value)} %"
                tr.tr-title
                  th.sub-th.th-title colspan="#{@calendar_fr.length+ 1}"
                    = 'HORIZONTE DE DEUDA'
                tr.tr-rdata
                  td.td-title style=" font-weight: 800; font-size: 18px; position: relative;" rowspan="2"
                    span.text-left = 'DEUDA FINANCIERA LP / UAFIRDA'
                  - @calendar_fr.each_with_index do |calendar, calendar_index|
                    td.sum_input.sat_value class="full-input col-#{calendar.id}"
                      - if calendar.calendar.period_type == 'anual'
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value0
                          = FReasonsCompany.where(calendar_id: calendar.calendar.id, capture_type: 1, company_id: @company.id, f_reasons_concept_id: FReasonsConcept.find_by(key: 'deuda_financiera_lp').try(:id)).first.try(:value)
                tr.tr-rdata
                  - @calendar_fr.each_with_index do |calendar, calendar_index|
                    td.sum_input class="full-input col-#{calendar.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value0
                        = FReasonsCompany.where(calendar_id: calendar.calendar.id, capture_type: 2, company_id: @company.id, f_reasons_concept_id: FReasonsConcept.find_by(key: 'deuda_financiera_lp').try(:id)).first.try(:value)
                tr.tr-rdata
                  td.td-title style=" font-weight: 800; font-size: 18px" rowspan="2"
                    span.text-left = 'DEUDA FINANCIERA TOTAL / UAFIRDA'
                  - @calendar_fr.each_with_index do |calendar, calendar_index|
                    td.sum_input.sat_value class="full-input col-#{calendar.id}"
                      - if calendar.calendar.period_type == 'anual'
                        span.text-table-concept = 'SAT'
                        br
                        span.td-value0
                          = FReasonsCompany.where(calendar_id: calendar.calendar.id, capture_type: 1, company_id: @company.id, f_reasons_concept_id: FReasonsConcept.find_by(key: 'deuda_financiera_total').try(:id)).first.try(:value)
                tr.tr-rdata
                  - @calendar_fr.each_with_index do |calendar, calendar_index|
                    td.sum_input class="full-input col-#{calendar.id}"
                      span.text-table-concept = 'CAPTURA'
                      br
                      span.td-value0
                        = FReasonsCompany.where(calendar_id: calendar.calendar.id, capture_type: 2, company_id: @company.id, f_reasons_concept_id: FReasonsConcept.find_by(key: 'deuda_financiera_total').try(:id)).first.try(:value)
            - else
              .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                .m-alert__icon
                  = wicked_pdf_image_tag asset_url('icons/exclamation.png'), size: "30x30"
                .m-alert__text
                  strong
                    | Aún no se han generado las razónes financieras.

            .mt-30
              .btns-card-pdf.full-h
                .d-flex.flex-column.justify-content-between
                  span.h5.subtitle = 'Comentarios'
                  .m-widget3
                    - if @fr_comments.length > 0
                      - @fr_comments.each do |comment|
                        .m-widget3__item
                          .m-widget3__header
                            .m-widget3__info
                              span.m-widget3__username
                                = User.where(id: comment.user_id).try(:first).full_name
                              span.m-widget3__time
                                = " - #{comment.created_at.strftime('%d/%m/%Y,  %I:%M%p')}"
                          p.comment-bubbled
                            = comment.comment
                            b.aft
                    - else
                      .m-widget3__item
                        .m-widget3__body
                          p.m-widget3__text
                            .text-center
                              | Aún no hay comentarios.