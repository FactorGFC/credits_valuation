/ .m-content
  .row
    .col-xl-12
      .col-xl-12
        .m-portlet
          .m-portlet__body
            .m-section.mb-0
              .row
                = wicked_pdf_image_tag asset_url('logo.png'), width: "auto"
              .row
                .portlet-profile.d-flex.justify-content-end
                  .info-profile-container
                    .icon-circle.d-flex.justify-content-end.align-items-center.px-5
                      i.fa.fa-id-card.fa-4x style="position: relative;"
                    .d-flex.flex-column.col-md-12.mb-2
                      .col-md-12
                        span.port-title = @company_name
                        span = DateTime.now.strftime("%d/%m/%Y")
doctype 5
html.wf-roboto-n3-active.wf-roboto-n4-active.wf-roboto-n5-active.wf-roboto-n6-active.wf-roboto-n7-active.wf-poppins-n3-active.wf-poppins-n4-active.wf-poppins-n5-active.wf-poppins-n6-active.wf-poppins-n7-active.wf-active
  head
    meta charset='utf-8' /
    meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1' /
    meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, shrink-to-fit=no" /
    = csrf_meta_tags
    = csp_meta_tag
    = wicked_pdf_stylesheet_link_tag "application"

  body.m-page--fluid.m--skin-.m-content--skin-light2.m-header--fixed.m-header--fixed-mobile.m-aside-left--enabled.m-aside-left--skin-dark.m-aside-left--fixed.m-aside-left--offcanvas.m-footer--push.m-aside--offcanvas-default class="#{'m-brand--minimize m-aside-left--minimize' if cookies[:sidebar_toggle_state].eql?('on')}"
    .m-content
      .row
        .col-xl-12
          span.port-title = @company_name
          span = DateTime.now.strftime("%d/%m/%Y")
      .row
        .col-xl-12
          .h2 Datos Generales
      .row
        .col-xl-12
          table.table-bordered style="display: block;overflow-x: auto;"
            thead.thead-default
              tr
                th
                  | Ubicación
                th
                  | Actividad / RFC / Régimen
                th
                  | Principales Productos
            tbody
              tr
                td
                  = @company_state_municipality + ' ' + @company_address
                td
                  = @company.main_activity + ' / ' + @company.rfc
                td
                  - @company.main_product_list.each do |e|
                    .ul
                      .li = "#{e}"
          / .col-xl-4
            .h4 Ubicación
            .p = @company_state_municipality + ' ' + @company_address
          / .col-xl-4
            .h4 Actividad / RFC / Régimen
            .p = @company.main_activity + ' / ' + @company.rfc
          / .col-xl-4
            .h4 Principales Productos
            - @company.main_product_list.each do |e|
              .ul
                .li = "#{e}"
      .row
        .col-xl-12
          table.table-bordered style="display: block;overflow-x: auto;"
            thead.thead-default
              tr
                th
                  | Colaboradores
                th
                  | Comentarios del Analista
            tbody
              tr
                td
                  | -
                td
                  | -
      .br
      .row
        .col-xl-12
          .h2 Consultas Externas
      .row
        .col-xl-12
          .h4 Buró de Crédito
          .m-portlet__body
            .m-section.mb-0
              - if !@credit_bureau.present?
                .m-section__content
                  .no-results
              - else
                .m-section__sub
                  .row.m-section__sub style="display: flex"
                    .col-6.pl-0
                    .col-6.per-page-container
              .m-section__content
                - if @credit_bureau.present? and @company.try(:client_type).eql?('PF')
                  .m-demo data-code-html="true" data-code-js="false" data-code-preview="true"
                  .m-demo__preview
                    h3.m-portlet__head-text
                      | SCORE
                  .m-demo data-code-html="true" data-code-js="false" data-code-preview="true"
                    .m-demo__preview
                      .d-flex.flex-column.justify-content-center
                        .gauge-wrapper
                          .gauge.four.rischio style="--degres: #{calculate_degrees(@score)}deg;"
                            .slice-colors
                              .st.slice-item
                              .st.slice-item
                              .st.slice-item
                              .st.slice-item
                            .needle
                            .gauge-center
                              .number
                                = @score
                              .status-face
                        /= image_tag calculate_face(@score)

                        .d-inline-flex.justify-content-center
                          .d-flex.flex-column.justify-content-between.align-items-center.status-container
                            span.text-center
                              strong = 'BAJA, MENOR A 550 PUNTOS'
                            = image_tag 'face-bad.png'
                          .d-flex.flex-column.justify-content-between.align-items-center.status-container
                            span.text-center
                              strong = 'REGULAR, 551-650 PUNTOS'
                            = image_tag 'face-med.png'
                          .d-flex.flex-column.justify-content-between.align-items-center.status-container
                            span.text-center
                              strong = 'BUENA 651- 750 PUNTOS'
                            = image_tag 'face-nice.png'
                          .d-flex.flex-column.justify-content-between.align-items-center.status-container
                            span.text-center
                              strong = 'EXCELENTE MÁS DE 751 PUNTOS'
                            = image_tag 'face-good.png'
                  .m-demo data-code-html="true" data-code-js="false" data-code-preview="true"
                    .m-demo__preview
                      h3.m-portlet__head-text
                        | Datos Generales
                      .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                        - if @credit_bureau.present?

                          - if @report_result['response'].present?
                            .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                              strong
                                | Nombre
                            .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                              = @report_result['response']['return']['Personas']['Persona'][0]['Nombre']['PrimerNombre'] + ' ' + @report_result['response']['return']['Personas']['Persona'][0]['Nombre']['ApellidoPaterno'] + ' ' + @report_result['response']['return']['Personas']['Persona'][0]['Nombre']['ApellidoMaterno']
                            .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                              strong
                                | R.F.C
                            .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                              = @report_result['response']['return']['Personas']['Persona'][0]['Nombre']['RFC']
                            .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                              strong
                                | Fecha de nacimiento
                            .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                              = get_pm_birthdate @report_result['response']['return']['Personas']['Persona'][0]['Nombre']['FechaNacimiento']
                          - else
                            .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                              .m-alert__icon
                                i.flaticon-exclamation-1
                                span
                              .m-alert__text
                                strong
                                  | Aún no se encuentran datos generales.
                        - else
                          .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                            .m-alert__icon
                              i.flaticon-exclamation-1
                              span
                            .m-alert__text
                              strong
                                | Aún no se encuentran datos generales.
                  .m-demo data-code-html="true" data-code-js="false" data-code-preview="true"
                    .m-demo__preview
                      h3.m-portlet__head-text
                        | Resumen de Créditos (M.N.)
                      - if @credit_bureau.bureau_report.present?
                        - if @report_result['response'].present?
                          .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                            .m-section
                              .m-section__content
                                table.table style="display: block;overflow-x: auto;"
                                  thead.thead-default
                                    tr
                                      th
                                        | MOP
                                      th
                                        | Cuentas Abiertas
                                      th
                                        | Limite Abiertas
                                      th
                                        | Maximo Abiertas
                                      th
                                        | Saldo Actual Abiertas
                                      th
                                        | Saldo Vencido Abiertas
                                      th
                                        | Pago a Realizar
                                      th
                                        | Cuentas Cerradas
                                      th
                                        | Limite Cerradas
                                      th
                                        | Maximo Cerradas
                                      th
                                        | Saldo Actual Cerradas
                                      th
                                        | Monto Cerradas
                                  tbody
                                    - get_ur_credits(@report_result['response']['return']['Personas']['Persona'][0]['Cuentas']['Cuenta']).each do |credit|
                                      tr
                                        td
                                          = credit[:mop]
                                        td
                                          = credit[:cuentas_abiertas]
                                        td
                                          = number_to_currency credit[:limite_abiertas]
                                        td
                                          = number_to_currency credit[:maximo_abiertas]
                                        td
                                          = number_to_currency credit[:saldo_actual]
                                        td
                                          = number_to_currency credit[:saldo_vencido]
                                        td
                                          = number_to_currency credit[:pago_realizar]
                                        td
                                          = credit[:cuentas_cerradas]
                                        td
                                          = number_to_currency credit[:limite_cerradas]
                                        td
                                          = number_to_currency credit[:maximo_cerradas]
                                        td
                                          = number_to_currency credit[:saldo_cerradas]
                                        td
                                          = number_to_currency credit[:monto_cerradas]

                  .m-demo data-code-html="true" data-code-js="false" data-code-preview="true"
                    .m-demo__preview
                      h3.m-portlet__head-text
                        | Domicilios registrados
                      - if @credit_bureau.present?
                        - if @report_result['response'].present?
                          - @report_result['response']['return']['Personas']['Persona'][0]['Domicilios']['Domicilio'].each do |address|
                            .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                              .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                                strong
                                  | Calle y número
                              .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                                = address['Direccion1']
                              .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                                strong
                                  | Colonia
                              .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                                = address['ColoniaPoblacion']
                              .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                                strong
                                  | Del / Mpio
                              .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                                = address['DelegacionMunicipio']
                            .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                              .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                                strong
                                  | Estado
                              .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                                = address['Estado']
                              .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                                strong
                                  | C.P
                              .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                                = address['CP']
                              .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                                strong
                                  | Teléfono
                              .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                                = address['NumeroTelefono']
                            br
                        - else
                          .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                            .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                              .m-alert__icon
                                i.flaticon-exclamation-1
                                span
                              .m-alert__text
                                strong
                                  | Aún no se encuentran domicilios registrados.
                      - else
                        .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                          .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                            .m-alert__icon
                              i.flaticon-exclamation-1
                              span
                            .m-alert__text
                              strong
                                | Aún no se encuentran domicilios registrados.

                  .m-demo data-code-html="true" data-code-js="false" data-code-preview="true"
                    .m-demo__preview
                      h3.m-portlet__head-text
                        | Domicilio(s) de empleo(s) registrado(s)
                      - if @credit_bureau.present?
                        - if @report_result['response'].present?
                          - @report_result['response']['return']['Personas']['Persona'][0]['Empleos']['Empleo'].each do |job|
                            .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                              .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                                strong
                                  | Compañía
                              .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                                = job['NombreEmpresa']
                              .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                                strong
                                  | Puesto
                              .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                                = job['Cargo']
                              .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                                strong
                                  | País
                              .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                                = job['CodPais']
                            .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                              .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                                strong
                                  | Calle y número
                              .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                                = job['Direccion1']
                              .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                                strong
                                  | Telefono
                              .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                                = job['NumeroTelefono']
                              .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                                strong
                                  | Fecha de contratación
                              .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                                = get_pm_birthdate job['FechaContratacion']

                            br
                        - else
                          .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                            .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                              .m-alert__icon
                                i.flaticon-exclamation-1
                                span
                              .m-alert__text
                                strong
                                  | Aún no se encuentran Domicilio(s) de empleo(s) registrado(s).
                      - else
                        .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                          .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                            .m-alert__icon
                              i.flaticon-exclamation-1
                              span
                            .m-alert__text
                              strong
                                | Aún no se encuentran Domicilio(s) de empleo(s) registrado(s).


                  .m-demo data-code-html="true" data-code-js="false" data-code-preview="true"
                    .m-demo__preview
                      h3.m-portlet__head-text
                        | Cuentas
                      - if @credit_bureau.present?
                        - if @report_result['response'].present?
                          - @report_result['response']['return']['Personas']['Persona'][0]['Cuentas']['Cuenta'].each do |account|
                            .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                              .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                                strong
                                  | Nombre del Otorgante
                              .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                                = account['NombreOtorgante']
                              .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                                strong
                                  | Monto a pagar
                              .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                                = number_to_currency account['MontoPagar']
                              .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                                strong
                                  | Tipo de cuenta
                              .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                                = I18n.t("account_type.#{account['TipoCuenta']}")
                            .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                              .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                                strong
                                  | Saldo actual
                              .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                                = account['SaldoActual']
                              .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                                strong
                                  | Saldo vencido
                              .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                                = account['SaldoVencido']
                              .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                                strong
                                  | Tipo de contrato
                              .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                                = I18n.t("contract_type.#{account['TipoContrato']}")
                            .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                              .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                                strong
                                  | Crédito máximo
                              .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                                = number_to_currency account['CreditoMaximo']
                              .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                                strong
                                  | Forma de Pago
                              .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                                = method_payment account['FormaPagoActual']
                              .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                                strong
                                  | Frecuencia de pagos
                              .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                                = I18n.t("payments_frecuency.#{account['FrecuenciaPagos']}")
                            .m-stack.m-stack--ver.m-stack--general.m-stack--demo.mt-2
                              .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle.d-flex.justify-content-between.align-items-center.history-header
                                h4.strong
                                  | Historial de pagos
                                .history-icon
                                  i.fa.fa-calendar-check.fa-2x.lightgray-text
                            .m-stack.m-stack--ver.m-stack--general.m-stack--demo.history-table
                              .m-stack__item.body-info-company.m-stack__item--middle
                                strong
                                  | Mes
                              .m-stack__item.body-info-company.m-stack__item--middle.text-center
                                strong
                                  | E
                              .m-stack__item.body-info-company.m-stack__item--middle.text-center
                                strong
                                  | F
                              .m-stack__item.body-info-company.m-stack__item--middle.text-center
                                strong
                                  | M
                              .m-stack__item.body-info-company.m-stack__item--middle.text-center
                                strong
                                  | A
                              .m-stack__item.body-info-company.m-stack__item--middle.text-center
                                strong
                                  | M
                              .m-stack__item.body-info-company.m-stack__item--middle.text-center
                                strong
                                  | J
                              .m-stack__item.body-info-company.m-stack__item--middle.text-center
                                strong
                                  | J
                              .m-stack__item.body-info-company.m-stack__item--middle.text-center
                                strong
                                  | A
                              .m-stack__item.body-info-company.m-stack__item--middle.text-center
                                strong
                                  | S
                              .m-stack__item.body-info-company.m-stack__item--middle.text-center
                                strong
                                  | O
                              .m-stack__item.body-info-company.m-stack__item--middle.text-center
                                strong
                                  | N
                              .m-stack__item.body-info-company.m-stack__item--middle.text-center
                                strong
                                  | D
                            - get_history_payments(account).each do |key, value|
                              .m-stack.m-stack--ver.m-stack--general.m-stack--demo.history-table
                                .m-stack__item.body-info-company.m-stack__item--middle
                                  = key
                                - value.each do |v|
                                  - if v[:value] == 0
                                    .m-stack__item.body-info-company.m-stack__item--middle
                                  - elsif v[:value] == '1'
                                    .m-stack__item.body-info-one.m-stack__item--middle
                                      strong
                                        = v[:value]
                                  - elsif v[:value] == '2'
                                    .m-stack__item.body-info-two.m-stack__item--middle
                                      strong
                                        = v[:value]
                                  - else
                                    .m-stack__item.body-info-x.m-stack__item--middle
                                      strong
                                        = v[:value]
                            hr.dotted
                        - else
                          .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                            .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                              .m-alert__icon
                                i.flaticon-exclamation-1
                                span
                              .m-alert__text
                                strong
                                  | Aún no se encuentran cuentas.
                      - else
                        .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                          .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                            .m-alert__icon
                              i.flaticon-exclamation-1
                              span
                            .m-alert__text
                              strong
                                | Aún no se encuentran cuentas.
                  .m-demo data-code-html="true" data-code-js="false" data-code-preview="true"
                    .m-demo__preview
                      h3.m-portlet__head-text
                        | Consultas
                      - if @credit_bureau.bureau_report.present?
                        - @credit_bureau['bureau_report']['results'].each do |bureau_report|
                          - if bureau_report['status']
                            .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                              .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                                = I18n.t("report_type.#{bureau_report['metadata']['reportType']}")
                              .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                                = bureau_report['status']
                              .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                                = bureau_report['createdAt'].to_datetime.strftime('%d-%m-%Y')
                              .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                                a href="/credit_bureaus/#{bureau_report['id']}"
                                  |Ver reporte
                      - else
                        .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                          .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                            .m-alert__icon
                              i.flaticon-exclamation-1
                              span
                            .m-alert__text
                              strong
                                | Aún no se encuentran consultas.

                - elsif (@credit_bureau.present? and @company.try(:client_type).eql?('PM')) || (@credit_bureau.present? and @company.try(:client_type).eql?('PFAE'))

                  .m-demo data-code-html="true" data-code-js="false" data-code-preview="true"
                    .m-demo__preview
                      h3.m-portlet__head-text
                      .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                        - if @credit_bureau.present?
                          - if @report_result['query'].present?
                            .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                              .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                                strong
                                  | Calificación cartera
                              .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                                - if @report_result['response']['respuesta']['datosGenerales'].present?
                                  strong
                                    = @report_result['response']['respuesta']['datosGenerales']['calificacionCartera'].present? ? @report_result['response']['respuesta']['datosGenerales']['calificacionCartera'].tr('0', '') : 'N/D'
                                - else
                                  strong
                                    | N/D

                          - else
                          .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                            .m-alert__icon
                              i.flaticon-exclamation-1
                              span
                            .m-alert__text
                              strong
                                | Aún no se encuentra calificación.
                        - else
                          .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                            .m-alert__icon
                              i.flaticon-exclamation-1
                              span
                            .m-alert__text
                              strong
                                | Aún no se encuentra calificación.
                  .m-demo data-code-html="true" data-code-js="false" data-code-preview="true"
                    .m-demo__preview
                      h3.m-portlet__head-text
                        | Datos Generales
                      .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                        - if @credit_bureau.present?
                          - if @report_result['query'].present?
                            .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                              strong
                                | Nombre
                            .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                              strong
                                = @report_result['query']['consulta']['persona']['nombre']
                            .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                              strong
                                | R.F.C
                            .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                              strong
                                = @report_result['query']['consulta']['persona']['rfc']

                          - else
                          .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                            .m-alert__icon
                              i.flaticon-exclamation-1
                              span
                            .m-alert__text
                              strong
                                | Aún no se encuentran datos generales.
                        - else
                          .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                            .m-alert__icon
                              i.flaticon-exclamation-1
                              span
                            .m-alert__text
                              strong
                                | Aún no se encuentran datos generales.

                  .m-demo data-code-html="true" data-code-js="false" data-code-preview="true"
                    .m-demo__preview
                      h3.m-portlet__head-text
                        | Domicilio registrado
                      - if @credit_bureau.present?
                        - if @report_result['query'].present?
                          .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                            .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                              strong
                                | Calle y número
                            .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                              = @report_result['response']['respuesta']['datosGenerales'].present? ? @report_result['response']['respuesta']['datosGenerales']['direccion1'] : 'N/D'
                            .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                              strong
                                | Colonia
                            .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                              = @report_result['response']['respuesta']['datosGenerales'].present? ? @report_result['response']['respuesta']['datosGenerales']['coloniaPoblacion'] : 'N/D'
                            .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                              strong
                                | Del / Mpio
                            .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                              = @report_result['response']['respuesta']['datosGenerales'].present? ? @report_result['response']['respuesta']['datosGenerales']['delegacionMunicipio'] : 'N/D'
                          .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                            .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                              strong
                                | Estado
                            .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                              = @report_result['response']['respuesta']['datosGenerales'].present? ? @report_result['response']['respuesta']['datosGenerales']['estado'] : 'N/D'
                            .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                              strong
                                | C.P
                            .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                              = @report_result['response']['respuesta']['datosGenerales'].present? ? @report_result['response']['respuesta']['datosGenerales']['codigoPostal'] : 'N/D'
                            .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                              strong
                                | Teléfono
                            .m-stack__item.m-stack__item--left.body-info-company.m-stack__item--middle
                              = @report_result['response']['respuesta']['datosGenerales'].present? ? @report_result['response']['respuesta']['datosGenerales']['telefono'] : 'N/D'
                          br
                        - else
                          .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                            .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                              .m-alert__icon
                                i.flaticon-exclamation-1
                                span
                              .m-alert__text
                                strong
                                  | Aún no se encuentran domicilios registrados.
                      - else
                        .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                          .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                            .m-alert__icon
                              i.flaticon-exclamation-1
                              span
                            .m-alert__text
                              strong
                                | Aún no se encuentran domicilios registrados.
                  .m-demo data-code-html="true" data-code-js="false" data-code-preview="true"
                    .m-demo__preview
                      h3.m-portlet__head-text
                        | Créditos activos
                      - if @credit_bureau.bureau_report.present?
                        - if @report_result['response'].present?
                          .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                            .m-section
                              .m-section__content
                                table.table style="display: block;overflow-x: auto;"
                                  thead.thead-default
                                    tr
                                      th
                                        | Tipo de Otorgante
                                      th
                                        | Tipo de Crédito
                                      th
                                        | Cuentas Abiertas
                                      th
                                        Cuentas en MXP
                                      th
                                        | Cuentas en USD
                                      th
                                        | Otras Monedas
                                      th
                                        | Original
                                      th
                                        | Saldo Actual
                                      th
                                        | Vigente
                                      th
                                        | 1-29 días
                                      th
                                        | 30-59 días
                                      th
                                        | 60-89 días
                                      th
                                        | 90-119 días
                                      th
                                        | 120 - 179 días
                                      th
                                        | 180+ días
                                  tbody
                                    - get_active_credits(@report_result['response']['respuesta']['creditoFinanciero']).each do |active_credit|
                                      tr
                                        th
                                          = active_credit[:otorgante]
                                        th
                                          = active_credit[:tipo_credito]
                                        th
                                          = active_credit[:cuentas_abiertas]
                                        th
                                          = active_credit[:cuentas_mxp]
                                        th
                                          = active_credit[:cuentas_usd]
                                        th
                                          = active_credit[:otras_monedas]
                                        th
                                          = number_to_currency active_credit[:original]
                                        th
                                          = number_to_currency active_credit[:saldo_actual]
                                        th
                                          = number_to_currency active_credit[:vigente]
                                        th
                                          = active_credit[:one]
                                        th
                                          = active_credit[:thirty]
                                        th
                                          = active_credit[:sixty]
                                        th
                                          = active_credit[:ninety]
                                        th
                                          = active_credit[:one_twenty]
                                        th
                                          = active_credit[:one_eighty]
                                    - get_total_active_credits(@report_result['response']['respuesta']['creditoFinanciero']).each do |active_credit|
                                      tr
                                        th colspan="2"
                                          | Total
                                        th
                                          = active_credit[:cuentas_abiertas]
                                        th
                                          = active_credit[:cuentas_mxp]
                                        th
                                          = active_credit[:cuentas_usd]
                                        th
                                          = active_credit[:otras_monedas]
                                        th
                                          = number_to_currency active_credit[:original]
                                        th
                                          = number_to_currency active_credit[:saldo_actual]
                                        th
                                          = number_to_currency active_credit[:vigente]
                                        th
                                          = active_credit[:one]
                                        th
                                          = active_credit[:thirty]
                                        th
                                          = active_credit[:sixty]
                                        th
                                          = active_credit[:ninety]
                                        th
                                          = active_credit[:one_twenty]
                                        th
                                          = active_credit[:one_eighty]

                        - else
                          .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                            .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                              .m-alert__icon
                                i.flaticon-exclamation-1
                                span
                              .m-alert__text
                                strong
                                  | Aún no se encuentran creditos activos.
                      - else
                        .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                          .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                            .m-alert__icon
                              i.flaticon-exclamation-1
                              span
                            .m-alert__text
                              strong
                                | Aún no se encuentran creditos activos.
                  .m-demo data-code-html="true" data-code-js="false" data-code-preview="true"
                    .m-demo__preview
                      h3.m-portlet__head-text
                        | Historia
                      - if @credit_bureau.present?
                        - if @report_result['response'].present?
                          - split_months = @report_result['response']['respuesta']['historia'].length / 5.0
                          - if split_months % 1 != 0
                            - split_months += 1
                          - starting = 0
                          - ending = 4
                          .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                            .m-section
                              .m-section__content
                                table.table style="display: block;overflow-x: auto;"
                                  - for a in 1..split_months do
                                    thead.thead-default
                                      tr
                                        th
                                        - @report_result['response']['respuesta']['historia'][starting..ending].each do |historia|
                                          th
                                            = get_date historia['periodo']
                                    tbody
                                      tr
                                        th
                                          | Vigente
                                        - @report_result['response']['respuesta']['historia'][starting..ending].each do |historia|
                                          th
                                            = number_to_currency historia['saldoVigente']
                                      tr
                                        th
                                          | Vencido de 1 a 29 días
                                        - @report_result['response']['respuesta']['historia'][starting..ending].each do |historia|
                                          th
                                            = number_to_currency historia['saldoVencidoA90Dias']
                                      tr
                                        th
                                          | Vencido de 30 a 59 días
                                        - @report_result['response']['respuesta']['historia'][starting..ending].each do |historia|
                                          th
                                            = number_to_currency historia['saldoVencido1A29Dias']
                                      tr
                                        th
                                          | Vencido de 60 a 89 días
                                        - @report_result['response']['respuesta']['historia'][starting..ending].each do |historia|
                                          th
                                            = number_to_currency historia['saldoVencido30A59Dias']
                                      tr
                                        th
                                          | Vencido de a mas de 89 días
                                        - @report_result['response']['respuesta']['historia'][starting..ending].each do |historia|
                                          th
                                            = number_to_currency historia['saldoVencido60A89Dias']
                                      tr
                                        th
                                          | Calificación de cartera
                                        - @report_result['response']['respuesta']['historia'][starting..ending].each do |historia|
                                          th
                                            = historia['calificacioncartera'].present? ? historia['calificacioncartera'] : 'N/D'

                                    - starting += 5
                                    - ending += 5

                        - else
                          .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                            .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                              .m-alert__icon
                                i.flaticon-exclamation-1
                                span
                              .m-alert__text
                                strong
                                  | Aún no se encuentran creditos activos.
                      - else
                        .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                          .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                            .m-alert__icon
                              i.flaticon-exclamation-1
                              span
                            .m-alert__text
                              strong
                                | Aún no se encuentran creditos activos.

                  .m-demo data-code-html="true" data-code-js="false" data-code-preview="true"
                    .m-demo__preview
                      h3.m-portlet__head-text
                        | Consultas
                      - if false
                      /- if @credit_bureau.bureau_report.present?
                                              - @credit_bureau['bureau_report']['results'].each do |bureau_report|
                                                - if bureau_report['status']
                                                  .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                                                    .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                                                      /= I18n.t("report_type.#{bureau_report['metadata']['reportType']}")
                                                      = bureau_report['metadata']['reportType']
                                                    .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                                                      = bureau_report['status']
                                                    .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                                                      = bureau_report['createdAt'].to_datetime.strftime('%d-%m-%Y')
                                                    .m-stack__item.header-info-company.m-stack__item--left.m-stack__item--middle
                                                      a href="/credit_bureaus/#{bureau_report['id']}"
                                                        |Ver reporte
                      - else
                      .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                        .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                          .m-alert__icon
                            i.flaticon-exclamation-1
                            span
                          .m-alert__text
                            strong
                              | Aún no se encuentran consultas.

                  .m-demo data-code-html="true" data-code-js="false" data-code-preview="true"
                    .m-demo__preview
                      h3.m-portlet__head-text
                        | Información de Hawk
                      - if @credit_bureau.present?
                        - if @report_result['response']['respuesta']['hawkHr'].present?
                          .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                            .m-section
                              .m-section__content
                                table.table style="display: block;overflow-x: auto;"
                                  thead.thead-default
                                    tr
                                      th
                                        | Num
                                      th
                                        | Fecha de
                                      th
                                        | Clave
                                      th
                                        | Descripción
                                      th
                                        | Responsabilidad
                                      th
                                        | Reportado por
                                      th
                                        | Mensaje
                                      th
                                        | Coincidencia por datos de
                                  tbody
                                    tr
                                      td
                                        = @report_result['response']['respuesta']['hawkHr'].present? ? '1' : ''
                                      td
                                        = @report_result['response']['respuesta']['hawkHr'].present? ? @report_result['response']['respuesta']['hawkHr']['fechaMensajeHawk'] : ''
                                      td
                                        = @report_result['response']['respuesta']['hawkHr'].present? ? @report_result['response']['respuesta']['hawkHr']['codigoHawk'] : ''
                                      td
                                        = @report_result['response']['respuesta']['hawkHr'].present? ? @report_result['response']['respuesta']['hawkHr']['descripcionPrevencionHawk'] : ''
                                      td
                                        | -
                                      td
                                        | -
                                      td
                                        | -
                                      td
                                        | -
                        - else
                          .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                            .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                              .m-alert__icon
                                i.flaticon-exclamation-1
                                span
                              .m-alert__text
                                strong
                                  | Aún no se encuentra información de Hawk
                      - else
                        .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                          .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                            .m-alert__icon
                              i.flaticon-exclamation-1
                              span
                            .m-alert__text
                              strong
                                | Aún no se encuentran información de Hawk

                  .m-demo data-code-html="true" data-code-js="false" data-code-preview="true"
                    .m-demo__preview
                      h3.m-portlet__head-text
                        | Accionistas
                      - if @credit_bureau.bureau_report.present?
                        - if @report_result['response']['respuesta']['accionista'].present?
                          .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                            .m-section
                              .m-section__content
                                table.table style="display: block;overflow-x: auto;"
                                  thead.thead-default
                                    tr
                                      th
                                        | RFC
                                      th
                                        | Nombre Accionista
                                      th
                                        | Dirección
                                      th
                                        | Control
                                  tbody
                                    tr
                                      th
                                        = @report_result['response']['respuesta']['accionista']['rfc']
                                      th
                                        = @report_result['response']['respuesta']['accionista']['nombreAccionista'] + ' ' + (@report_result['response']['respuesta']['accionista']['segundoNombre'] if @report_result['response']['respuesta']['accionista']['segundoNombre'].present?) + ' ' + @report_result['response']['respuesta']['accionista']['apellidoPaterno'] + ' ' + @report_result['response']['respuesta']['accionista']['apellidoMaterno']
                                      th
                                        | -
                                      th
                                        = @report_result['response']['respuesta']['accionista']['porcentaje']

                        - else
                          .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                            .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                              .m-alert__icon
                                i.flaticon-exclamation-1
                                span
                              .m-alert__text
                                strong
                                  | Aún no se encuentra información de accionista.
                      - else
                        .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                          .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                            .m-alert__icon
                              i.flaticon-exclamation-1
                              span
                            .m-alert__text
                              strong
                                | Aún no se encuentra información de accionista.

                  .m-demo data-code-html="true" data-code-js="false" data-code-preview="true"
                    .m-demo__preview
                      h3.m-portlet__head-text
                        | Califica
                      - if @credit_bureau.bureau_report.present?
                        - if @report_result['response']['respuesta']['califica'].present?
                          .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                            .m-section
                              .m-section__content
                                table.table style="display: block;overflow-x: auto;"
                                  thead.thead-default
                                    tr
                                      th
                                        | Identificador de la característica
                                      th
                                        | Código de la característica
                                      th
                                        | Valor de la característica
                                  tbody
                                    - @report_result['response']['respuesta']['califica'].each do |califica|
                                      tr
                                        th
                                          = califica['clave']
                                        th
                                          = califica['nombre']
                                        th
                                          = califica['valorCaracteristica']

                        - else
                          .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                            .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                              .m-alert__icon
                                i.flaticon-exclamation-1
                                span
                              .m-alert__text
                                strong
                                  | Aún no se encuentra información califica.
                      - else
                        .m-stack.m-stack--ver.m-stack--general.m-stack--demo
                          .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                            .m-alert__icon
                              i.flaticon-exclamation-1
                              span
                            .m-alert__text
                              strong
                                | Aún no se encuentra información califica.
                - else
                  .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                    .m-alert__icon
                      i.flaticon-exclamation-1
                      span
                    .m-alert__text
                      strong
                        | Aún no se le ha asignado el buró de crédito.
      .row
        .col-xl-12
          .h2 Información Financiera
      .row
        .col-xl-12
          .h4 Estado de Resultados
          .col-xl-12
            .m-portlet
              .m-portlet__body
                .m-section.mb-0
                  - if @company.company_calendar_details.where(assign_to: 'income_statement').present?
                    table.table.table-bordered.input-focusable-table#comparative_table_is
                      tr.tr-title
                        th
                        - @calendar_periods_is.each do |y|
                          th.th-title id="col-#{y.id}_head"
                            = y.calendar.period_name
                        th id="col-comp_head_comparative_table_is"
                          = 'COMPARACIÓN (ANUAL)'
                      tr.tr-rdata
                        td style=" font-weight: 800; font-size: 18px" rowspan="2"
                          span.text-left = 'Ingresos'
                        - @calendar_periods_is.each_with_index do |y, y_index|
                          td.sum_input.sat_value class="full-input col-#{y.id}"
                            - if y.calendar.period_type == 'anual'
                              div class=['percentage-badge', calculate_percentage('income_statement', @company.id, y.calendar, 1, @ins_scale)[1]]
                                span#comparative_table_is class=["percent-bdg0-#{y_index}"] = "#{calculate_percentage('income_statement', @company.id, y.calendar, 1, @ins_scale)[0]} %"
                              span.text-table-concept = 'SAT'
                              br
                              span.td-value0 = company_income_stat_value(@company.id, y.calendar, 1, @ins_scale).to_s(:delimited)
                              span.value-scale = @ins_scale

                        td.full-input.total_p0.col-comp
                          div.percentage-badge.blue-badge
                            span.tb-badge0 = "0"
                          span.total_p0 = "0"
                          span.scale0.value-scale = @bs_scale
                      tr.tr-rdata
                        - @calendar_periods_is.each do |y|
                          td.sum_input class="full-input col-#{y.id}"
                            span.text-table-concept = 'CAPTURA'
                            br
                            span.td-value1 = income_calendar_detail_value(@company.id, y.calendar, 1, @ins_scale).to_s(:delimited)
                            span.value-scale = @ins_scale

                        td.full-input.total_p1.col-comp
                          span.total_p1 = "0"
                          span.scale1.value-scale = @bs_scale
                      tr.tr-rdata
                        td style=" font-weight: 800; font-size: 18px" rowspan="2"
                          span.text-left = 'Costo de ventas'
                        - @calendar_periods_is.each_with_index do |y, y_index|
                          td.sum_input class="full-input col-#{y.id}"
                            - if y.calendar.period_type == 'anual'
                              div class=['percentage-badge', calculate_percentage('income_statement', @company.id, y.calendar, 2, @ins_scale)[1]]
                                span#comparative_table_is class=["percent-bdg1-#{y_index}"] = "#{calculate_percentage('income_statement', @company.id, y.calendar, 2, @ins_scale)[0]} %"
                              span.text-table-concept = 'SAT'
                              br
                              span.td-value2 = company_income_stat_value(@company.id, y.calendar, 2, @ins_scale).to_s(:delimited)
                              span.value-scale = @ins_scale

                        td.full-input.total_p2.col-comp
                          div.percentage-badge.blue-badge
                            span.tb-badge1 = "0"
                          span.total_p2 = "0"
                          span.scale2.value-scale = @ins_scale
                      tr.tr-rdata
                        - @calendar_periods_is.each do |y|
                          td.sum_input class="full-input col-#{y.id}"
                            span.text-table-concept = 'CAPTURA'
                            br
                            span.td-value3 = income_calendar_detail_value(@company.id, y.calendar, 2, @ins_scale).to_s(:delimited)
                            span.value-scale = @bs_scale

                        td.full-input.total_p3.col-comp
                          span.total_p3 = "0"
                          span.scale3.value-scale = @ins_scale
                      tr.tr-rdata
                        td style=" font-weight: 800; font-size: 18px" rowspan="2"
                          span.text-left = 'Utilidad Bruta'
                        - @calendar_periods_is.each_with_index do |y, y_index|
                          td.sum_input class="full-input col-#{y.id}"
                            - if y.calendar.period_type == 'anual'
                              div class=['percentage-badge', calculate_percentage('income_statement', @company.id, y.calendar, 3, @ins_scale)[1]]
                                span#comparative_table_is class=["percent-bdg2-#{y_index}"] = "#{calculate_percentage('income_statement', @company.id, y.calendar, 2, @ins_scale)[0]} %"
                              span.text-table-concept = 'SAT'
                              br
                              span.td-value4 = company_income_stat_value(@company.id, y.calendar, 3, @ins_scale).to_s(:delimited)
                              span.value-scale = @ins_scale

                        td.full-input.total_p4.col-comp
                          div.percentage-badge.blue-badge
                            span.tb-badge2 = "0"
                          span.total_p4 = "0"
                          span.scale4.value-scale = @ins_scale
                      tr.tr-rdata
                        - @calendar_periods_is.each do |y|
                          td.sum_input class="full-input col-#{y.id}"
                            span.text-table-concept = 'CAPTURA'
                            br
                            span.td-value5 = income_calendar_detail_value(@company.id, y.calendar, 3, @ins_scale).to_s(:delimited)
                            span.value-scale = @ins_scale

                        td.full-input.total_p5.col-comp
                          span.total_p5 = "0"
                          span.scale5.value-scale = @ins_scale
                      tr.tr-rdata
                        td style=" font-weight: 800; font-size: 18px" rowspan="2"
                          span.text-left = 'Gastos de operación'
                        - @calendar_periods_is.each_with_index do |y, y_index|
                          td.sum_input class="full-input col-#{y.id}"
                            - if y.calendar.period_type == 'anual'
                              div class=['percentage-badge', calculate_percentage('income_statement', @company.id, y.calendar, 4, @ins_scale)[1]]
                                span#comparative_table_is class=["percent-bdg3-#{y_index}"] = "#{calculate_percentage('income_statement', @company.id, y.calendar, 4, @ins_scale)[0]} %"
                              span.text-table-concept = 'SAT'
                              br
                              span.td-value6 = company_income_stat_value(@company.id, y.calendar, 4, @ins_scale).to_s(:delimited)
                              span.value-scale = @ins_scale

                        td.full-input.total_p6.col-comp
                          div.percentage-badge.blue-badge
                            span.tb-badge3 = "0"
                          span.total_p6 = "0"
                          span.scale6.value-scale = @ins_scale
                      tr.tr-rdata
                        - @calendar_periods_is.each do |y|
                          td.sum_input class="full-input col-#{y.id}"
                            span.text-table-concept = 'CAPTURA'
                            br
                            span.td-value7 = income_calendar_detail_value(@company.id, y.calendar, 4, @ins_scale).to_s(:delimited)
                            span.value-scale = @ins_scale

                        td.full-input.total_p7.col-comp
                          span.total_p7 = "0"
                          span.scale7.value-scale = @ins_scale
                      tr.tr-rdata
                        td style=" font-weight: 800; font-size: 18px" rowspan="2"
                          span.text-left = 'Utilidad de operación'
                        - @calendar_periods_is.each_with_index do |y, y_index|
                          td.sum_input class="full-input col-#{y.id}"
                            - if y.calendar.period_type == 'anual'
                              div class=['percentage-badge', calculate_percentage('income_statement', @company.id, y.calendar, 5, @ins_scale)[1]]
                                span#comparative_table_is class=["percent-bdg4-#{y_index}"] = "#{calculate_percentage('income_statement', @company.id, y.calendar, 5, @ins_scale)[0]} %"
                              span.text-table-concept = 'SAT'
                              br
                              span.td-value8 = company_income_stat_value(@company.id, y.calendar, 5, @ins_scale).to_s(:delimited)
                              span.value-scale = @ins_scale

                        td.full-input.total_p8.col-comp
                          div.percentage-badge.blue-badge
                            span.tb-badge4 = "0"
                          span.total_p8 = "0"
                          span.scale8.value-scale = @ins_scale
                      tr.tr-rdata
                        - @calendar_periods_is.each do |y|
                          td.sum_input class="full-input col-#{y.id}"
                            span.text-table-concept = 'CAPTURA'
                            br
                            span.td-value9 = income_calendar_detail_value(@company.id, y.calendar, 5, @ins_scale).to_s(:delimited)
                            span.value-scale = @ins_scale

                        td.full-input.total_p9.col-comp
                          span.total_p9 = "0"
                          span.scale9.value-scale = @ins_scale
                      tr.tr-rdata
                        td style=" font-weight: 800; font-size: 18px" rowspan="2"
                          span.text-left = 'Resultado integral de financiamiento'
                        - @calendar_periods_is.each_with_index do |y, y_index|
                          td.sum_input class="full-input col-#{y.id}"
                            - if y.calendar.period_type == 'anual'
                              div class=['percentage-badge', calculate_percentage('income_statement', @company.id, y.calendar, 6, @ins_scale)[1]]
                                span#comparative_table_is class=["percent-bdg5-#{y_index}"] = "#{calculate_percentage('income_statement', @company.id, y.calendar, 6, @ins_scale)[0]} %"
                              span.text-table-concept = 'SAT'
                              br
                              span.td-value10 = company_income_stat_value(@company.id, y.calendar, 6, @ins_scale).to_s(:delimited)
                              span.value-scale = @ins_scale

                        td.full-input.total_p10.col-comp
                          div.percentage-badge.blue-badge
                            span.tb-badge5 = "0"
                          span.total_p10 = "0"
                          span.scale10.value-scale = @ins_scale
                      tr.tr-rdata
                        - @calendar_periods_is.each do |y|
                          td.sum_input class="full-input col-#{y.id}"
                            span.text-table-concept = 'CAPTURA'
                            br
                            span.td-value11 = income_calendar_detail_value(@company.id, y.calendar, 6, @ins_scale).to_s(:delimited)
                            span.value-scale = @ins_scale

                        td.full-input.total_p11.col-comp
                          span.total_p11 = "0"
                          span.scale11.value-scale = @ins_scale
                      tr.tr-rdata
                        td style=" font-weight: 800; font-size: 18px" rowspan="2"
                          span.text-left = 'Gasto financiero'
                        - @calendar_periods_is.each_with_index do |y, y_index|
                          td.sum_input class="full-input col-#{y.id}"
                            - if y.calendar.period_type == 'anual'
                              div class=['percentage-badge', calculate_percentage('income_statement', @company.id, y.calendar, 7, @ins_scale)[1]]
                                span#comparative_table_is class=["percent-bdg6-#{y_index}"] = "#{calculate_percentage('income_statement', @company.id, y.calendar, 7, @ins_scale)[0]} %"
                              span.text-table-concept = 'SAT'
                              br
                              span.td-value12 = company_income_stat_value(@company.id, y.calendar, 7, @ins_scale).to_s(:delimited)
                              span.value-scale = @ins_scale

                        td.full-input.total_p12.col-comp
                          div.percentage-badge.blue-badge
                            span.tb-badge6 = "0"
                          span.total_p12 = "0"
                          span.scale12.value-scale = @ins_scale
                      tr.tr-rdata
                        - @calendar_periods_is.each do |y|
                          td.sum_input class="full-input col-#{y.id}"
                            span.text-table-concept = 'CAPTURA'
                            br
                            span.td-value13 = income_calendar_detail_value(@company.id, y.calendar, 7, @ins_scale).to_s(:delimited)
                            span.value-scale = @ins_scale

                        td.full-input.total_p13.col-comp
                          span.total_p13 = "0"
                          span.scale13.value-scale = @ins_scale
                      tr.tr-rdata
                        td style=" font-weight: 800; font-size: 18px" rowspan="2"
                          span.text-left = 'Utilidad o pérdida cambiaria'
                        - @calendar_periods_is.each_with_index do |y, y_index|
                          td.sum_input class="full-input col-#{y.id}"
                            - if y.calendar.period_type == 'anual'
                              div class=['percentage-badge', calculate_percentage('income_statement', @company.id, y.calendar, 8, @ins_scale)[1]]
                                span#comparative_table_is class=["percent-bdg7-#{y_index}"] = "#{calculate_percentage('income_statement', @company.id, y.calendar, 8, @ins_scale)[0]} %"
                              span.text-table-concept = 'SAT'
                              br
                              span.td-value14 = company_income_stat_value(@company.id, y.calendar, 8, @ins_scale).to_s(:delimited)
                              span.value-scale = @ins_scale

                        td.full-input.total_p14.col-comp
                          div.percentage-badge.blue-badge
                            span.tb-badge7 = "0"
                          span.total_p14 = "0"
                          span.scale14.value-scale = @ins_scale
                      tr.tr-rdata
                        - @calendar_periods_is.each do |y|
                          td.sum_input class="full-input col-#{y.id}"
                            span.text-table-concept = 'CAPTURA'
                            br
                            span.td-value15 = income_calendar_detail_value(@company.id, y.calendar, 8, @ins_scale).to_s(:delimited)
                            span.value-scale = @ins_scale

                        td.full-input.total_p15.col-comp
                          span.total_p15 = "0"
                          span.scale15.value-scale = @ins_scale
                      tr.tr-rdata
                        td style=" font-weight: 800; font-size: 18px" rowspan="2"
                          span.text-left = 'Otros gastos/ingresos'
                        - @calendar_periods_is.each_with_index do |y, y_index|
                          td.sum_input class="full-input col-#{y.id}"
                            - if y.calendar.period_type == 'anual'
                              div class=['percentage-badge', calculate_percentage('income_statement', @company.id, y.calendar, 9, @ins_scale)[1]]
                                span#comparative_table_is class=["percent-bdg8-#{y_index}"] = "#{calculate_percentage('income_statement', @company.id, y.calendar, 9, @ins_scale)[0]} %"
                              span.text-table-concept = 'SAT'
                              br
                              span.td-value16 = company_income_stat_value(@company.id, y.calendar, 9, @ins_scale).to_s(:delimited)
                              span.value-scale = @ins_scale

                        td.full-input.total_p16.col-comp
                          div.percentage-badge.blue-badge
                            span.tb-badge8 = "0"
                          span.total_p16 = "0"
                          span.scale16.value-scale = @ins_scale
                      tr.tr-rdata
                        - @calendar_periods_is.each do |y|
                          td.sum_input class="full-input col-#{y.id}"
                            span.text-table-concept = 'CAPTURA'
                            br
                            span.td-value17 = income_calendar_detail_value(@company.id, y.calendar, 9, @ins_scale).to_s(:delimited)
                            span.value-scale = @ins_scale

                        td.full-input.total_p17.col-comp
                          span.total_p17 = "0"
                          span.scale17.value-scale = @ins_scale
                      tr.tr-rdata
                        td style=" font-weight: 800; font-size: 18px" rowspan="2"
                          span.text-left = 'Utilidad antes de impuestos'
                        - @calendar_periods_is.each_with_index do |y, y_index|
                          td.sum_input class="full-input col-#{y.id}"
                            - if y.calendar.period_type == 'anual'
                              div class=['percentage-badge', calculate_percentage('income_statement', @company.id, y.calendar, 10, @ins_scale)[1]]
                                span#comparative_table_is class=["percent-bdg9-#{y_index}"] = "#{calculate_percentage('income_statement', @company.id, y.calendar, 10, @ins_scale)[0]} %"
                              span.text-table-concept = 'SAT'
                              br
                              span.td-value18 = company_income_stat_value(@company.id, y.calendar, 10, @ins_scale).to_s(:delimited)
                              span.value-scale = @ins_scale

                        td.full-input.total_p18.col-comp
                          div.percentage-badge.blue-badge
                            span.tb-badge9 = "0"
                          span.total_p18 = "0"
                          span.scale18.value-scale = @bs_scale
                      tr.tr-rdata
                        - @calendar_periods_is.each do |y|
                          td.sum_input class="full-input col-#{y.id}"
                            span.text-table-concept = 'CAPTURA'
                            br
                            span.td-value19 = income_calendar_detail_value(@company.id, y.calendar, 10, @ins_scale).to_s(:delimited)
                            span.value-scale = @ins_scale

                        td.full-input.total_p19.col-comp
                          span.total_p19 = "0"
                          span.scale19.value-scale = @ins_scale
                      tr.tr-rdata
                        td style=" font-weight: 800; font-size: 18px" rowspan="2"
                          span.text-left = 'ISR'
                        - @calendar_periods_is.each_with_index do |y, y_index|
                          td.sum_input class="full-input col-#{y.id}"
                            - if y.calendar.period_type == 'anual'
                              div class=['percentage-badge', calculate_percentage('income_statement', @company.id, y.calendar, 11, @ins_scale)[1]]
                                span#comparative_table_is class=["percent-bdg10-#{y_index}"] = "#{calculate_percentage('income_statement', @company.id, y.calendar, 11, @ins_scale)[0]} %"
                              span.text-table-concept = 'SAT'
                              br
                              span.td-value20 = company_income_stat_value(@company.id, y.calendar, 11, @ins_scale).to_s(:delimited)
                              span.value-scale = @ins_scale

                        td.full-input.total_p20.col-comp
                          div.percentage-badge.blue-badge
                            span.tb-badge10 = "0"
                          span.total_p20 = "0"
                          span.scale20.value-scale = @ins_scale
                      tr.tr-rdata
                        - @calendar_periods_is.each do |y|
                          td.sum_input class="full-input col-#{y.id}"
                            span.text-table-concept = 'CAPTURA'
                            br
                            span.td-value21 = income_calendar_detail_value(@company.id, y.calendar, 11, @ins_scale).to_s(:delimited)
                            span.value-scale = @ins_scale

                        td.full-input.total_p21.col-comp
                          span.total_p21 = "0"
                          span.scale21.value-scale = @ins_scale
                      tr.tr-rdata
                        td style=" font-weight: 800; font-size: 18px" rowspan="2"
                          span.text-left = 'PTU'
                        - @calendar_periods_is.each_with_index do |y, y_index|
                          td.sum_input class="full-input col-#{y.id}"
                            - if y.calendar.period_type == 'anual'
                              div class=['percentage-badge', calculate_percentage('income_statement', @company.id, y.calendar, 12, @ins_scale)[1]]
                                span#comparative_table_is class=["percent-bdg11-#{y_index}"] = "#{calculate_percentage('income_statement', @company.id, y.calendar, 12, @ins_scale)[0]} %"
                              span.text-table-concept = 'SAT'
                              br
                              span.td-value22 = company_income_stat_value(@company.id, y.calendar, 12, @ins_scale).to_s(:delimited)
                              span.value-scale = @ins_scale

                        td.full-input.total_p22.col-comp
                          div.percentage-badge.blue-badge
                            span.tb-badge11 = "0"
                          span.total_p22 = "0"
                          span.scale22.value-scale = @ins_scale
                      tr.tr-rdata
                        - @calendar_periods_is.each do |y|
                          td.sum_input class="full-input col-#{y.id}"
                            span.text-table-concept = 'CAPTURA'
                            br
                            span.td-value23 = income_calendar_detail_value(@company.id, y.calendar, 12, @ins_scale).to_s(:delimited)
                            span.value-scale = @ins_scale

                        td.full-input.total_p23.col-comp
                          span.total_p23 = "0"
                          span.scale23.value-scale = @ins_scale
                      tr.tr-rdata
                        td style=" font-weight: 800; font-size: 18px" rowspan="2"
                          span.text-left = 'Participación subsidiarios'
                        - @calendar_periods_is.each_with_index do |y, y_index|
                          td.sum_input class="full-input col-#{y.id}"
                            - if y.calendar.period_type == 'anual'
                              div class=['percentage-badge', calculate_percentage('income_statement', @company.id, y.calendar, 13, @ins_scale)[1]]
                                span#comparative_table_is class=["percent-bdg12-#{y_index}"] = "#{calculate_percentage('income_statement', @company.id, y.calendar, 13, @ins_scale)[0]} %"
                              span.text-table-concept = 'SAT'
                              br
                              span.td-value24 = company_income_stat_value(@company.id, y.calendar, 13, @ins_scale).to_s(:delimited)
                              span.value-scale = @ins_scale

                        td.full-input.total_p24.col-comp
                          div.percentage-badge.blue-badge
                            span.tb-badge12 = "0"
                          span.total_p24 = "0"
                          span.scale24.value-scale = @ins_scale
                      tr.tr-rdata
                        - @calendar_periods_is.each do |y|
                          td.sum_input class="full-input col-#{y.id}"
                            span.text-table-concept = 'CAPTURA'
                            br
                            span.td-value25 = income_calendar_detail_value(@company.id, y.calendar, 13, @ins_scale).to_s(:delimited)
                            span.value-scale = @ins_scale

                        td.full-input.total_p25.col-comp
                          span.total_p25 = "0"
                          span.scale25.value-scale = @ins_scale
                      tr.tr-rdata
                        td style=" font-weight: 800; font-size: 18px" rowspan="2"
                          // 14: UTILIDAD NETA
                          span.text-left = 'Utilidad neta'
                        - @calendar_periods_is.each_with_index do |y, y_index|
                          td.sum_input class="full-input col-#{y.id}"
                            - if y.calendar.period_type == 'anual'
                              div class=['percentage-badge', calculate_percentage('income_statement', @company.id, y.calendar, 14, @ins_scale)[1]]
                                span#comparative_table_is class=["percent-bdg13-#{y_index}"] = "#{calculate_percentage('income_statement', @company.id, y.calendar, 14, @ins_scale)[0]} %"
                              span.text-table-concept = 'SAT'
                              br
                              span.td-value26 = company_income_stat_value(@company.id, y.calendar, 14, @ins_scale).to_s(:delimited)
                              span.value-scale = @ins_scale

                        td.full-input.total_p26.col-comp
                          div.percentage-badge.blue-badge
                            span.tb-badge13 = "0"
                          span.total_p26 = "0"
                          span.scale26.value-scale = @ins_scale
                      tr.tr-rdata
                        - @calendar_periods_is.each do |y|
                          td.sum_input class="full-input col-#{y.id}"
                            span.text-table-concept = 'CAPTURA'
                            br
                            span.td-value27 = income_calendar_detail_value(@company.id, y.calendar, 14, @ins_scale).to_s(:delimited)
                            span.value-scale = @ins_scale

                        td.full-input.total_p27.col-comp
                          span.total_p27 = "0"
                          span.scale27.value-scale = @ins_scale
                  - else
                    .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                      .m-alert__icon
                        i.flaticon-exclamation-1
                        span
                      .m-alert__text
                        strong
                          | Aún no se le han asignado fechas para captura.




                  .col-md-12.mt-30
                    .btns-card.full-h
                      .subtitle-icon.d-flex.justify-content-center.align-items-center
                        i.fa.fa-comment.fa-lg.m--font-primary
                      .d-flex.flex-column.justify-content-between
                        h5.h5.subtitle = 'Comentarios'
                        .max-h-card.m-widget3
                          - if @is_comments.length > 0
                            - @is_comments.each do |comment|
                              .m-widget3__item
                                .m-widget3__header
                                  .m-widget3__info
                                    span.m-widget3__username
                                      = User.where(id: comment.user_id).try(:first).full_name
                                    /br
                                    /span.m--font-primary
                                                          = "#{comment.process_status.name}"
                                    br
                                    span.m-widget3__time
                                      = comment.created_at.strftime('%d/%m/%Y,  %I:%M%p')

                                .m-widget3__body
                                  p.m-widget3__text
                                    = comment.comment
                          - else
                            .m-widget3__item
                              .m-widget3__body
                                p.m-widget3__text
                                  .text-center
                                    | Aún no hay comentarios.

      .row
        .col-xl-12
          .h4 Balance General
          .col-xl-12
            .m-portlet
              .m-portlet__body
                .m-section.mb-0
                  - if @company.company_calendar_details.where(assign_to: 'balance_sheet').present?
                    table.table.table-bordered.input-focusable-table#comparative_table_bs
                      tr.tr-title
                        th
                        - @calendar_periods_bs.each do |y|
                          th.th-title id="col-#{y.id}_head"
                            = y.calendar.period_name
                        th id="col-comp_head_comparative_table_bs"
                          = 'COMPARACIÓN (ANUAL)'
                      tr
                        td.concept-header style=" font-weight: 800; font-size: 16px;" rowspan="2"
                          span.text-left = 'Activo circulante'
                        - @calendar_periods_bs.each_with_index do |y, y_index|
                          td.concept-header class="full-input col-#{y.id}"
                            - if y.calendar.period_type == 'anual'
                              span = 'SUM. SAT'
                              br
                              span = company_balance_sheet_value(@company.id, y.calendar, ['1', '2', '3', '4'], @bs_scale).to_s(:delimited)
                              span.value-scale = @bs_scale
                        td.concept-header.col-comp
                      tr
                        - @calendar_periods_bs.each do |y|
                          td.concept-header class="full-input col-#{y.id}"
                            span = 'SUM. CAPTURA'
                            br
                            span = bs_capture_sum(@company.id, ['1', '2', '3', '4'], y.calendar.id, @bs_scale).to_s(:delimited)
                            span.value-scale = @bs_scale
                        td.concept-header.col-comp
                      tr.tr-rdata
                        td style="font-weight: 600" rowspan="2"
                          span.text-left = 'Caja / Inversiones'
                        - @calendar_periods_bs.each_with_index do |y, y_index|
                          td.sum_input.sat_value class="full-input col-#{y.id}"
                            - if y.calendar.period_type == 'anual'
                              div class=['percentage-badge', calculate_percentage('balance_sheet', @company.id, y.calendar, 1, @bs_scale)[1]]
                                span#comparative_table_bs class=["percent-bdg0-#{y_index}"] = "#{calculate_percentage('balance_sheet', @company.id, y.calendar, 1, @bs_scale)[0]} %"
                              span.text-table-concept = 'SAT'
                              br
                              span.td-value0 = company_balance_sheet_value(@company.id, y.calendar, 1, @bs_scale).to_s(:delimited)
                              span.value-scale = @bs_scale
                              span.float-percent.percent-value0 = "#{calculate_percent_of_total(company_balance_sheet_value(@company.id, y.calendar, 1, @bs_scale), company_balance_sheet_value(@company.id, y.calendar, ['1', '2', '3', '4'], @bs_scale))} %"
                        td.full-input.total_p0.col-comp
                          div.percentage-badge.blue-badge
                            span.tb-badge0 = "0"
                          span.total_p0 = "0"
                          span.scale0.value-scale = @bs_scale
                          span.float-percent.percent_t0 = "0 %"
                      tr.tr-rdata
                        - @calendar_periods_bs.each do |y|
                          td.sum_input class="full-input col-#{y.id}"
                            span.text-table-concept = 'CAPTURA'
                            br
                            span.td-value1 = balance_calendar_detail_value(@company.id, y.calendar, 1, @bs_scale).to_s(:delimited)
                            span.value-scale = @bs_scale
                            span.float-percent.percent-value1 = "#{calculate_percent_of_total(balance_calendar_detail_value(@company.id, y.calendar, 1, @bs_scale), bs_capture_sum(@company.id, ['1', '2', '3', '4'], y.calendar.id, @bs_scale))} %"
                        td.full-input.total_p1.col-comp
                          span.total_p1 = "0"
                          span.scale1.value-scale = @bs_scale
                          span.float-percent.percent_t1 = "0 %"
                      tr.tr-rdata
                        td style="font-weight: 600" rowspan="2"
                          span.text-left = 'Clientes'
                        - @calendar_periods_bs.each_with_index do |y, y_index|
                          td.sum_input class="full-input col-#{y.id}"
                            - if y.calendar.period_type == 'anual'
                              div class=['percentage-badge', calculate_percentage('balance_sheet', @company.id, y.calendar, 2, @bs_scale)[1]]
                                span#comparative_table_bs class=["percent-bdg1-#{y_index}"] = "#{calculate_percentage('balance_sheet', @company.id, y.calendar, 2, @bs_scale)[0]} %"
                              span.text-table-concept = 'SAT'
                              br
                              span.td-value2 = company_balance_sheet_value(@company.id, y.calendar, 2, @bs_scale).to_s(:delimited)
                              span.value-scale = @bs_scale
                              span.float-percent.percent-value2 = "#{calculate_percent_of_total(company_balance_sheet_value(@company.id, y.calendar, 2, @bs_scale), company_balance_sheet_value(@company.id, y.calendar, ['1', '2', '3', '4'], @bs_scale))} %"
                        td.full-input.total_p2.col-comp
                          div.percentage-badge.blue-badge
                            span.tb-badge1 = "0"
                          span.total_p2 = "0"
                          span.scale2.value-scale = @bs_scale
                          span.float-percent.percent_t2 = "0 %"
                      tr.tr-rdata
                        - @calendar_periods_bs.each do |y|
                          td.sum_input class="full-input col-#{y.id}"
                            span.text-table-concept = 'CAPTURA'
                            br
                            span.td-value3 = balance_calendar_detail_value(@company.id, y.calendar, 2, @bs_scale).to_s(:delimited)
                            span.value-scale = @bs_scale
                            span.float-percent.percent-value3 = "#{calculate_percent_of_total(balance_calendar_detail_value(@company.id, y.calendar, 2, @bs_scale), bs_capture_sum(@company.id, ['1', '2', '3', '4'], y.calendar.id, @bs_scale))} %"
                        td.full-input.total_p3.col-comp
                          span.total_p3 = "0"
                          span.scale3.value-scale = @bs_scale
                          span.float-percent.percent_t3 = "0 %"
                      tr.tr-rdata
                        td style="font-weight: 600" rowspan="2"
                          span.text-left = 'Inventarios'
                        - @calendar_periods_bs.each_with_index do |y, y_index|
                          td.sum_input class="full-input col-#{y.id}"
                            - if y.calendar.period_type == 'anual'
                              div class=['percentage-badge', calculate_percentage('balance_sheet', @company.id, y.calendar, 3, @bs_scale)[1]]
                                span#comparative_table_bs class=["percent-bdg2-#{y_index}"] = "#{calculate_percentage('balance_sheet', @company.id, y.calendar, 3, @bs_scale)[0]} %"
                              span.text-table-concept = 'SAT'
                              br
                              span.td-value4 = company_balance_sheet_value(@company.id, y.calendar, 3, @bs_scale).to_s(:delimited)
                              span.value-scale = @bs_scale
                              span.float-percent.percent-value4 = "#{calculate_percent_of_total(company_balance_sheet_value(@company.id, y.calendar, 3, @bs_scale), company_balance_sheet_value(@company.id, y.calendar, ['1', '2', '3', '4'], @bs_scale))} %"
                        td.full-input.total_p4.col-comp
                          div.percentage-badge.blue-badge
                            span.tb-badge2 = "0"
                          span.total_p4 = "0"
                          span.scale4.value-scale = @bs_scale
                          span.float-percent.percent_t4 = "0 %"
                      tr.tr-rdata
                        - @calendar_periods_bs.each do |y|
                          td.sum_input class="full-input col-#{y.id}"
                            span.text-table-concept = 'CAPTURA'
                            br
                            span.td-value5 = balance_calendar_detail_value(@company.id, y.calendar, 3, @bs_scale).to_s(:delimited)
                            span.value-scale = @bs_scale
                            span.float-percent.percent-value6 = "#{calculate_percent_of_total(balance_calendar_detail_value(@company.id, y.calendar, 3, @bs_scale), bs_capture_sum(@company.id, ['1', '2', '3', '4'], y.calendar.id, @bs_scale))} %"
                        td.full-input.total_p5.col-comp
                          span.total_p5 = "0"
                          span.scale5.value-scale = @bs_scale
                          span.float-percent.percent_t5 = "0 %"
                      tr.tr-rdata
                        td style="font-weight: 600" rowspan="2"
                          span.text-left = 'Otros activos circulantes'
                        - @calendar_periods_bs.each_with_index do |y, y_index|
                          td.sum_input class="full-input col-#{y.id}"
                            - if y.calendar.period_type == 'anual'
                              div class=['percentage-badge', calculate_percentage('balance_sheet', @company.id, y.calendar, 4, @bs_scale)[1]]
                                span#comparative_table_bs class=["percent-bdg3-#{y_index}"] = "#{calculate_percentage('balance_sheet', @company.id, y.calendar, 4, @bs_scale)[0]} %"
                              span.text-table-concept = 'SAT'
                              br
                              span.td-value6 = company_balance_sheet_value(@company.id, y.calendar, 4, @bs_scale).to_s(:delimited)
                              span.value-scale = @bs_scale
                              span.float-percent.percent-value6 = "#{calculate_percent_of_total(company_balance_sheet_value(@company.id, y.calendar, 4, @bs_scale), company_balance_sheet_value(@company.id, y.calendar, ['1', '2', '3', '4'], @bs_scale))} %"
                        td.full-input.total_p6.col-comp
                          div.percentage-badge.blue-badge
                            span.tb-badge3 = "0"
                          span.total_p6 = "0"
                          span.scale6.value-scale = @bs_scale
                          span.float-percent.percent_t6 = "0 %"
                      tr.tr-rdata
                        - @calendar_periods_bs.each do |y|
                          td.sum_input class="full-input col-#{y.id}"
                            span.text-table-concept = 'CAPTURA'
                            br
                            span.td-value7 = balance_calendar_detail_value(@company.id, y.calendar, 4, @bs_scale).to_s(:delimited)
                            span.value-scale = @bs_scale
                            span.float-percent.percent-value7 = "#{calculate_percent_of_total(balance_calendar_detail_value(@company.id, y.calendar, 4, @bs_scale), bs_capture_sum(@company.id, ['1', '2', '3', '4'], y.calendar.id, @bs_scale))} %"
                        td.full-input.total_p7.col-comp
                          span.total_p7 = "0"
                          span.scale7.value-scale = @bs_scale
                          span.float-percent.percent_t7 = "0 %"

                      tr
                        td.concept-header style=" font-weight: 800; font-size: 18px" rowspan="2"
                          span.text-left = 'Activo fijo'
                        - @calendar_periods_bs.each do |y|
                          td.concept-header class="full-input col-#{y.id}"
                            - if y.calendar.period_type == 'anual'
                              span = 'SUM. SAT'
                              br
                              span = bs_activo_fijo_sat(@company.id, ['5', '6', '8', '9'], y.calendar, @bs_scale).to_s(:delimited)
                              span.value-scale = @bs_scale
                        td.concept-header.col-comp
                      tr
                        - @calendar_periods_bs.each do |y|
                          td.concept-header class="full-input col-#{y.id}"
                            span = 'SUM. CAPTURA'
                            br
                            span = bs_activo_fijo(@company.id, ['5', '6', '8', '9'], y.calendar.id, @bs_scale).to_s(:delimited)
                            span.value-scale = @bs_scale
                        td.concept-header.col-comp
                      tr.tr-rdata
                        td style="font-weight: 600" rowspan="2"
                          span.text-left = 'Terrenos y Construcciones'
                        - @calendar_periods_bs.each_with_index do |y, y_index|
                          td.sum_input class="full-input col-#{y.id}"
                            - if y.calendar.period_type == 'anual'
                              div class=['percentage-badge', calculate_percentage('balance_sheet', @company.id, y.calendar, 5, @bs_scale)[1]]
                                span#comparative_table_bs class=["percent-bdg4-#{y_index}"] = "#{calculate_percentage('balance_sheet', @company.id, y.calendar, 5, @bs_scale)[0]} %"
                              span.text-table-concept = 'SAT'
                              br
                              span.td-value8 = company_balance_sheet_value(@company.id, y.calendar, 5, @bs_scale).to_s(:delimited)
                              span.value-scale = @bs_scale
                              span.float-percent.percent-value8 = "#{calculate_percent_of_total(company_balance_sheet_value(@company.id, y.calendar, 5, @bs_scale), company_balance_sheet_value(@company.id, y.calendar, ['5', '6', '7', '8', '9'], @bs_scale))} %"
                        td.full-input.total_p8.col-comp
                          div.percentage-badge.blue-badge
                            span.tb-badge4 = "0"
                          span.total_p8 = "0"
                          span.scale8.value-scale = @bs_scale
                          span.float-percent.percent_t8 = "0 %"
                      tr.tr-rdata
                        - @calendar_periods_bs.each do |y|
                          td.sum_input class="full-input col-#{y.id}"
                            span.text-table-concept = 'CAPTURA'
                            br
                            span.td-value9 = balance_calendar_detail_value(@company.id, y.calendar, 5, @bs_scale).to_s(:delimited)
                            span.value-scale = @bs_scale
                            span.float-percent.percent-value9 = "#{calculate_percent_of_total(balance_calendar_detail_value(@company.id, y.calendar, 5, @bs_scale), bs_capture_sum(@company.id, ['5', '6', '7', '8', '9'], y.calendar.id, @bs_scale))} %"
                        td.full-input.total_p9.col-comp
                          span.total_p9 = "0"
                          span.scale9.value-scale = @bs_scale
                          span.float-percent.percent_t9 = "0 %"
                      tr.tr-rdata
                        td style="font-weight: 600" rowspan="2"
                          span.text-left = 'Maquinaria y equipo'
                        - @calendar_periods_bs.each_with_index do |y, y_index|
                          td.sum_input class="full-input col-#{y.id}"
                            - if y.calendar.period_type == 'anual'
                              div class=['percentage-badge', calculate_percentage('balance_sheet', @company.id, y.calendar, 6, @bs_scale)[1]]
                                span#comparative_table_bs class=["percent-bdg5-#{y_index}"] = "#{calculate_percentage('balance_sheet', @company.id, y.calendar, 6, @bs_scale)[0]} %"
                              span.text-table-concept = 'SAT'
                              br
                              span.td-value10 = company_balance_sheet_value(@company.id, y.calendar, 6, @bs_scale).to_s(:delimited)
                              span.value-scale = @bs_scale
                              span.float-percent.percent-value10 = "#{calculate_percent_of_total(company_balance_sheet_value(@company.id, y.calendar, 6, @bs_scale), company_balance_sheet_value(@company.id, y.calendar, ['5', '6', '7', '8', '9'], @bs_scale))} %"
                        td.full-input.total_p10.col-comp
                          div.percentage-badge.blue-badge
                            span.tb-badge5 = "0"
                          span.total_p10 = "0"
                          span.scale10.value-scale = @bs_scale
                          span.float-percent.percent_t10 = "0 %"
                      tr.tr-rdata
                        - @calendar_periods_bs.each do |y|
                          td.sum_input class="full-input col-#{y.id}"
                            span.text-table-concept = 'CAPTURA'
                            br
                            span.td-value11 = balance_calendar_detail_value(@company.id, y.calendar, 6, @bs_scale).to_s(:delimited)
                            span.value-scale = @bs_scale
                            span.float-percent.percent-value11 = "#{calculate_percent_of_total(balance_calendar_detail_value(@company.id, y.calendar, 6, @bs_scale), bs_capture_sum(@company.id, ['5', '6', '7', '8', '9'], y.calendar.id, @bs_scale))} %"
                        td.full-input.total_p11.col-comp
                          span.total_p11 = "0"
                          span.scale11.value-scale = @bs_scale
                          span.float-percent.percent_t11 = "0 %"
                      tr.tr-rdata
                        td style="font-weight: 600" rowspan="2"
                          span.text-left = 'Depreciación acumulada'
                        - @calendar_periods_bs.each_with_index do |y, y_index|
                          td.sum_input class="full-input col-#{y.id}"
                            - if y.calendar.period_type == 'anual'
                              div class=['percentage-badge', calculate_percentage('balance_sheet', @company.id, y.calendar, 7, @bs_scale)[1]]
                                span#comparative_table_bs class=["percent-bdg6-#{y_index}"] = "#{calculate_percentage('balance_sheet', @company.id, y.calendar, 7, @bs_scale)[0]} %"
                              span.text-table-concept = 'SAT'
                              br
                              span.td-value12 = company_balance_sheet_value(@company.id, y.calendar, 7, @bs_scale).to_s(:delimited)
                              span.value-scale = @bs_scale
                              span.float-percent.percent-value12 = "#{calculate_percent_of_total(company_balance_sheet_value(@company.id, y.calendar, 7, @bs_scale), company_balance_sheet_value(@company.id, y.calendar, ['5', '6', '7', '8', '9'], @bs_scale))} %"
                        td.full-input.total_p12.col-comp
                          div.percentage-badge.blue-badge
                            span.tb-badge6 = "0"
                          span.total_p12 = "0"
                          span.scale12.value-scale = @bs_scale
                          span.float-percent.percent_t12 = "0 %"
                      tr.tr-rdata
                        - @calendar_periods_bs.each do |y|
                          td.sum_input class="full-input col-#{y.id}"
                            span.text-table-concept = 'CAPTURA'
                            br
                            span.td-value13 = balance_calendar_detail_value(@company.id, y.calendar, 7, @bs_scale).to_s(:delimited)
                            span.value-scale = @bs_scale
                            span.float-percent.percent-value13 = "#{calculate_percent_of_total(balance_calendar_detail_value(@company.id, y.calendar, 7, @bs_scale), bs_capture_sum(@company.id, ['5', '6', '7', '8', '9'], y.calendar.id, @bs_scale))} %"
                        td.full-input.total_p13.col-comp
                          span.total_p13 = "0"
                          span.scale13.value-scale = @bs_scale
                          span.float-percent.percent_t13 = "0 %"
                      tr.tr-rdata
                        td style="font-weight: 600" rowspan="2"
                          span.text-left = 'Otros activos fijos'
                        - @calendar_periods_bs.each_with_index do |y, y_index|
                          td.sum_input class="full-input col-#{y.id}"
                            - if y.calendar.period_type == 'anual'
                              div class=['percentage-badge', calculate_percentage('balance_sheet', @company.id, y.calendar, 8, @bs_scale)[1]]
                                span#comparative_table_bs class=["percent-bdg7-#{y_index}"] = "#{calculate_percentage('balance_sheet', @company.id, y.calendar, 8, @bs_scale)[0]} %"
                              span.text-table-concept = 'SAT'
                              br
                              span.td-value14 = company_balance_sheet_value(@company.id, y.calendar, 8, @bs_scale).to_s(:delimited)
                              span.value-scale = @bs_scale
                              span.float-percent.percent-value14 = "#{calculate_percent_of_total(company_balance_sheet_value(@company.id, y.calendar, 8, @bs_scale), company_balance_sheet_value(@company.id, y.calendar, ['5', '6', '7', '8', '9'], @bs_scale))} %"
                        td.full-input.total_p14.col-comp
                          div.percentage-badge.blue-badge
                            span.tb-badge7 = "0"
                          span.total_p14 = "0"
                          span.scale14.value-scale = @bs_scale
                          span.float-percent.percent_t14 = "0 %"
                      tr.tr-rdata
                        - @calendar_periods_bs.each do |y|
                          td.sum_input class="full-input col-#{y.id}"
                            span.text-table-concept = 'CAPTURA'
                            br
                            span.td-value15 = balance_calendar_detail_value(@company.id, y.calendar, 8, @bs_scale).to_s(:delimited)
                            span.value-scale = @bs_scale
                            span.float-percent.percent-value15 = "#{calculate_percent_of_total(balance_calendar_detail_value(@company.id, y.calendar, 8, @bs_scale), bs_capture_sum(@company.id, ['5', '6', '7', '8', '9'], y.calendar.id, @bs_scale))} %"
                        td.full-input.total_p15.col-comp
                          span.total_p15 = "0"
                          span.scale15.value-scale = @bs_scale
                          span.float-percent.percent_t15 = "0 %"
                      tr.tr-rdata
                        td style="font-weight: 600" rowspan="2"
                          span.text-left = 'Cargos y gastos diferidos'
                        - @calendar_periods_bs.each_with_index do |y, y_index|
                          td.sum_input class="full-input col-#{y.id}"
                            - if y.calendar.period_type == 'anual'
                              div class=['percentage-badge', calculate_percentage('balance_sheet', @company.id, y.calendar, 9, @bs_scale)[1]]
                                span#comparative_table_bs class=["percent-bdg8-#{y_index}"] = "#{calculate_percentage('balance_sheet', @company.id, y.calendar, 9, @bs_scale)[0]} %"
                              span.text-table-concept = 'SAT'
                              br
                              span.td-value16 = company_balance_sheet_value(@company.id, y.calendar, 9, @bs_scale).to_s(:delimited)
                              span.value-scale = @bs_scale
                              span.float-percent.percent-value16 = "#{calculate_percent_of_total(company_balance_sheet_value(@company.id, y.calendar, 9, @bs_scale), company_balance_sheet_value(@company.id, y.calendar, ['5', '6', '7', '8', '9'], @bs_scale))} %"
                        td.full-input.total_p16.col-comp
                          div.percentage-badge.blue-badge
                            span.tb-badge8 = "0"
                          span.total_p16 = "0"
                          span.scale16.value-scale = @bs_scale
                          span.float-percent.percent_t16 = "0 %"
                      tr.tr-rdata
                        - @calendar_periods_bs.each do |y|
                          td.sum_input class="full-input col-#{y.id}"
                            span.text-table-concept = 'CAPTURA'
                            br
                            span.td-value17 = balance_calendar_detail_value(@company.id, y.calendar, 9, @bs_scale).to_s(:delimited)
                            span.value-scale = @bs_scale
                            span.float-percent.percent-value17 = "#{calculate_percent_of_total(balance_calendar_detail_value(@company.id, y.calendar, 9, @bs_scale), bs_capture_sum(@company.id, ['5', '6', '7', '8', '9'], y.calendar.id, @bs_scale))} %"
                        td.full-input.total_p17.col-comp
                          span.total_p17 = "0"
                          span.scale17.value-scale = @bs_scale
                          span.float-percent.percent_t17 = "0 %"

                      tr
                        td.concept-header style=" font-weight: 800; font-size: 18px" rowspan="2"
                          span.text-left = 'Pasivo total'
                        - @calendar_periods_bs.each do |y|
                          td.concept-header class="full-input col-#{y.id}"
                            - if y.calendar.period_type == 'anual'
                              span = 'SUM. SAT'
                              br
                              span = company_balance_sheet_value(@company.id, y.calendar, ['10', '11', '12', '13'], @bs_scale).to_s(:delimited)
                              span.value-scale = @bs_scale
                        td.concept-header.col-comp
                      tr
                        - @calendar_periods_bs.each do |y|
                          td.concept-header class="full-input col-#{y.id}"
                            span = 'SUM. CAPTURA'
                            br
                            span = bs_capture_sum(@company.id, ['10', '11', '12', '13'], y.calendar.id, @bs_scale).to_s(:delimited)
                            span.value-scale = @bs_scale
                        td.concept-header.col-comp
                      tr.tr-rdata
                        td style="font-weight: 600" rowspan="2"
                          span.text-left = 'Proveedores'
                        - @calendar_periods_bs.each_with_index do |y, y_index|
                          td.sum_input class="full-input col-#{y.id}"
                            - if y.calendar.period_type == 'anual'
                              div class=['percentage-badge', calculate_percentage('balance_sheet', @company.id, y.calendar, 10, @bs_scale)[1]]
                                span#comparative_table_bs class=["percent-bdg9-#{y_index}"] = "#{calculate_percentage('balance_sheet', @company.id, y.calendar, 10, @bs_scale)[0]} %"
                              span.text-table-concept = 'SAT'
                              br
                              span.td-value18 = company_balance_sheet_value(@company.id, y.calendar, 10, @bs_scale).to_s(:delimited)
                              span.value-scale = @bs_scale
                              span.float-percent.percent-value18 = "#{calculate_percent_of_total(company_balance_sheet_value(@company.id, y.calendar, 10, @bs_scale), company_balance_sheet_value(@company.id, y.calendar, ['10', '11', '12', '13'], @bs_scale))} %"
                        td.full-input.total_p18.col-comp
                          div.percentage-badge.blue-badge
                            span.tb-badge9 = "0"
                          span.total_p18 = "0"
                          span.scale18.value-scale = @bs_scale
                          span.float-percent.percent_t18 = "0 %"
                      tr.tr-rdata
                        - @calendar_periods_bs.each do |y|
                          td.sum_input class="full-input col-#{y.id}"
                            span.text-table-concept = 'CAPTURA'
                            br
                            span.td-value19 = balance_calendar_detail_value(@company.id, y.calendar, 10, @bs_scale).to_s(:delimited)
                            span.value-scale = @bs_scale
                            span.float-percent.percent-value19 = "#{calculate_percent_of_total(balance_calendar_detail_value(@company.id, y.calendar, 10, @bs_scale), bs_capture_sum(@company.id, ['10', '11', '12', '13'], y.calendar.id, @bs_scale))} %"
                        td.full-input.total_p19.col-comp
                          span.total_p19 = "0"
                          span.scale19.value-scale = @bs_scale
                          span.float-percent.percent_t19 = "0 %"
                      tr.tr-rdata
                        td style="font-weight: 600" rowspan="2"
                          span.text-left = 'Contribuciones por pagar'
                        - @calendar_periods_bs.each_with_index do |y, y_index|
                          td.sum_input class="full-input col-#{y.id}"
                            - if y.calendar.period_type == 'anual'
                              div class=['percentage-badge', calculate_percentage('balance_sheet', @company.id, y.calendar, 11, @bs_scale)[1]]
                                span#comparative_table_bs class=["percent-bdg10-#{y_index}"] = "#{calculate_percentage('balance_sheet', @company.id, y.calendar, 11, @bs_scale)[0]} %"
                              span.text-table-concept = 'SAT'
                              br
                              span.td-value20 = company_balance_sheet_value(@company.id, y.calendar, 11, @bs_scale).to_s(:delimited)
                              span.value-scale = @bs_scale
                              span.float-percent.percent-value20 = "#{calculate_percent_of_total(company_balance_sheet_value(@company.id, y.calendar, 11, @bs_scale), company_balance_sheet_value(@company.id, y.calendar, ['10', '11', '12', '13'], @bs_scale))} %"
                        td.full-input.total_p20.col-comp
                          div.percentage-badge.blue-badge
                            span.tb-badge10 = "0"
                          span.total_p20 = "0"
                          span.scale20.value-scale = @bs_scale
                          span.float-percent.percent_t20 = "0 %"
                      tr.tr-rdata
                        - @calendar_periods_bs.each do |y|
                          td.sum_input class="full-input col-#{y.id}"
                            span.text-table-concept = 'CAPTURA'
                            br
                            span.td-value21 = balance_calendar_detail_value(@company.id, y.calendar, 11, @bs_scale).to_s(:delimited)
                            span.value-scale = @bs_scale
                            span.float-percent.percent-value21 = "#{calculate_percent_of_total(balance_calendar_detail_value(@company.id, y.calendar, 11, @bs_scale), bs_capture_sum(@company.id, ['10', '11', '12', '13'], y.calendar.id, @bs_scale))} %"
                        td.full-input.total_p21.col-comp
                          span.total_p21 = "0"
                          span.scale21.value-scale = @bs_scale
                          span.float-percent.percent_t21 = "0 %"
                      tr.tr-rdata
                        td style="font-weight: 600" rowspan="2"
                          span.text-left = 'Anticipo de clientes'
                        - @calendar_periods_bs.each_with_index do |y, y_index|
                          td.sum_input class="full-input col-#{y.id}"
                            - if y.calendar.period_type == 'anual'
                              div class=['percentage-badge', calculate_percentage('balance_sheet', @company.id, y.calendar, 12, @bs_scale)[1]]
                                span#comparative_table_bs class=["percent-bdg11-#{y_index}"] = "#{calculate_percentage('balance_sheet', @company.id, y.calendar, 12, @bs_scale)[0]} %"
                              span.text-table-concept = 'SAT'
                              br
                              span.td-value22 = company_balance_sheet_value(@company.id, y.calendar, 12, @bs_scale).to_s(:delimited)
                              span.value-scale = @bs_scale
                              span.float-percent.percent-value22 = "#{calculate_percent_of_total(company_balance_sheet_value(@company.id, y.calendar, 12, @bs_scale), company_balance_sheet_value(@company.id, y.calendar, ['10', '11', '12', '13'], @bs_scale))} %"
                        td.full-input.total_p22.col-comp
                          div.percentage-badge.blue-badge
                            span.tb-badge11 = "0"
                          span.total_p22 = "0"
                          span.scale22.value-scale = @bs_scale
                          span.float-percent.percent_t22 = "0 %"
                      tr.tr-rdata
                        - @calendar_periods_bs.each do |y|
                          td.sum_input class="full-input col-#{y.id}"
                            span.text-table-concept = 'CAPTURA'
                            br
                            span.td-value23 = balance_calendar_detail_value(@company.id, y.calendar, 12, @bs_scale).to_s(:delimited)
                            span.value-scale = @bs_scale
                            span.float-percent.percent-value23 = "#{calculate_percent_of_total(balance_calendar_detail_value(@company.id, y.calendar, 12, @bs_scale), bs_capture_sum(@company.id, ['10', '11', '12', '13'], y.calendar.id, @bs_scale))} %"
                        td.full-input.total_p23.col-comp
                          span.total_p23 = "0"
                          span.scale23.value-scale = @bs_scale
                          span.float-percent.percent_t23 = "0 %"
                      tr.tr-rdata
                        td style="font-weight: 600" rowspan="2"
                          span.text-left = 'Otros pasivos'
                        - @calendar_periods_bs.each_with_index do |y, y_index|
                          td.sum_input class="full-input col-#{y.id}"
                            - if y.calendar.period_type == 'anual'
                              div class=['percentage-badge', calculate_percentage('balance_sheet', @company.id, y.calendar, 13, @bs_scale)[1]]
                                span#comparative_table_bs class=["percent-bdg12-#{y_index}"] = "#{calculate_percentage('balance_sheet', @company.id, y.calendar, 13, @bs_scale)[0]} %"
                              span.text-table-concept = 'SAT'
                              br
                              span.td-value24 = company_balance_sheet_value(@company.id, y.calendar, 13, @bs_scale).to_s(:delimited)
                              span.value-scale = @bs_scale
                              span.float-percent.percent-value24 = "#{calculate_percent_of_total(company_balance_sheet_value(@company.id, y.calendar, 13, @bs_scale), company_balance_sheet_value(@company.id, y.calendar, ['10', '11', '12', '13'], @bs_scale))} %"
                        td.full-input.total_p24.col-comp
                          div.percentage-badge.blue-badge
                            span.tb-badge12 = "0"
                          span.total_p24 = "0"
                          span.scale24.value-scale = @bs_scale
                          span.float-percent.percent_t24 = "0 %"
                      tr.tr-rdata
                        - @calendar_periods_bs.each do |y|
                          td.sum_input class="full-input col-#{y.id}"
                            span.text-table-concept = 'CAPTURA'
                            br
                            span.td-value25 = balance_calendar_detail_value(@company.id, y.calendar, 13, @bs_scale).to_s(:delimited)
                            span.value-scale = @bs_scale
                            span.float-percent.percent-value25 = "#{calculate_percent_of_total(balance_calendar_detail_value(@company.id, y.calendar, 13, @bs_scale), bs_capture_sum(@company.id, ['10', '11', '12', '13'], y.calendar.id, @bs_scale))} %"
                        td.full-input.total_p25.col-comp
                          span.total_p25 = "0"
                          span.scale25.value-scale = @bs_scale
                          span.float-percent.percent_t25 = "0 %"

                      tr
                        td.concept-header style=" font-weight: 800; font-size: 18px" rowspan="2"
                          span.text-left = 'Capital Total'
                        - @calendar_periods_bs.each do |y|
                          td.concept-header class="full-input col-#{y.id}"
                            - if y.calendar.period_type == 'anual'
                              span = 'SUM. SAT'
                              br
                              span = company_balance_sheet_value(@company.id, y.calendar, ['14', '15', '16', '17'], @bs_scale).to_s(:delimited)
                              span.value-scale = @bs_scale
                        td.concept-header.col-comp
                      tr
                        - @calendar_periods_bs.each do |y|
                          td.concept-header class="full-input col-#{y.id}"
                            span = 'SUM. CAPTURA'
                            br
                            span = bs_capture_sum(@company.id, ['14', '15', '16', '17'], y.calendar.id, @bs_scale).to_s(:delimited)
                            span.value-scale = @bs_scale
                        td.concept-header.col-comp
                      tr.tr-rdata
                        td style="font-weight: 600" rowspan="2"
                          span.text-left = 'Capital social'
                        - @calendar_periods_bs.each_with_index do |y, y_index|
                          td.sum_input class="full-input col-#{y.id}"
                            - if y.calendar.period_type == 'anual'
                              div class=['percentage-badge', calculate_percentage('balance_sheet', @company.id, y.calendar, 14, @bs_scale)[1]]
                                span#comparative_table_bs class=["percent-bdg13-#{y_index}"] = "#{calculate_percentage('balance_sheet', @company.id, y.calendar, 14, @bs_scale)[0]} %"
                              span.text-table-concept = 'SAT'
                              br
                              span.td-value26 = company_balance_sheet_value(@company.id, y.calendar, 14, @bs_scale).to_s(:delimited)
                              span.value-scale = @bs_scale
                              span.float-percent.percent-value26 = "#{calculate_percent_of_total(company_balance_sheet_value(@company.id, y.calendar, 8, @bs_scale), company_balance_sheet_value(@company.id, y.calendar, ['14', '15', '16', '17'], @bs_scale))} %"
                        td.full-input.total_p26.col-comp
                          div.percentage-badge.blue-badge
                            span.tb-badge13 = "0"
                          span.total_p26 = "0"
                          span.scale26.value-scale = @bs_scale
                          span.float-percent.percent_t26 = "0 %"
                      tr.tr-rdata
                        - @calendar_periods_bs.each do |y|
                          td.sum_input class="full-input col-#{y.id}"
                            span.text-table-concept = 'CAPTURA'
                            br
                            span.td-value27 = balance_calendar_detail_value(@company.id, y.calendar, 14, @bs_scale).to_s(:delimited)
                            span.value-scale = @bs_scale
                            span.float-percent.percent-value27 = "#{calculate_percent_of_total(balance_calendar_detail_value(@company.id, y.calendar, 14, @bs_scale), bs_capture_sum(@company.id, ['14', '15', '16', '17'], y.calendar.id, @bs_scale))} %"
                        td.full-input.total_p27.col-comp
                          span.total_p27 = "0"
                          span.scale27.value-scale = @bs_scale
                          span.float-percent.percent_t27 = "0 %"
                      tr.tr-rdata
                        td style="font-weight: 600" rowspan="2"
                          span.text-left = 'Utilidad/Pérdida acumulada'
                        - @calendar_periods_bs.each_with_index do |y, y_index|
                          td.sum_input class="full-input col-#{y.id}"
                            - if y.calendar.period_type == 'anual'
                              div class=['percentage-badge', calculate_percentage('balance_sheet', @company.id, y.calendar, 15, @bs_scale)[1]]
                                span#comparative_table_bs class=["percent-bdg14-#{y_index}"] = "#{calculate_percentage('balance_sheet', @company.id, y.calendar, 15, @bs_scale)[0]} %"
                              span.text-table-concept = 'SAT'
                              br
                              span.td-value28 = company_balance_sheet_value(@company.id, y.calendar, 15, @bs_scale).to_s(:delimited)
                              span.value-scale = @bs_scale
                              span.float-percent.percent-value28 = "#{calculate_percent_of_total(company_balance_sheet_value(@company.id, y.calendar, 15, @bs_scale), company_balance_sheet_value(@company.id, y.calendar, ['14', '15', '16', '17'], @bs_scale))} %"
                        td.full-input.total_p28.col-comp
                          div.percentage-badge.blue-badge
                            span.tb-badge14 = "0"
                          span.total_p28 = "0"
                          span.scale28.value-scale = @bs_scale
                          span.float-percent.percent_t28 = "0 %"
                      tr.tr-rdata
                        - @calendar_periods_bs.each do |y|
                          td.sum_input class="full-input col-#{y.id}"
                            span.text-table-concept = 'CAPTURA'
                            br
                            span.td-value29 = balance_calendar_detail_value(@company.id, y.calendar, 15, @bs_scale).to_s(:delimited)
                            span.value-scale = @bs_scale
                            span.float-percent.percent-value29 = "#{calculate_percent_of_total(balance_calendar_detail_value(@company.id, y.calendar, 15, @bs_scale), bs_capture_sum(@company.id, ['14', '15', '16', '17'], y.calendar.id, @bs_scale))} %"
                        td.full-input.total_p29.col-comp
                          span.total_p29 = "0"
                          span.scale29.value-scale = @bs_scale
                          span.float-percent.percent_t29 = "0 %"
                      tr.tr-rdata
                        td style="font-weight: 600" rowspan="2"
                          span.text-left = 'Utilidad/Pérdida ejercicio'
                        - @calendar_periods_bs.each_with_index do |y, y_index|
                          td.sum_input class="full-input col-#{y.id}"
                            - if y.calendar.period_type == 'anual'
                              div class=['percentage-badge', calculate_percentage('balance_sheet', @company.id, y.calendar, 16, @bs_scale)[1]]
                                span#comparative_table_bs class=["percent-bdg15-#{y_index}"] = "#{calculate_percentage('balance_sheet', @company.id, y.calendar, 16, @bs_scale)[0]} %"
                              span.text-table-concept = 'SAT'
                              br
                              span.td-value30 = company_balance_sheet_value(@company.id, y.calendar, 16, @bs_scale).to_s(:delimited)
                              span.value-scale = @bs_scale
                              span.float-percent.percent-value30 = "#{calculate_percent_of_total(company_balance_sheet_value(@company.id, y.calendar, 16, @bs_scale), company_balance_sheet_value(@company.id, y.calendar, ['14', '15', '16', '17'], @bs_scale))} %"
                        td.full-input.total_p30.col-comp
                          div.percentage-badge.blue-badge
                            span.tb-badge15 = "0"
                          span.total_p30 = "0"
                          span.scale30.value-scale = @bs_scale
                          span.float-percent.percent_t30 = "0 %"
                      tr.tr-rdata
                        - @calendar_periods_bs.each do |y|
                          td.sum_input class="full-input col-#{y.id}"
                            span.text-table-concept = 'CAPTURA'
                            br
                            span.td-value31 = balance_calendar_detail_value(@company.id, y.calendar, 16, @bs_scale).to_s(:delimited)
                            span.value-scale = @bs_scale
                            span.float-percent.percent-value31 = "#{calculate_percent_of_total(balance_calendar_detail_value(@company.id, y.calendar, 16, @bs_scale), bs_capture_sum(@company.id, ['14', '15', '16', '17'], y.calendar.id, @bs_scale))} %"
                        td.full-input.total_p31.col-comp
                          span.total_p31 = "0"
                          span.scale31.value-scale = @bs_scale
                          span.float-percent.percent_t31 = "0 %"
                      tr.tr-rdata
                        td style="font-weight: 600" rowspan="2"
                          span.text-left = 'Otras cuentas de capital'
                        - @calendar_periods_bs.each_with_index do |y, y_index|
                          td.sum_input class="full-input col-#{y.id}"
                            - if y.calendar.period_type == 'anual'
                              div class=['percentage-badge', calculate_percentage('balance_sheet', @company.id, y.calendar, 17, @bs_scale)[1]]
                                span#comparative_table_bs class=["percent-bdg16-#{y_index}"] = "#{calculate_percentage('balance_sheet', @company.id, y.calendar, 17, @bs_scale)[0]} %"
                              span.text-table-concept = 'SAT'
                              br
                              span.td-value32 = company_balance_sheet_value(@company.id, y.calendar, 17, @bs_scale).to_s(:delimited)
                              span.value-scale = @bs_scale
                              span.float-percent.percent-value32 = "#{calculate_percent_of_total(company_balance_sheet_value(@company.id, y.calendar, 17, @bs_scale), company_balance_sheet_value(@company.id, y.calendar, ['14', '15', '16', '17'], @bs_scale))} %"
                        td.full-input.total_p32.col-comp
                          div.percentage-badge.blue-badge
                            span.tb-badge16 = "0"
                          span.total_p32 = "0"
                          span.scale32.value-scale = @bs_scale
                          span.float-percent.percent_t32 = "0 %"
                      tr.tr-rdata
                        - @calendar_periods_bs.each do |y|
                          td.sum_input class="full-input col-#{y.id}"
                            span.text-table-concept = 'CAPTURA'
                            br
                            span.td-value33 = balance_calendar_detail_value(@company.id, y.calendar, 17, @bs_scale).to_s(:delimited)
                            span.value-scale = @bs_scale
                            span.float-percent.percent-value33 = "#{calculate_percent_of_total(balance_calendar_detail_value(@company.id, y.calendar, 17, @bs_scale), bs_capture_sum(@company.id, ['14', '15', '16', '17'], y.calendar.id, @bs_scale))} %"
                        td.full-input.total_p33.col-comp
                          span.total_p33 = "0"
                          span.scale33.value-scale = @bs_scale
                          span.float-percent.percent_t33 = "0 %"
                  - else
                    .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                      .m-alert__icon
                        i.flaticon-exclamation-1
                        span
                      .m-alert__text
                        strong
                          | Aún no se le han asignado fechas para captura.



                  .col-md-12.mt-30
                    .btns-card.full-h
                      .subtitle-icon.d-flex.justify-content-center.align-items-center
                        i.fa.fa-comment.fa-lg.m--font-primary
                      .d-flex.flex-column.justify-content-between
                        h5.h5.subtitle = 'Comentarios'
                        .max-h-card.m-widget3
                          - if @bs_comments.length > 0
                            - @bs_comments.each do |comment|
                              .m-widget3__item
                                .m-widget3__header
                                  .m-widget3__info
                                    span.m-widget3__username
                                      = User.where(id: comment.user_id).try(:first).full_name
                                    /br
                                    /span.m--font-primary
                                                            = "#{comment.process_status.name}"
                                    br
                                    span.m-widget3__time
                                      = comment.created_at.strftime('%d/%m/%Y,  %I:%M%p')

                                .m-widget3__body
                                  p.m-widget3__text
                                    = comment.comment
                          - else
                            .m-widget3__item
                              .m-widget3__body
                                p.m-widget3__text
                                  .text-center
                                    | Aún no hay comentarios.

      .row
        .col-xl-12
          .h4 Flujo de Efectivo
          .col-xl-12
            .col-xl-12
              .m-portlet
                .m-portlet__body
                  .m-section.mb-0
                    .m-section__sub
                      .row.m-section__sub style="display: flex"
                        .col-xl-12.my-6
                          .tab-content.col-xl-12.mb-30
                            .m-portlet
                              .m-portlet__body
                                .m-section__content
                                  - if @cash_flow.present?
                                    table.table
                                      thead.thead-default.thead-custom
                                        tr style="text-align: center;"
                                          th
                                            | Fecha
                                          th
                                            | Entrada
                                          th
                                            | Salida
                                          th
                                            | Moneda
                                      tbody
                                        - @cash_flow.reverse_each do |cash_flow|
                                          tr style="text-align: center;"
                                            td
                                              = cash_flow[0].first
                                            td
                                              = number_to_currency(cash_flow[1].try(:first)['amount'].present? ? cash_flow[1].try(:first)['amount'] : 0)
                                            td
                                              - if cash_flow[1].count > 1
                                                = number_to_currency(cash_flow[1].try(:last)['amount'].present? ? cash_flow[1].try(:last)['amount'] : 0)
                                              - else
                                                = number_to_currency 0
                                            td
                                              = cash_flow[1].try(:first)['currency']
                                  - else
                                    .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                                      .m-alert__icon
                                        i.flaticon-exclamation-1
                                        span
                                      .m-alert__text
                                        strong
                                          | Aún no se le han asignado flujo de efectivo a la compañía.

      .row
        .col-xl-12
          .h4 Razones Financieras
          .col-xl-12
            .col-xl-12
              .m-portlet
                .m-portlet__body
                  .m-section.mb-0
                    - if @company.company_calendar_details.where(assign_to: 'income_statement').present? and FReasonsCompany.where(company_id: @company.id).length > 0
                      = render 'financial_reasons'
                    - else
                      .m-alert.m-alert--icon.m-alert--icon-solid.m-alert--outline.alert.alert-brand.alert-dismissible.fade.show role="alert"
                        .m-alert__icon
                          i.flaticon-exclamation-1
                          span
                        .m-alert__text
                          strong
                            | Aún no se han generado las razónes financieras.

                    .col-md-12.mt-30
                      .btns-card.full-h
                        .subtitle-icon.d-flex.justify-content-center.align-items-center
                          i.fa.fa-comment.fa-lg.m--font-primary
                        .d-flex.flex-column.justify-content-between
                          h5.h5.subtitle = 'Comentarios'
                          .max-h-card.m-widget3
                            - if @fr_comments.length > 0
                              - @fr_comments.each do |comment|
                                .m-widget3__item
                                  .m-widget3__header
                                    .m-widget3__info
                                      span.m-widget3__username
                                        = User.where(id: comment.user_id).try(:first).full_name
                                      /br
                                      /span.m--font-primary
                                                        = "#{comment.process_status.name}"
                                      br
                                      span.m-widget3__time
                                        = comment.created_at.strftime('%d/%m/%Y,  %I:%M%p')

                                  .m-widget3__body
                                    p.m-widget3__text
                                      = comment.comment
                            - else
                              .m-widget3__item
                                .m-widget3__body
                                  p.m-widget3__text
                                    .text-center
                                      | Aún no hay comentarios.